---
title: 开发规范
date: 2023-02-05 09:14:26
permalink: /pages/b38daa/
categories:
  - 开发日志
tags:
  - 开发
  - 规范
  - 异常处理
author: 
  name: Jorgen
  link: https://gitee.com/jorgenme
---

# 日志规范

日志是整个代码开发过程中非常重要的环节，如果日志打的不好，那么遇到的线上bug就没法快速定位，定位不了问题也就没法快速解决问题。直接带来的结果可能包括；客诉更多、资损更大、修复更慢。
1. 选择恰当的日志级别
  - error：错误日志，指比较严重的错误，对正常业务有影响，需要运维配置监控的；
  - warn：警告日志，一般的错误，对业务影响不大，但是需要开发关注；
  - info：信息日志，记录排查问题的关键信息，如调用时间、出参入参等等；
  - debug：用于开发DEBUG的，关键逻辑里面的运行时数据；
  - trace：最详细的信息，一般这些信息只记录到日志文件中。
2. 日志要打印出方法的入参、出参
   比如说，方法进来的时候，打印入参。再然后呢，在方法返回的时候，就是打印出参，返回值。入参的话，一般就是userId或者bizSeq这些关键信息。
3. 选择合适的日志格式
   应当包括这些最基本的信息：如当前时间戳（一般毫秒精确度）、日志级别，线程名字等等
   ```xml
   <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
        <pattern>%d{HH:mm:ss.SSS} %-5level [%thread][%logger{0}] %m%n</pattern>
    </encoder>
   </appender> 
   ```
4. 遇到if...else...等条件时，每个分支首行都尽量打印日志
5. 日志级别比较低时，进行日志开关判断
6. 不能直接使用日志系统（Log4j、Logback）中的 API，而是使用日志框架SLF4J中的API。
   ```java
  import org.slf4j.Logger; 
  import org.slf4j.LoggerFactory;
  private static final Logger logger = LoggerFactory.getLogger(TianLuoBoy.class);
   ```
7. 建议使用参数占位{}，而不是用+拼接。
  ```java
  logger.info("Processing trade with id: {} and symbol : {} ", id, symbol); 
  ```
8. 建议使用异步的方式来输出日志。
  日志最终会输出到文件或者其它输出流中的，IO性能会有要求的。如果异步，就可以显著提升IO性能。
  除非有特殊要求，要不然建议使用异步的方式来输出日志。以logback为例吧，要配置异步很简单，使用AsyncAppender就行
  ```xml
  <appender name="FILE_ASYNC" class="ch.qos.logback.classic.AsyncAppender">
    <appender-ref ref="ASYNC"/>
  </appender> 
  ```
9. 核心功能模块，建议打印较完整的日志
10. 禁止在线上环境开启 debug

# 提交规范
......

# 代码规范
......