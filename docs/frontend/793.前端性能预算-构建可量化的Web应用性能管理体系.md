---
title: å‰ç«¯æ€§èƒ½é¢„ç®—ï¼šæ„å»ºå¯é‡åŒ–çš„Webåº”ç”¨æ€§èƒ½ç®¡ç†ä½“ç³»
date: 2026-02-06
tags: [æ€§èƒ½ä¼˜åŒ–, Webå¼€å‘, å·¥ç¨‹åŒ–]
---

## å‰è¨€

ä½œä¸ºä¸€åå‰ç«¯å¼€å‘è€…ï¼Œæˆ‘ä»¬ç»å¸¸é¢ä¸´è¿™æ ·çš„æŒ‘æˆ˜ï¼šå¦‚ä½•åœ¨åŠŸèƒ½è¿­ä»£çš„åŒæ—¶ä¿æŒåº”ç”¨çš„æ€§èƒ½ï¼Ÿå¦‚ä½•åœ¨å›¢é˜Ÿä¸­å»ºç«‹ç»Ÿä¸€çš„æ€§èƒ½æ ‡å‡†ï¼ŸğŸ¤” è¿™äº›é—®é¢˜çœ‹ä¼¼ç®€å•ï¼Œä½†å®é™…ä¸Šéœ€è¦ä¸€ä¸ªç³»ç»ŸåŒ–çš„æ–¹æ³•æ¥è§£å†³ã€‚

åœ¨æµè§ˆäº†ä¼—å¤šå‰ç«¯æŠ€æœ¯åšå®¢åï¼Œæˆ‘å‘ç°è™½ç„¶æœ‰å¾ˆå¤šå…³äºæ€§èƒ½ä¼˜åŒ–çš„æ–‡ç« ï¼Œä½†å¾ˆå°‘æœ‰æ·±å…¥æ¢è®¨"æ€§èƒ½é¢„ç®—"(Performance Budget)è¿™ä¸€æ¦‚å¿µçš„å†…å®¹ã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³å’Œå¤§å®¶åˆ†äº«å¦‚ä½•å»ºç«‹å’Œå®æ–½å‰ç«¯æ€§èƒ½é¢„ç®—ï¼Œå¸®åŠ©å›¢é˜Ÿæ„å»ºå¯é‡åŒ–ã€å¯ç»´æŠ¤çš„Webåº”ç”¨æ€§èƒ½ç®¡ç†ä½“ç³»ã€‚

::: tip
æ€§èƒ½é¢„ç®—æ˜¯æŒ‡åœ¨é¡¹ç›®å¼€å§‹å‰è®¾å®šçš„æ€§èƒ½æŒ‡æ ‡é˜ˆå€¼ï¼Œå®ƒé™åˆ¶äº†èµ„æº(å¦‚JavaScriptã€CSSã€å›¾åƒç­‰)çš„å¤§å°å’ŒåŠ è½½æ—¶é—´ï¼Œç¡®ä¿åº”ç”¨å§‹ç»ˆä¿æŒè‰¯å¥½çš„æ€§èƒ½è¡¨ç°ã€‚
:::

## ä»€ä¹ˆæ˜¯å‰ç«¯æ€§èƒ½é¢„ç®—ï¼Ÿ

å‰ç«¯æ€§èƒ½é¢„ç®—æ˜¯æŒ‡ä¸ºWebåº”ç”¨è®¾å®šçš„æ€§èƒ½æŒ‡æ ‡ä¸Šé™ï¼Œè¿™äº›æŒ‡æ ‡åŒ…æ‹¬ä½†ä¸é™äºï¼š

- èµ„æºå¤§å°é™åˆ¶ï¼šJavaScriptã€CSSã€å­—ä½“ã€å›¾ç‰‡ç­‰
- åŠ è½½æ—¶é—´ï¼šé¦–æ¬¡å†…å®¹ç»˜åˆ¶(FCP)ã€æœ€å¤§å†…å®¹ç»˜åˆ¶(LCP)ã€é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ(FID)ç­‰
- è¿è¡Œæ—¶æ€§èƒ½ï¼šå¸§ç‡(FPS)ã€å†…å­˜ä½¿ç”¨æƒ…å†µç­‰

è¿™äº›é¢„ç®—ä¸æ˜¯å‡­ç©ºè®¾å®šçš„ï¼Œè€Œæ˜¯åŸºäºç”¨æˆ·æœŸæœ›ã€ä¸šåŠ¡éœ€æ±‚å’Œè®¾å¤‡æ€§èƒ½ç»¼åˆå¾—å‡ºçš„ã€‚ğŸ“¡

## ä¸ºä»€ä¹ˆéœ€è¦æ€§èƒ½é¢„ç®—ï¼Ÿ

### 1. é‡åŒ–æ€§èƒ½ç›®æ ‡

æ²¡æœ‰æ˜ç¡®çš„æ€§èƒ½é¢„ç®—ï¼Œæ€§èƒ½ä¼˜åŒ–å°±å˜æˆäº†"æ„Ÿè§‰è‰¯å¥½"çš„ä¸»è§‚åˆ¤æ–­ã€‚æœ‰äº†é¢„ç®—ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š

- è®¾å®šæ˜ç¡®çš„æ€§èƒ½ç›®æ ‡
- è¯„ä¼°æ¯æ¬¡å˜æ›´çš„æ€§èƒ½å½±å“
- åœ¨å¼€å‘æ—©æœŸå‘ç°æ€§èƒ½é—®é¢˜

### 2. é˜²æ­¢æ€§èƒ½é€€åŒ–

åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œéšç€åŠŸèƒ½è¿­ä»£ï¼Œåº”ç”¨æ€§èƒ½å¾€å¾€ä¼šé€æ¸ä¸‹é™ã€‚æ€§èƒ½é¢„ç®—å°±åƒä¸€ä¸ª"å®ˆæŠ¤è€…"ï¼Œç¡®ä¿ï¼š

- æ–°åŠŸèƒ½ä¸ä¼šæ˜¾è‘—é™ä½æ•´ä½“æ€§èƒ½
- å›¢é˜Ÿæˆå‘˜äº†è§£æ€§èƒ½çº¢çº¿åœ¨å“ªé‡Œ
- æ€§èƒ½ä¸ä¼šåœ¨ä¸çŸ¥ä¸è§‰ä¸­å˜å·®

### 3. æå‡ç”¨æˆ·ä½“éªŒ

ç ”ç©¶è¡¨æ˜ï¼Œé¡µé¢åŠ è½½æ—¶é—´æ¯å¢åŠ 1ç§’ï¼Œç”¨æˆ·æµå¤±ç‡å¯èƒ½å¢åŠ 7%ã€‚æ€§èƒ½é¢„ç®—å¸®åŠ©æˆ‘ä»¬ï¼š

- ä¿æŒå¿«é€Ÿçš„ç”¨æˆ·äº¤äº’
- å‡å°‘ç”¨æˆ·ç­‰å¾…æ—¶é—´
- æé«˜è½¬åŒ–ç‡å’Œç”¨æˆ·æ»¡æ„åº¦

## å¦‚ä½•åˆ¶å®šåˆç†çš„æ€§èƒ½é¢„ç®—ï¼Ÿ

åˆ¶å®šæ€§èƒ½é¢„ç®—ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œéœ€è¦è€ƒè™‘å¤šä¸ªå› ç´ ï¼š

### 1. åŸºäºç”¨æˆ·æœŸæœ›

äº†è§£ä½ çš„ç”¨æˆ·æœŸæœ›ä»€ä¹ˆæ ·çš„æ€§èƒ½ä½“éªŒã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ”¶é›†æ•°æ®ï¼š

- ç”¨æˆ·è°ƒç ”å’Œè®¿è°ˆ
- ç«å“åˆ†æ
- è¡Œä¸šåŸºå‡†æ•°æ®

### 2. è€ƒè™‘ä¸šåŠ¡éœ€æ±‚

ä¸åŒç±»å‹çš„Webåº”ç”¨å¯¹æ€§èƒ½çš„è¦æ±‚ä¸åŒï¼š

- ç”µå•†ç½‘ç«™ï¼šé¦–å±åŠ è½½æ—¶é—´è‡³å…³é‡è¦
- ç¤¾äº¤åª’ä½“åº”ç”¨ï¼šäº¤äº’å“åº”é€Ÿåº¦æ›´é‡è¦
- å†…å®¹ç½‘ç«™ï¼šé¡µé¢æ¸²æŸ“æ€§èƒ½æ˜¯å…³é”®

### 3. è®¾å¤‡å’Œç½‘ç»œæ¡ä»¶

è€ƒè™‘ç›®æ ‡ç”¨æˆ·çš„è®¾å¤‡æ€§èƒ½å’Œç½‘ç»œçŠ¶å†µï¼š

- ç§»åŠ¨è®¾å¤‡é€šå¸¸æ€§èƒ½è¾ƒå¼±
- ä¸ç¨³å®šçš„ç½‘ç»œç¯å¢ƒ
- ä¸åŒåœ°åŒºçš„ç½‘ç»œæ¡ä»¶å·®å¼‚

### 4. å‚è€ƒè¡Œä¸šåŸºå‡†

æ ¹æ®Googleçš„ç ”ç©¶ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æ¨èçš„æ€§èƒ½é¢„ç®—ï¼š

- **é¦–å±å†…å®¹ç»˜åˆ¶(FCP)**: <1.8ç§’
- **æœ€å¤§å†…å®¹ç»˜åˆ¶(LCP)**: <2.5ç§’
- **é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ(FID)**: <100æ¯«ç§’
- **ç´¯ç§¯å¸ƒå±€åç§»(CLSP)**: <0.1
- **JavaScriptæ€»å¤§å°**: <170KB(å‹ç¼©å)
- **CSSæ€»å¤§å°**: <150KB(å‹ç¼©å)

## å®æ–½æ€§èƒ½é¢„ç®—çš„å·¥å…·

### 1. æ„å»ºå·¥å…·é›†æˆ

ç°ä»£æ„å»ºå·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­å®æ–½æ€§èƒ½é¢„ç®—ï¼š

#### Webpack with Bundle Analyzer

```javascript
// webpack.config.js
const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;

module.exports = {
  plugins: [
    new BundleAnalyzerPlugin({
      analyzerMode: 'static',
      openAnalyzer: false
    })
  ]
};
```

#### Vite with Rollup Plugin

```javascript
// vite.config.js
import { visualizer } from 'rollup-plugin-visualizer';

export default {
  plugins: [
    visualizer({
      open: false,
      gzipSize: true,
      brotliSize: true
    })
  ]
};
```

### 2. æ€§èƒ½ç›‘æ§å·¥å…·

#### Lighthouse CI

```json
// .lighthouserc.json
{
  "ci": {
    "collect": {
      "url": "https://example.com"
    },
    "assertions": {
      "categories:performance": {
        "expected": 90,
        "maxWarnings": 0
      },
      "categories:accessibility": {
        "expected": 95,
        "maxWarnings": 0
      }
    }
  }
}
```

#### WebPageTest

ä½¿ç”¨WebPageTest APIè¿›è¡Œè‡ªåŠ¨åŒ–æ€§èƒ½æµ‹è¯•ï¼š

```javascript
// webpagetest.js
const webpagetest = require('webpagetest-api');

const wpt = new webpagetest('ä½ çš„APIå¯†é’¥');

wpt.runTest('https://example.com', {
  firstView: true,
  connectivity: '4G',
  location: 'Dulles:Chrome'
}, (err, data) => {
  if (err) return console.error(err);
  console.log('æ€§èƒ½æµ‹è¯•ç»“æœ:', data);
});
```

### 3. CI/CDé›†æˆ

å°†æ€§èƒ½æµ‹è¯•é›†æˆåˆ°CI/CDæµç¨‹ä¸­ï¼š

```yaml
# .github/workflows/performance.yml
name: Performance Test

on: [push, pull_request]

jobs:
  performance:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v2
    
    - name: Setup Node.js
      uses: actions/setup-node@v2
      with:
        node-version: '16'
    
    - name: Install dependencies
      run: npm ci
    
    - name: Build application
      run: npm run build
    
    - name: Run Lighthouse
      run: npx lhci autorun
    
    - name: Run WebPageTest
      run: node webpagetest.js
    
    - name: Check performance budget
      run: node check-budget.js
```

## æ€§èƒ½é¢„ç®—çš„å®è·µç­–ç•¥

### 1. åˆ†å±‚é¢„ç®—ç­–ç•¥

å°†æ€§èƒ½é¢„ç®—åˆ†å±‚ç®¡ç†ï¼š

```javascript
// performance-budget.js
const performanceBudget = {
  // ä¸¥æ ¼é¢„ç®— - å…³é”®è·¯å¾„èµ„æº
  critical: {
    js: '50KB',
    css: '30KB',
    fonts: '20KB',
    images: '100KB'
  },
  
  // é‡è¦é¢„ç®— - ä¸»è¦åŠŸèƒ½èµ„æº
  important: {
    js: '150KB',
    css: '100KB',
    images: '500KB'
  },
  
  // å®½æ¾é¢„ç®— - æ¬¡è¦åŠŸèƒ½èµ„æº
  relaxed: {
    js: '300KB',
    css: '200KB',
    images: '1MB'
  }
};

module.exports = performanceBudget;
```

### 2. æ¸è¿›å¼å¢å¼ºç­–ç•¥

åŸºäºç½‘ç»œæ¡ä»¶å®æ–½ä¸åŒçš„æ€§èƒ½ç­–ç•¥ï¼š

```javascript
// connection-aware-loading.js
const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;

function loadAssets() {
  if (connection && (connection.effectiveType === 'slow-2g' || connection.saveData)) {
    // ä½ç½‘ç»œæˆ–çœç”µæ¨¡å¼
    loadCriticalAssets();
    showSkeletonScreen();
  } else {
    // æ­£å¸¸ç½‘ç»œæ¡ä»¶
    loadAllAssets();
  }
}

function loadCriticalAssets() {
  // ä»…åŠ è½½æ ¸å¿ƒèµ„æº
  import('./critical.js');
  import('./critical.css');
}

function loadAllAssets() {
  // åŠ è½½æ‰€æœ‰èµ„æº
  import('./all.js');
  import('./all.css');
}
```

### 3. èµ„æºä¼˜åŒ–ç­–ç•¥

å®æ–½èµ„æºä¼˜åŒ–ä»¥ç¡®ä¿ç¬¦åˆæ€§èƒ½é¢„ç®—ï¼š

```javascript
// image-optimization.js
const imageOptimizer = {
  // æ ¹æ®è®¾å¤‡åƒç´ æ¯”è°ƒæ•´å›¾ç‰‡å¤§å°
  getSrcSet: (src, sizes) => {
    return sizes.map(size => {
      const width = size.width;
      const height = size.height;
      return `${src}?w=${width}&h=${height}&q=80 ${width}w`;
    }).join(', ');
  },
  
  // æ‡’åŠ è½½éå…³é”®å›¾ç‰‡
  lazyLoadImages: () => {
    const images = document.querySelectorAll('img[data-src]');
    const imageObserver = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const img = entry.target;
          img.src = img.dataset.src;
          img.classList.remove('lazy');
          observer.unobserve(img);
        }
      });
    });
    
    images.forEach(img => imageObserver.observe(img));
  }
};

// ä½¿ç”¨ç¤ºä¾‹
const heroImage = {
  src: '/images/hero.jpg',
  sizes: [
    { width: 320, height: 200 },
    { width: 640, height: 400 },
    { width: 1024, height: 600 }
  ]
};

document.getElementById('hero').srcset = imageOptimizer.getSrcSet(heroImage.src, heroImage.sizes);
imageOptimizer.lazyLoadImages();
```

## æ€§èƒ½é¢„ç®—çš„ç›‘æ§ä¸æ‰§è¡Œ

### 1. å®æ—¶ç›‘æ§

å®æ–½å®æ—¶æ€§èƒ½ç›‘æ§ï¼Œç¡®ä¿åº”ç”¨å§‹ç»ˆç¬¦åˆæ€§èƒ½é¢„ç®—ï¼š

```javascript
// performance-monitor.js
class PerformanceMonitor {
  constructor(budget) {
    this.budget = budget;
    this.violations = [];
    this.init();
  }
  
  init() {
    // ç›‘æ§èµ„æºåŠ è½½
    const observer = new PerformanceObserver((list) => {
      list.getEntries().forEach(entry => {
        this.checkResource(entry);
      });
    });
    
    observer.observe({ entryTypes: ['resource'] });
    
    // ç›‘æ§é¡µé¢æ€§èƒ½æŒ‡æ ‡
    window.addEventListener('load', () => {
      this.checkMetrics();
    });
  }
  
  checkResource(entry) {
    const { name, transferSize } = entry;
    const type = this.getResourceType(name);
    
    if (this.budget[type] && transferSize > this.budget[type]) {
      this.violations.push({
        type: 'resource-size',
        resource: name,
        size: transferSize,
        limit: this.budget[type]
      });
    }
  }
  
  getResourceType(url) {
    if (url.endsWith('.js')) return 'js';
    if (url.endsWith('.css')) return 'css';
    if (url.includes('fonts')) return 'fonts';
    if (url.match(/\.(png|jpg|jpeg|gif|webp)$/)) return 'images';
    return 'other';
  }
  
  checkMetrics() {
    const metrics = this.getPerformanceMetrics();
    
    // æ£€æŸ¥FCP
    if (metrics.fcp > this.budget.fcp) {
      this.violations.push({
        type: 'fcp',
        value: metrics.fcp,
        limit: this.budget.fcp
      });
    }
    
    // æ£€æŸ¥LCP
    if (metrics.lcp > this.budget.lcp) {
      this.violations.push({
        type: 'lcp',
        value: metrics.lcp,
        limit: this.budget.lcp
      });
    }
    
    // æ£€æŸ¥FID
    if (metrics.fid > this.budget.fid) {
      this.violations.push({
        type: 'fid',
        value: metrics.fid,
        limit: this.budget.fid
      });
    }
    
    // æŠ¥å‘Šè¿è§„
    if (this.violations.length > 0) {
      this.reportViolations();
    }
  }
  
  getPerformanceMetrics() {
    // å®é™…å®ç°ä¸­ï¼Œä½¿ç”¨Performance APIè·å–çœŸå®æŒ‡æ ‡
    return {
      fcp: 1800, // æ¯«ç§’
      lcp: 2600, // æ¯«ç§’
      fid: 120   // æ¯«ç§’
    };
  }
  
  reportViolations() {
    // å‘é€åˆ°ç›‘æ§æœåŠ¡
    console.error('æ€§èƒ½é¢„ç®—è¿è§„:', this.violations);
    // è¿™é‡Œå¯ä»¥æ·»åŠ ä¸ŠæŠ¥é€»è¾‘
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const budget = {
  js: 170 * 1024,    // 170KB
  css: 150 * 1024,   // 150KB
  fonts: 50 * 1024,  // 50KB
  images: 500 * 1024, // 500KB
  fcp: 1800,         // 1.8ç§’
  lcp: 2500,         // 2.5ç§’
  fid: 100           // 100æ¯«ç§’
};

const monitor = new PerformanceMonitor(budget);
```

### 2. è‡ªåŠ¨åŒ–æŠ¥å‘Š

å®æ–½è‡ªåŠ¨åŒ–æ€§èƒ½æŠ¥å‘Šï¼Œå¸®åŠ©å›¢é˜Ÿäº†è§£æ€§èƒ½çŠ¶å†µï¼š

```javascript
// performance-report.js
class PerformanceReporter {
  constructor() {
    this.reports = [];
  }
  
  generateReport(data) {
    const report = {
      timestamp: new Date().toISOString(),
      metrics: this.calculateMetrics(data),
      violations: this.identifyViolations(data),
      recommendations: this.generateRecommendations(data)
    };
    
    this.reports.push(report);
    return report;
  }
  
  calculateMetrics(data) {
    return {
      totalSize: this.calculateTotalSize(data.resources),
      loadTime: this.calculateLoadTime(data.timings),
      score: this.calculatePerformanceScore(data)
    };
  }
  
  calculateTotalSize(resources) {
    return resources.reduce((total, resource) => total + resource.transferSize, 0);
  }
  
  calculateLoadTime(timings) {
    return timings.loadEventEnd - timings.navigationStart;
  }
  
  calculatePerformanceScore(data) {
    // ç®€åŒ–çš„æ€§èƒ½è¯„åˆ†ç®—æ³•
    let score = 100;
    
    // æ ¹æ®FCPæ‰£åˆ†
    if (data.metrics.fcp > 1800) {
      score -= Math.min(30, (data.metrics.fcp - 1800) / 60);
    }
    
    // æ ¹æ®LCPæ‰£åˆ†
    if (data.metrics.lcp > 2500) {
      score -= Math.min(40, (data.metrics.lcp - 2500) / 50);
    }
    
    // æ ¹æ®FIDæ‰£åˆ†
    if (data.metrics.fid > 100) {
      score -= Math.min(20, data.metrics.fid / 10);
    }
    
    // æ ¹æ®èµ„æºå¤§å°æ‰£åˆ†
    const totalSizeKB = data.metrics.totalSize / 1024;
    if (totalSizeKB > 500) {
      score -= Math.min(10, (totalSizeKB - 500) / 100);
    }
    
    return Math.max(0, score);
  }
  
  identifyViolations(data) {
    const violations = [];
    
    // æ£€æŸ¥FCPè¿è§„
    if (data.metrics.fcp > 1800) {
      violations.push({
        type: 'FCP',
        value: data.metrics.fcp,
        limit: 1800,
        severity: 'high'
      });
    }
    
    // æ£€æŸ¥LCPè¿è§„
    if (data.metrics.lcp > 2500) {
      violations.push({
        type: 'LCP',
        value: data.metrics.lcp,
        limit: 2500,
        severity: 'high'
      });
    }
    
    // æ£€æŸ¥FIDè¿è§„
    if (data.metrics.fid > 100) {
      violations.push({
        type: 'FID',
        value: data.metrics.fid,
        limit: 100,
        severity: 'medium'
      });
    }
    
    // æ£€æŸ¥èµ„æºå¤§å°è¿è§„
    data.resources.forEach(resource => {
      const type = this.getResourceType(resource.name);
      const limit = this.getLimitForType(type);
      
      if (resource.transferSize > limit) {
        violations.push({
          type: `${type} size`,
          resource: resource.name,
          value: resource.transferSize,
          limit: limit,
          severity: 'medium'
        });
      }
    });
    
    return violations;
  }
  
  getResourceType(url) {
    if (url.endsWith('.js')) return 'JavaScript';
    if (url.endsWith('.css')) return 'CSS';
    if (url.includes('fonts')) return 'Font';
    if (url.match(/\.(png|jpg|jpeg|gif|webp)$/)) return 'Image';
    return 'Other';
  }
  
  getLimitForType(type) {
    const limits = {
      'JavaScript': 170 * 1024,
      'CSS': 150 * 1024,
      'Font': 50 * 1024,
      'Image': 500 * 1024,
      'Other': 100 * 1024
    };
    
    return limits[type] || 100 * 1024;
  }
  
  generateRecommendations(data) {
    const recommendations = [];
    
    // åŸºäºè¿è§„æƒ…å†µç”Ÿæˆå»ºè®®
    data.violations.forEach(violation => {
      switch (violation.type) {
        case 'FCP':
          recommendations.push({
            priority: 'high',
            action: 'ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„',
            description: 'å‡å°‘é˜»å¡æ¸²æŸ“çš„JavaScriptå’ŒCSSï¼Œä¼˜åŒ–DOMç»“æ„ï¼Œä½¿ç”¨å…³é”®CSSå†…è”'
          });
          break;
        case 'LCP':
          recommendations.push({
            priority: 'high',
            action: 'ä¼˜åŒ–æœ€å¤§å†…å®¹å…ƒç´ ',
            description: 'ä¼˜åŒ–æœ€å¤§å†…å®¹å…ƒç´ çš„åŠ è½½ï¼Œè€ƒè™‘ä½¿ç”¨é¢„åŠ è½½ã€é¢„è¿æ¥æˆ–å»¶è¿ŸåŠ è½½éå…³é”®èµ„æº'
          });
          break;
        case 'FID':
          recommendations.push({
            priority: 'medium',
            action: 'ä¼˜åŒ–ä¸»çº¿ç¨‹ä»»åŠ¡',
            description: 'å‡å°‘é•¿ä»»åŠ¡ï¼Œå°†JavaScriptæ‹†åˆ†ä¸ºæ›´å°çš„å—ï¼Œä½¿ç”¨Web Workerså¤„ç†å¤æ‚è®¡ç®—'
          });
          break;
        default:
          if (violation.type.includes('size')) {
            recommendations.push({
              priority: 'medium',
              action: `ä¼˜åŒ–${violation.type.split(' ')[0]}èµ„æº`,
              description: `å‹ç¼©${violation.type.split(' ')[0]}èµ„æºï¼Œè€ƒè™‘ä½¿ç”¨æ›´é«˜æ•ˆçš„æ ¼å¼æˆ–å»¶è¿ŸåŠ è½½`
            });
          }
      }
    });
    
    return recommendations;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const reporter = new PerformanceReporter();
const performanceData = {
  resources: [
    { name: 'app.js', transferSize: 180 * 1024 },
    { name: 'styles.css', transferSize: 160 * 1024 },
    { name: 'hero.jpg', transferSize: 600 * 1024 }
  ],
  timings: {
    navigationStart: 1000,
    loadEventEnd: 4000
  },
  metrics: {
    fcp: 2000,
    lcp: 3000,
    fid: 150
  }
};

const report = reporter.generateReport(performanceData);
console.log('æ€§èƒ½æŠ¥å‘Š:', report);
```

## æ¡ˆä¾‹ç ”ç©¶ï¼šç”µå•†ç½‘ç«™çš„æ€§èƒ½é¢„ç®—å®æ–½

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå®é™…æ¡ˆä¾‹ï¼ŒæŸç”µå•†ç½‘ç«™å¦‚ä½•å®æ–½æ€§èƒ½é¢„ç®—ï¼š

### èƒŒæ™¯

æŸç”µå•†ç½‘ç«™é¦–é¡µåŠ è½½ç¼“æ…¢ï¼Œç”¨æˆ·æµå¤±ç‡é«˜ï¼Œå›¢é˜Ÿå†³å®šå®æ–½æ€§èƒ½é¢„ç®—æ¥æ”¹å–„ç”¨æˆ·ä½“éªŒã€‚

### å®æ–½æ­¥éª¤

1. **è®¾å®šæ€§èƒ½é¢„ç®—**
   - FCP: <1.5ç§’
   - LCP: <2.2ç§’
   - JavaScriptæ€»å¤§å°: <150KB
   - CSSæ€»å¤§å°: <120KB
   - å›¾ç‰‡æ€»å¤§å°: <400KB

2. **åˆ†æå½“å‰æ€§èƒ½**
   ä½¿ç”¨Lighthouseå’ŒWebPageTestè¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼Œå‘ç°ï¼š
   - FCP: 3.2ç§’
   - LCP: 4.5ç§’
   - JavaScript: 280KB
   - CSS: 200KB
   - å›¾ç‰‡: 800KB

3. **åˆ¶å®šä¼˜åŒ–ç­–ç•¥**
   - å®æ–½ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
   - ä¼˜åŒ–å›¾ç‰‡æ ¼å¼å’Œå¤§å°
   - å†…è”å…³é”®CSS
   - ä½¿ç”¨é¢„åŠ è½½å’Œé¢„è¿æ¥

4. **å®æ–½ä¼˜åŒ–**
   ```javascript
   // å…³é”®CSSå†…è”
   const criticalCSS = `
     /* é¦–å±å…³é”®æ ·å¼ */
     body { font-family: Arial, sans-serif; }
     .header { background: #fff; }
     .product-grid { display: grid; }
   `;
   
   document.head.insertAdjacentHTML('beforeend', `<style>${criticalCSS}</style>`);
   
   // å›¾ç‰‡æ‡’åŠ è½½
   document.addEventListener('DOMContentLoaded', () => {
     const lazyImages = document.querySelectorAll('img[data-src]');
     
     const imageObserver = new IntersectionObserver((entries, observer) => {
       entries.forEach(entry => {
         if (entry.isIntersecting) {
           const img = entry.target;
           img.src = img.dataset.src;
           img.classList.remove('lazy');
           observer.unobserve(img);
         }
       });
     });
     
     lazyImages.forEach(img => imageObserver.observe(img));
   });
   
   // é¢„åŠ è½½å…³é”®èµ„æº
   document.addEventListener('DOMContentLoaded', () => {
     const criticalResources = [
       '/js/main.js',
       '/css/main.css',
       '/images/logo.png'
     ];
     
     criticalResources.forEach(url => {
       const link = document.createElement('link');
       link.rel = 'preload';
       link.href = url;
       link.as = url.endsWith('.js') ? 'script' : 
                 url.endsWith('.css') ? 'style' : 'image';
       document.head.appendChild(link);
     });
   });
   ```

5. **ç›‘æ§ä¸è°ƒæ•´**
   - å®æ–½è‡ªåŠ¨åŒ–æ€§èƒ½æµ‹è¯•
   - å»ºç«‹æ€§èƒ½é¢„ç®—ä»ªè¡¨æ¿
   - å®šæœŸå®¡æŸ¥å’Œè°ƒæ•´é¢„ç®—

### ç»“æœ

å®æ–½æ€§èƒ½é¢„ç®—åï¼Œç½‘ç«™æ€§èƒ½æ˜¾è‘—æå‡ï¼š

- FCP: ä»3.2ç§’é™è‡³1.3ç§’ (59%æå‡)
- LCP: ä»4.5ç§’é™è‡³1.8ç§’ (60%æå‡)
- JavaScript: ä»280KBé™è‡³130KB (54%å‡å°‘)
- CSS: ä»200KBé™è‡³100KB (50%å‡å°‘)
- å›¾ç‰‡: ä»800KBé™è‡³350KB (56%å‡å°‘)

ç”¨æˆ·æµå¤±ç‡é™ä½äº†23%ï¼Œé¡µé¢åœç•™æ—¶é—´å¢åŠ äº†18%ã€‚

## æ€§èƒ½é¢„ç®—çš„æœ€ä½³å®è·µ

### 1. ä»å°å¤„å¼€å§‹

ä¸è¦ä¸€å¼€å§‹å°±è®¾å®šè¿‡äºä¸¥æ ¼çš„é¢„ç®—ï¼Œå¯ä»¥ä»å®½æ¾çš„é¢„ç®—å¼€å§‹ï¼Œç„¶åé€æ­¥æ”¶ç´§ï¼š

```javascript
// æ¸è¿›å¼æ€§èƒ½é¢„ç®—
const progressiveBudget = {
  phase1: { // åˆå§‹é˜¶æ®µ
    js: 300 * 1024,   // 300KB
    css: 250 * 1024,  // 250KB
    images: 1 * 1024 * 1024, // 1MB
    fcp: 3000,        // 3ç§’
    lcp: 4000,        // 4ç§’
    fid: 200          // 200æ¯«ç§’
  },
  phase2: { // ä¸­æœŸé˜¶æ®µ
    js: 200 * 1024,   // 200KB
    css: 180 * 1024,  // 180KB
    images: 700 * 1024, // 700KB
    fcp: 2500,        // 2.5ç§’
    lcp: 3500,        // 3.5ç§’
    fid: 150          // 150æ¯«ç§’
  },
  phase3: { // æœ€ç»ˆé˜¶æ®µ
    js: 150 * 1024,   // 150KB
    css: 120 * 1024,  // 120KB
    images: 500 * 1024, // 500KB
    fcp: 1800,        // 1.8ç§’
    lcp: 2500,        // 2.5ç§’
    fid: 100          // 100æ¯«ç§’
  }
};
```

### 2. åŸºäºæ•°æ®åˆ¶å®šé¢„ç®—

ä½¿ç”¨çœŸå®ç”¨æˆ·æ•°æ®(RUM)æ¥åˆ¶å®šåˆç†çš„æ€§èƒ½é¢„ç®—ï¼š

```javascript
// åŸºäºRUMæ•°æ®çš„æ€§èƒ½é¢„ç®—è®¡ç®—
class RUMBasedBudget {
  constructor(rumData) {
    this.rumData = rumData;
  }
  
  calculateBudget() {
    // è®¡ç®—ç¬¬90ç™¾åˆ†ä½æ€§èƒ½æŒ‡æ ‡
    const p90FCP = this.percentile(this.rumData.fcp, 90);
    const p90LCP = this.percentile(this.rumData.lcp, 90);
    const p90FID = this.percentile(this.rumData.fid, 90);
    
    // è®¡ç®—èµ„æºå¤§å°çš„ç¬¬90ç™¾åˆ†ä½
    const p90JS = this.percentile(this.rumData.jsSizes, 90);
    const p90CSS = this.percentile(this.rumData.cssSizes, 90);
    const p90Images = this.percentile(this.rumData.imageSizes, 90);
    
    // è®¾ç½®é¢„ç®—ä¸ºç¬¬90ç™¾åˆ†ä½çš„80%
    return {
      fcp: p90FCP * 0.8,
      lcp: p90LCP * 0.8,
      fid: p90FID * 0.8,
      js: p90JS * 0.8,
      css: p90CSS * 0.8,
      images: p90Images * 0.8
    };
  }
  
  percentile(values, p) {
    const sorted = values.slice().sort((a, b) => a - b);
    const index = Math.ceil((p / 100) * sorted.length) - 1;
    return sorted[index];
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const rumData = {
  fcp: [1200, 1500, 1800, 2200, 2500, 3000, 3500, 4000, 4500, 5000],
  lcp: [1500, 1800, 2200, 2600, 3000, 3500, 4000, 4500, 5000, 5500],
  fid: [50, 80, 100, 120, 150, 180, 200, 250, 300, 350],
  jsSizes: [100000, 120000, 150000, 180000, 200000, 220000, 250000, 280000, 300000, 350000],
  cssSizes: [80000, 100000, 120000, 150000, 180000, 200000, 220000, 250000, 280000, 300000],
  imageSizes: [200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1000000, 1200000]
};

const budgetCalculator = new RUMBasedBudget(rumData);
const budget = budgetCalculator.calculateBudget();
console.log('åŸºäºRUMæ•°æ®çš„æ€§èƒ½é¢„ç®—:', budget);
```

### 3. è€ƒè™‘ä¸åŒè®¾å¤‡å’Œç½‘ç»œæ¡ä»¶

ä¸ºä¸åŒè®¾å¤‡å’Œç½‘ç»œæ¡ä»¶è®¾ç½®ä¸åŒçš„æ€§èƒ½é¢„ç®—ï¼š

```javascript
// è®¾å¤‡å’Œç½‘ç»œæ„ŸçŸ¥çš„æ€§èƒ½é¢„ç®—
const deviceAwareBudget = {
  // é«˜æ€§èƒ½è®¾å¤‡ï¼Œå¿«é€Ÿç½‘ç»œ
  highEnd: {
    mobile: {
      js: 200 * 1024,
      css: 150 * 1024,
      images: 600 * 1024,
      fcp: 2000,
      lcp: 2500,
      fid: 100
    },
    desktop: {
      js: 250 * 1024,
      css: 180 * 1024,
      images: 800 * 1024,
      fcp: 1500,
      lcp: 2000,
      fid: 80
    }
  },
  
  // ä¸­ç«¯è®¾å¤‡ï¼Œæ™®é€šç½‘ç»œ
  midRange: {
    mobile: {
      js: 150 * 1024,
      css: 120 * 1024,
      images: 400 * 1024,
      fcp: 2500,
      lcp: 3000,
      fid: 150
    },
    desktop: {
      js: 180 * 1024,
      css: 150 * 1024,
      images: 600 * 1024,
      fcp: 2000,
      lcp: 2500,
      fid: 100
    }
  },
  
  // ä½ç«¯è®¾å¤‡ï¼Œæ…¢é€Ÿç½‘ç»œ
  lowEnd: {
    mobile: {
      js: 100 * 1024,
      css: 80 * 1024,
      images: 200 * 1024,
      fcp: 3000,
      lcp: 3500,
      fid: 200
    },
    desktop: {
      js: 120 * 1024,
      css: 100 * 1024,
      images: 300 * 1024,
      fcp: 2500,
      lcp: 3000,
      fid: 150
    }
  }
};

// æ ¹æ®è®¾å¤‡ç±»å‹å’Œç½‘ç»œæ¡ä»¶é€‰æ‹©é¢„ç®—
function getBudgetForDevice(device, network) {
  // ç®€åŒ–çš„è®¾å¤‡æ£€æµ‹
  const isHighEnd = device === 'high' || network === 'fast';
  const isLowEnd = device === 'low' || network === 'slow';
  
  if (isHighEnd) return deviceAwareBudget.highEnd;
  if (isLowEnd) return deviceAwareBudget.lowEnd;
  return deviceAwareBudget.midRange;
}
```

### 4. å®šæœŸå®¡æŸ¥å’Œè°ƒæ•´

æ€§èƒ½é¢„ç®—ä¸æ˜¯ä¸€æˆä¸å˜çš„ï¼Œéœ€è¦å®šæœŸå®¡æŸ¥å’Œè°ƒæ•´ï¼š

```javascript
// æ€§èƒ½é¢„ç®—å®¡æŸ¥å·¥å…·
class BudgetReviewer {
  constructor(currentBudget, historicalData) {
    this.currentBudget = currentBudget;
    this.historicalData = historicalData;
  }
  
  review() {
    const analysis = {
      trends: this.analyzeTrends(),
      violations: this.analyzeViolations(),
      recommendations: this.generateRecommendations()
    };
    
    return analysis;
  }
  
  analyzeTrends() {
    // åˆ†ææ€§èƒ½æŒ‡æ ‡è¶‹åŠ¿
    const trends = {
      fcp: this.calculateTrend(this.historicalData.fcp),
      lcp: this.calculateTrend(this.historicalData.lcp),
      fid: this.calculateTrend(this.historicalData.fid),
      jsSize: this.calculateTrend(this.historicalData.jsSize),
      cssSize: this.calculateTrend(this.historicalData.cssSize),
      imageSize: this.calculateTrend(this.historicalData.imageSize)
    };
    
    return trends;
  }
  
  calculateTrend(data) {
    if (data.length < 2) return 'insufficient_data';
    
    const recent = data.slice(-7); // æœ€è¿‘7å¤©
    const older = data.slice(-14, -7); // ä¹‹å‰çš„7å¤©
    
    const recentAvg = recent.reduce((sum, val) => sum + val, 0) / recent.length;
    const olderAvg = older.reduce((sum, val) => sum + val, 0) / older.length;
    
    const change = ((recentAvg - olderAvg) / olderAvg) * 100;
    
    if (Math.abs(change) < 5) return 'stable';
    if (change > 0) return 'increasing';
    return 'decreasing';
  }
  
  analyzeViolations() {
    // åˆ†æé¢„ç®—è¿è§„æƒ…å†µ
    const violations = {
      frequency: this.calculateViolationFrequency(),
      severity: this.calculateViolationSeverity(),
      commonIssues: this.identifyCommonIssues()
    };
    
    return violations;
  }
  
  calculateViolationFrequency() {
    // è®¡ç®—é¢„ç®—è¿è§„é¢‘ç‡
    const totalChecks = this.historicalData.totalChecks || 0;
    const violations = this.historicalData.violations || 0;
    
    if (totalChecks === 0) return 0;
    return (violations / totalChecks) * 100;
  }
  
  calculateViolationSeverity() {
    // è®¡ç®—è¿è§„ä¸¥é‡ç¨‹åº¦
    const violations = this.historicalData.violations || [];
    const severeViolations = violations.filter(v => v.severity === 'high').length;
    
    if (violations.length === 0) return 'none';
    if (severeViolations / violations.length > 0.5) return 'high';
    if (severeViolations / violations.length > 0.2) return 'medium';
    return 'low';
  }
  
  identifyCommonIssues() {
    // è¯†åˆ«å¸¸è§é—®é¢˜
    const violations = this.historicalData.violations || [];
    const issueCount = {};
    
    violations.forEach(v => {
      issueCount[v.type] = (issueCount[v.type] || 0) + 1;
    });
    
    // è¿”å›æœ€å¸¸è§çš„3ä¸ªé—®é¢˜
    return Object.entries(issueCount)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 3)
      .map(([type, count]) => ({ type, count }));
  }
  
  generateRecommendations() {
    // åŸºäºåˆ†æç”Ÿæˆå»ºè®®
    const recommendations = [];
    
    const trends = this.analyzeTrends();
    const violations = this.analyzeViolations();
    
    // åŸºäºè¶‹åŠ¿ç”Ÿæˆå»ºè®®
    if (trends.fcp === 'increasing') {
      recommendations.push({
        priority: 'high',
        action: 'ä¼˜åŒ–FCP',
        description: 'FCPå‘ˆä¸Šå‡è¶‹åŠ¿ï¼Œå»ºè®®ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„'
      });
    }
    
    if (trends.jsSize === 'increasing') {
      recommendations.push({
        priority: 'medium',
        action: 'æ§åˆ¶JavaScriptå¤§å°',
        description: 'JavaScriptå¤§å°æŒç»­å¢é•¿ï¼Œå»ºè®®å®æ–½ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½'
      });
    }
    
    // åŸºäºè¿è§„ç”Ÿæˆå»ºè®®
    if (violations.frequency > 20) {
      recommendations.push({
        priority: 'high',
        action: 'è°ƒæ•´æ€§èƒ½é¢„ç®—',
        description: `é¢„ç®—è¿è§„é¢‘ç‡ä¸º${violations.frequency.toFixed(1)}%ï¼Œå»ºè®®è°ƒæ•´é¢„ç®—æˆ–åŠ å¼ºä¼˜åŒ–`
      });
    }
    
    if (violations.severity === 'high') {
      recommendations.push({
        priority: 'high',
        action: 'è§£å†³é«˜ä¸¥é‡æ€§é—®é¢˜',
        description: 'å­˜åœ¨é«˜ä¸¥é‡æ€§é—®é¢˜ï¼Œå»ºè®®ä¼˜å…ˆè§£å†³'
      });
    }
    
    return recommendations;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const currentBudget = {
  fcp: 1800,
  lcp: 2500,
  fid: 100,
  js: 170 * 1024,
  css: 150 * 1024,
  images: 500 * 1024
};

const historicalData = {
  fcp: [1700, 1750, 1800, 1850, 1900, 1950, 2000],
  lcp: [2400, 2450, 2500, 2550, 2600, 2650, 2700],
  fid: [90, 95, 100, 105, 110, 115, 120],
  jsSize: [160 * 1024, 165 * 1024, 170 * 1024, 175 * 1024, 180 * 1024, 185 * 1024, 190 * 1024],
  cssSize: [140 * 1024, 145 * 1024, 150 * 1024, 155 * 1024, 160 * 1024, 165 * 1024, 170 * 1024],
  imageSize: [480 * 1024, 490 * 1024, 500 * 1024, 510 * 1024, 520 * 1024, 530 * 1024, 540 * 1024],
  totalChecks: 100,
  violations: 25,
  violationsDetail: [
    { type: 'FCP', severity: 'high' },
    { type: 'LCP', severity: 'medium' },
    { type: 'JavaScript size', severity: 'medium' },
    { type: 'FCP', severity: 'high' },
    { type: 'Image size', severity: 'low' }
  ]
};

const reviewer = new BudgetReviewer(currentBudget, historicalData);
const review = reviewer.review();
console.log('æ€§èƒ½é¢„ç®—å®¡æŸ¥ç»“æœ:', review);
```

## ç»“è¯­

å‰ç«¯æ€§èƒ½é¢„ç®—ä¸ä»…ä»…æ˜¯ä¸€ç»„æ•°å­—ï¼Œå®ƒæ˜¯ä¸€ç§æ€ç»´æ–¹å¼ï¼Œä¸€ç§å°†æ€§èƒ½èå…¥å¼€å‘å…¨æµç¨‹çš„æ–¹æ³•ã€‚é€šè¿‡å»ºç«‹å’Œå®æ–½æ€§èƒ½é¢„ç®—ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š

1. **è®¾å®šæ˜ç¡®çš„æ€§èƒ½ç›®æ ‡**ï¼šå°†æŠ½è±¡çš„æ€§èƒ½æ¦‚å¿µè½¬åŒ–ä¸ºå…·ä½“çš„å¯è¡¡é‡æŒ‡æ ‡
2. **é˜²æ­¢æ€§èƒ½é€€åŒ–**ï¼šåœ¨å¼€å‘æ—©æœŸå‘ç°å’Œè§£å†³æ€§èƒ½é—®é¢˜
3. **æå‡ç”¨æˆ·ä½“éªŒ**ï¼šç¡®ä¿åº”ç”¨åœ¨å„ç§æ¡ä»¶ä¸‹éƒ½èƒ½å¿«é€Ÿå“åº”
4. **ä¼˜åŒ–èµ„æºä½¿ç”¨**ï¼šå‡å°‘ä¸å¿…è¦çš„èµ„æºåŠ è½½ï¼Œæé«˜åº”ç”¨æ•ˆç‡

æ­£å¦‚æ€§èƒ½ä¸“å®¶Steve Soudersæ‰€è¯´ï¼š"æ€§èƒ½ä¸æ˜¯äº‹åæ·»åŠ çš„åŠŸèƒ½ï¼Œè€Œæ˜¯è®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚" ğŸ—ï¸

å®æ–½æ€§èƒ½é¢„ç®—éœ€è¦å›¢é˜Ÿåä½œå’ŒæŠ€æœ¯æŠ•å…¥ï¼Œä½†å®ƒå¸¦æ¥çš„å›æŠ¥æ˜¯æ˜¾è‘—çš„ï¼šæ›´å¿«çš„åº”ç”¨ã€æ›´æ»¡æ„çš„ç”¨æˆ·ã€æ›´é«˜çš„è½¬åŒ–ç‡ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¤Ÿå¸®åŠ©ä½ å»ºç«‹è‡ªå·±çš„å‰ç«¯æ€§èƒ½é¢„ç®—ä½“ç³»ï¼Œæ‰“é€ çœŸæ­£é«˜æ€§èƒ½çš„Webåº”ç”¨ã€‚

> "åœ¨Webå¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸å…³æ³¨åŠŸèƒ½å®ç°ï¼Œå´å¿½è§†äº†æ€§èƒ½è¿™ä¸€ç”¨æˆ·ä½“éªŒçš„æ ¸å¿ƒè¦ç´ ã€‚æ€§èƒ½é¢„ç®—æé†’æˆ‘ä»¬ï¼šå¿«ï¼Œä¹Ÿæ˜¯ä¸€ç§åŠŸèƒ½ã€‚"

---

å¦‚æœä½ å¯¹æ€§èƒ½é¢„ç®—æœ‰ä»»ä½•ç–‘é—®æˆ–ç»éªŒåˆ†äº«ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºï¼ğŸ‘‡