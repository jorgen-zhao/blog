---
title: å‰ç«¯APIé›†æˆï¼šæ„å»ºé«˜æ•ˆçš„å‰åç«¯é€šä¿¡æ¶æ„
date: 2026-02-03
tags: [APIé›†æˆ, å‰åç«¯é€šä¿¡, æ•°æ®è·å–]
---

## å‰è¨€

åœ¨å½“ä»Šå¿«é€Ÿå‘å±•çš„å‰ç«¯å¼€å‘é¢†åŸŸï¼Œæˆ‘ä»¬æ¯å¤©éƒ½åœ¨æ„å»ºè¶Šæ¥è¶Šå¤æ‚çš„ç”¨æˆ·ç•Œé¢ã€‚ç„¶è€Œï¼Œæ— è®ºå‰ç«¯æŠ€æœ¯å¦‚ä½•æ¼”è¿›ï¼Œä¸€ä¸ªæ ¸å¿ƒé—®é¢˜å§‹ç»ˆå­˜åœ¨ï¼š**å¦‚ä½•é«˜æ•ˆåœ°ä¸åç«¯APIè¿›è¡Œé€šä¿¡ï¼Ÿ** ğŸ¤”

æˆ‘æ›¾åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­é‡åˆ°è¿™æ ·çš„å›°å¢ƒï¼šå‰ç«¯å›¢é˜ŸèŠ±äº†å¤§é‡æ—¶é—´ä¼˜åŒ–UIæ¸²æŸ“æ€§èƒ½ï¼Œå´å› ä¸ºAPIè°ƒç”¨æ•ˆç‡ä½ä¸‹ï¼Œå¯¼è‡´ç”¨æˆ·ä½“éªŒä¾ç„¶ä¸ä½³ã€‚è¿™è®©æˆ‘æ„è¯†åˆ°ï¼Œ**å‰ç«¯APIé›†æˆ**æ˜¯ä¸€ä¸ªå¸¸è¢«å¿½è§†ä½†åˆè‡³å…³é‡è¦çš„ä¸»é¢˜ã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³å’Œå¤§å®¶åˆ†äº«ä¸€äº›å…³äºæ„å»ºé«˜æ•ˆå‰åç«¯é€šä¿¡æ¶æ„çš„ç»éªŒå’Œæœ€ä½³å®è·µã€‚

::: tip
"ä¼˜ç§€çš„APIè®¾è®¡ä¸ä»…æ˜¯æŠ€æœ¯é—®é¢˜ï¼Œæ›´æ˜¯ç”¨æˆ·ä½“éªŒçš„æ ¸å¿ƒã€‚å‰ç«¯å¼€å‘è€…åº”è¯¥å°†APIé›†æˆè§†ä¸ºä¸€ç­‰å…¬æ°‘ï¼Œè€Œä¸ä»…ä»…æ˜¯æ•°æ®è·å–çš„ç®¡é“ã€‚"
:::

## ä¸ºä»€ä¹ˆAPIé›†æˆå¦‚æ­¤é‡è¦ï¼Ÿ

åœ¨æ·±å…¥æ¢è®¨å…·ä½“æŠ€æœ¯ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç†è§£ä¸ºä»€ä¹ˆAPIé›†æˆå¯¹å‰ç«¯å¼€å‘å¦‚æ­¤å…³é”®ï¼š

- **ç”¨æˆ·ä½“éªŒç›´æ¥å½±å“**ï¼šAPIå“åº”é€Ÿåº¦ç›´æ¥å½±å“ç”¨æˆ·æ„ŸçŸ¥çš„æ€§èƒ½
- **å¼€å‘æ•ˆç‡æå‡**ï¼šè‰¯å¥½çš„APIè®¾è®¡å¯ä»¥æ˜¾è‘—å‡å°‘å‰åç«¯åä½œæˆæœ¬
- **ç³»ç»Ÿå¯ç»´æŠ¤æ€§**ï¼šæ¸…æ™°çš„APIæ¶æ„ä½¿ç³»ç»Ÿæ›´æ˜“äºæ‰©å±•å’Œç»´æŠ¤
- **æ•°æ®ä¸€è‡´æ€§ä¿éšœ**ï¼šè§„èŒƒçš„APIè°ƒç”¨ç¡®ä¿å‰åç«¯æ•°æ®åŒæ­¥

## å¸¸è§çš„APIé›†æˆæ¨¡å¼

### RESTful APIé›†æˆ

RESTï¼ˆRepresentational State Transferï¼‰æ˜¯ç›®å‰æœ€æµè¡Œçš„APIè®¾è®¡é£æ ¼ï¼š

```javascript
// ä½¿ç”¨fetchè·å–ç”¨æˆ·æ•°æ®
async function fetchUserData(userId) {
  try {
    const response = await fetch(`/api/users/${userId}`);
    if (!response.ok) throw new Error('Network response was not ok');
    return await response.json();
  } catch (error) {
    console.error('Error fetching user data:', error);
    return null;
  }
}
```

**ä¼˜ç‚¹**ï¼š
- ç®€å•ç›´è§‚ï¼ŒåŸºäºHTTPæ ‡å‡†
- æ— çŠ¶æ€è®¾è®¡ï¼Œæ˜“äºç¼“å­˜
- å¹¿æ³›çš„å·¥å…·å’Œæ¡†æ¶æ”¯æŒ

**ç¼ºç‚¹**ï¼š
- å¯èƒ½å¯¼è‡´è¿‡åº¦æˆ–ä¸è¶³çš„æ•°æ®ä¼ è¾“
- ç‰ˆæœ¬æ§åˆ¶è¾ƒä¸ºå¤æ‚
- å®æ—¶æ›´æ–°éœ€è¦è½®è¯¢æˆ–WebSocket

### GraphQLé›†æˆ

GraphQLæ˜¯ä¸€ç§APIæŸ¥è¯¢è¯­è¨€ï¼Œå…è®¸å®¢æˆ·ç«¯ç²¾ç¡®è·å–æ‰€éœ€æ•°æ®ï¼š

```javascript
// ä½¿ç”¨Apollo ClientæŸ¥è¯¢ç”¨æˆ·æ•°æ®
const GET_USER = gql`
  query GetUser($id: ID!) {
    user(id: $id) {
      id
      name
      email
      posts {
        id
        title
      }
    }
  }
`;

function UserProfile({ userId }) {
  const { loading, error, data } = useQuery(GET_USER, { variables: { userId } });
  
  if (loading) return <Loading />;
  if (error) return <Error message={error.message} />;
  
  return (
    <div>
      <h2>{data.user.name}</h2>
      <p>{data.user.email}</p>
      <h3>Posts:</h3>
      <ul>
        {data.user.posts.map(post => (
          <li key={post.id}>{post.title}</li>
        ))}
      </ul>
    </div>
  );
}
```

**ä¼˜ç‚¹**ï¼š
- ç²¾ç¡®è·å–æ‰€éœ€æ•°æ®ï¼Œå‡å°‘è¿‡åº¦è·å–
- å•ä¸€ç«¯ç‚¹ï¼Œé¿å…å¤šè¯·æ±‚é—®é¢˜
- å¼ºç±»å‹ç³»ç»Ÿï¼Œä¾¿äºå¼€å‘

**ç¼ºç‚¹**ï¼š
- å­¦ä¹ æ›²çº¿è¾ƒé™¡
- ç¼“å­˜ç­–ç•¥å¤æ‚
- å¯èƒ½å¯¼è‡´N+1æŸ¥è¯¢é—®é¢˜

### RPCé£æ ¼API

è¿œç¨‹è¿‡ç¨‹è°ƒç”¨(RPC)é£æ ¼çš„APIå°†å‡½æ•°è°ƒç”¨æŠ½è±¡ä¸ºç½‘ç»œè¯·æ±‚ï¼š

```javascript
// ä½¿ç”¨gRPCè°ƒç”¨è¿œç¨‹æœåŠ¡
async function processUserImage(imageData) {
  const client = new ImageProcessingServiceClient(
    'localhost:50051',
    credentials.createInsecure()
  );
  
  return new Promise((resolve, reject) => {
    client.processImage({ data: imageData }, (error, response) => {
      if (error) reject(error);
      else resolve(result);
    });
  });
}
```

**ä¼˜ç‚¹**ï¼š
- æ›´æ¥è¿‘æœ¬åœ°å‡½æ•°è°ƒç”¨ä½“éªŒ
- é«˜æ€§èƒ½ï¼Œé€‚åˆå†…éƒ¨æœåŠ¡é€šä¿¡
- å¼ºç±»å‹æ”¯æŒ

**ç¼ºç‚¹**ï¼š
- é€šå¸¸ä¸é€‚ç”¨äºå…¬å¼€API
- å¯èƒ½è¿åRESTçš„æ— çŠ¶æ€åŸåˆ™
- è°ƒè¯•è¾ƒä¸ºå¤æ‚

## APIé›†æˆçš„æœ€ä½³å®è·µ

### 1. é”™è¯¯å¤„ç†ç­–ç•¥

```javascript
// åˆ›å»ºç»Ÿä¸€çš„APIé”™è¯¯å¤„ç†å‡½æ•°
class APIError extends Error {
  constructor(message, status, details) {
    super(message);
    this.status = status;
    this.details = details;
  }
}

async function apiRequest(endpoint, options = {}) {
  try {
    const response = await fetch(endpoint, {
      headers: {
        'Content-Type': 'application/json',
        ...options.headers
      },
      ...options
    });
    
    if (!response.ok) {
      const errorData = await response.json();
      throw new APIError(
        errorData.message || 'API request failed',
        response.status,
        errorData.details
      );
    }
    
    return await response.json();
  } catch (error) {
    if (error instanceof APIError) {
      // å¤„ç†å·²çŸ¥çš„APIé”™è¯¯
      console.error(`API Error [${error.status}]:`, error.message);
    } else {
      // å¤„ç†ç½‘ç»œé”™è¯¯ç­‰å…¶ä»–é”™è¯¯
      console.error('Network Error:', error);
    }
    throw error; // é‡æ–°æŠ›å‡ºä»¥ä¾¿ä¸Šå±‚å¤„ç†
  }
}
```

### 2. è¯·æ±‚å–æ¶ˆä¸è¶…æ—¶

```javascript
// åˆ›å»ºå¸¦æœ‰è¶…æ—¶å’Œå–æ¶ˆåŠŸèƒ½çš„APIè¯·æ±‚
function createCancelableRequest(url, options = {}, timeout = 5000) {
  const controller = new AbortController();
  const timeoutId = setTimeout(() => controller.abort(), timeout);
  
  const request = fetch(url, {
    ...options,
    signal: controller.signal
  });
  
  return {
    request,
    cancel: () => {
      clearTimeout(timeoutId);
      controller.abort();
    }
  };
}

// ä½¿ç”¨ç¤ºä¾‹
const { request, cancel } = createCancelableRequest('/api/data', {
  method: 'GET'
});

request
  .then(response => response.json())
  .then(data => console.log(data))
  .catch(error => {
    if (error.name === 'AbortError') {
      console.log('è¯·æ±‚è¢«å–æ¶ˆæˆ–è¶…æ—¶');
    } else {
      console.error('è¯·æ±‚å¤±è´¥:', error);
    }
  });

// éœ€è¦å–æ¶ˆæ—¶è°ƒç”¨
// cancel();
```

### 3. è¯·æ±‚ç¼“å­˜ä¸å»é‡

```javascript
// å®ç°è¯·æ±‚ç¼“å­˜å’Œå»é‡
class APIClient {
  constructor() {
    this.cache = new Map();
    this.pendingRequests = new Map();
  }
  
  async get(url, options = {}) {
    // æ£€æŸ¥ç¼“å­˜
    const cacheKey = `${url}_${JSON.stringify(options)}`;
    if (this.cache.has(cacheKey)) {
      return this.cache.get(cacheKey);
    }
    
    // æ£€æŸ¥æ˜¯å¦æœ‰ç›¸åŒè¯·æ±‚æ­£åœ¨è¿›è¡Œ
    if (this.pendingRequests.has(cacheKey)) {
      return this.pendingRequests.get(cacheKey);
    }
    
    // åˆ›å»ºæ–°è¯·æ±‚
    const request = fetch(url, options)
      .then(response => response.json())
      .then(data => {
        // ç¼“å­˜ç»“æœ
        this.cache.set(cacheKey, data);
        // ä»å¾…å¤„ç†è¯·æ±‚ä¸­ç§»é™¤
        this.pendingRequests.delete(cacheKey);
        return data;
      })
      .catch(error => {
        // ä»å¾…å¤„ç†è¯·æ±‚ä¸­ç§»é™¤
        this.pendingRequests.delete(cacheKey);
        throw error;
      });
    
    // æ·»åŠ åˆ°å¾…å¤„ç†è¯·æ±‚
    this.pendingRequests.set(cacheKey, request);
    return request;
  }
  
  clearCache() {
    this.cache.clear();
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const apiClient = new APIClient();

// å¤šæ¬¡è°ƒç”¨ç›¸åŒè¯·æ±‚ï¼Œåªä¼šå‘é€ä¸€æ¬¡å®é™…è¯·æ±‚
apiClient.get('/api/users/1').then(data => console.log(data));
apiClient.get('/api/users/1').then(data => console.log(data)); // ä¼šä»ç¼“å­˜è·å–
```

### 4. æ•°æ®è½¬æ¢ä¸é€‚é…

```javascript
// å®ç°æ•°æ®è½¬æ¢å±‚
class DataAdapter {
  constructor(transformers = {}) {
    this.transformers = transformers;
  }
  
  // æ·»åŠ è½¬æ¢å™¨
  addTransformer(type, transformer) {
    this.transformers[type] = transformer;
  }
  
  // è½¬æ¢APIå“åº”
  transform(type, data) {
    if (this.transformers[type]) {
      return this.transformers[type](data);
    }
    return data;
  }
}

// å®šä¹‰è½¬æ¢å™¨
const userTransformer = (apiUser) => ({
  id: apiUser.id,
  fullName: `${apiUser.firstName} ${apiUser.lastName}`,
  email: apiUser.email,
  avatar: apiUser.profileImage?.url || '/default-avatar.png'
});

// ä½¿ç”¨é€‚é…å™¨
const adapter = new DataAdapter({
  user: userTransformer
});

// åœ¨APIè°ƒç”¨ä¸­ä½¿ç”¨
async function fetchUser(userId) {
  const response = await fetch(`/api/users/${userId}`);
  const userData = await response.json();
  return adapter.transform('user', userData);
}
```

## çŠ¶æ€ç®¡ç†ä¸APIé›†æˆ

### ä½¿ç”¨React Queryè¿›è¡Œæ•°æ®è·å–

```javascript
import { useQuery, useMutation, useQueryClient } from 'react-query';

// è·å–ç”¨æˆ·åˆ—è¡¨
function UserList() {
  const { data: users, isLoading, error } = useQuery(
    'users',
    () => fetch('/api/users').then(res => res.json()),
    {
      // é…ç½®é€‰é¡¹
      staleTime: 5 * 60 * 1000, // 5åˆ†é’Ÿå†…æ•°æ®è¢«è§†ä¸ºæ–°é²œ
      cacheTime: 10 * 60 * 1000, // 10åˆ†é’Ÿç¼“å­˜
      refetchOnWindowFocus: false, // çª—å£èšç„¦æ—¶ä¸è‡ªåŠ¨åˆ·æ–°
    }
  );

  if (isLoading) return <div>Loading...</div>;
  if (error) return <div>Error: {error.message}</div>;

  return (
    <ul>
      {users.map(user => (
        <li key={user.id}>{user.name}</li>
      ))}
    </ul>
  );
}

// æ·»åŠ æ–°ç”¨æˆ·
function AddUserForm() {
  const queryClient = useQueryClient();
  const mutation = useMutation(
    (newUser) => fetch('/api/users', {
      method: 'POST',
      body: JSON.stringify(newUser),
    }),
    {
      onSuccess: () => {
        // æˆåŠŸåä½¿ç”¨æˆ·åˆ—è¡¨æŸ¥è¯¢å¤±æ•ˆï¼Œè§¦å‘é‡æ–°è·å–
        queryClient.invalidateQueries('users');
      },
    }
  );

  const handleSubmit = (e) => {
    e.preventDefault();
    const formData = new FormData(e.target);
    const newUser = {
      name: formData.get('name'),
      email: formData.get('email'),
    };
    
    mutation.mutate(newUser);
  };

  return (
    <form onSubmit={handleSubmit}>
      <input name="name" placeholder="Name" required />
      <input name="email" type="email" placeholder="Email" required />
      <button type="submit" disabled={mutation.isLoading}>
        {mutation.isLoading ? 'Adding...' : 'Add User'}
      </button>
    </form>
  );
}
```

### ä½¿ç”¨Redux Toolkitè¿›è¡ŒAPIé›†æˆ

```javascript
import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';

// åˆ›å»ºå¼‚æ­¥thunk
export const fetchUsers = createAsyncThunk('users/fetchUsers', async () => {
  const response = await fetch('/api/users');
  return response.json();
});

// åˆ›å»ºslice
const usersSlice = createSlice({
  name: 'users',
  initialState: {
    entities: [],
    loading: 'idle',
    error: null,
  },
  reducers: {},
  extraReducers: (builder) => {
    builder
      .addCase(fetchUsers.pending, (state) => {
        state.loading = 'pending';
      })
      .addCase(fetchUsers.fulfilled, (state, action) => {
        state.loading = 'fulfilled';
        state.entities = action.payload;
      })
      .addCase(fetchUsers.rejected, (state, action) => {
        state.loading = 'rejected';
        state.error = action.error.message;
      });
  },
});

export default usersSlice.reducer;
```

## APIé›†æˆæµ‹è¯•ç­–ç•¥

### ä½¿ç”¨Mock Service Workerè¿›è¡ŒAPIæ¨¡æ‹Ÿ

```javascript
// åœ¨æµ‹è¯•æ–‡ä»¶ä¸­è®¾ç½®MSW
import { setupServer } from 'msw/node';
import { rest } from 'msw';

const server = setupServer(
  rest.get('/api/users', (req, res, ctx) => {
    return res(
      ctx.status(200),
      ctx.json([
        { id: 1, name: 'John Doe' },
        { id: 2, name: 'Jane Smith' },
      ])
    );
  }),
  rest.post('/api/users', (req, res, ctx) => {
    const { name, email } = req.body;
    return res(
      ctx.status(201),
      ctx.json({ id: 3, name, email })
    );
  })
);

beforeAll(() => server.listen());
afterEach(() => server.resetHandlers());
afterAll(() => server.close());

// æµ‹è¯•ç»„ä»¶
test('UserList renders correctly', async () => {
  render(<UserList />);
  
  // éªŒè¯åŠ è½½çŠ¶æ€
  expect(screen.getByText('Loading...')).toBeInTheDocument();
  
  // ç­‰å¾…æ•°æ®åŠ è½½å®Œæˆ
  await waitFor(() => {
    expect(screen.queryByText('Loading...')).not.toBeInTheDocument();
  });
  
  // éªŒè¯ç”¨æˆ·åˆ—è¡¨
  expect(screen.getByText('John Doe')).toBeInTheDocument();
  expect(screen.getByText('Jane Smith')).toBeInTheDocument();
});
```

### ä½¿ç”¨Jestè¿›è¡ŒAPIé›†æˆæµ‹è¯•

```javascript
// APIå·¥å…·æµ‹è¯•
describe('API Client', () => {
  let apiClient;
  
  beforeEach(() => {
    apiClient = new APIClient();
    fetch.resetMocks();
  });
  
  test('makes GET request successfully', async () => {
    fetch.mockResponseOnce(JSON.stringify({ data: 'test' }));
    
    const result = await apiClient.get('/api/test');
    
    expect(result).toEqual({ data: 'test' });
    expect(fetch).toHaveBeenCalledWith('/api/test', {
      method: 'GET',
      headers: {}
    });
  });
  
  test('handles API errors', async () => {
    fetch.mockRejectOnce(new Error('API error'));
    
    await expect(apiClient.get('/api/test')).rejects.toThrow('API error');
  });
});
```

## ç»“è¯­

å‰ç«¯APIé›†æˆçœ‹ä¼¼ç®€å•ï¼Œä½†å®é™…ä¸Šæ˜¯ä¸€é—¨éœ€è¦æ·±å…¥ç†è§£å’Œå®è·µçš„æŠ€è‰ºã€‚ä»RESTfulåˆ°GraphQLï¼Œä»é”™è¯¯å¤„ç†åˆ°çŠ¶æ€ç®¡ç†ï¼Œæ¯ä¸€ä¸ªç¯èŠ‚éƒ½å¯èƒ½å½±å“æœ€ç»ˆçš„ç”¨æˆ·ä½“éªŒå’Œå¼€å‘æ•ˆç‡ã€‚

ğŸ“¡ **è®°ä½**ï¼šAPIä¸ä»…æ˜¯æ•°æ®çš„ç®¡é“ï¼Œæ›´æ˜¯å‰åç«¯åä½œçš„æ¡¥æ¢ã€‚æŠ•èµ„æ—¶é—´æ„å»ºå¥å£®çš„APIé›†æˆæ¶æ„ï¼Œå°†ä¸ºä½ çš„é¡¹ç›®å¸¦æ¥é•¿è¿œçš„å›æŠ¥ã€‚

::: right
"ä¼˜ç§€çš„APIè®¾è®¡æ˜¯è‰ºæœ¯ä¸ç§‘å­¦çš„ç»“åˆï¼Œå®ƒåº”è¯¥è®©å¼€å‘è€…æ„Ÿåˆ°æ„‰æ‚¦ï¼Œè€Œä¸æ˜¯ç—›è‹¦ã€‚"
::>

å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œå®è·µå‰ç«¯APIé›†æˆã€‚å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–ç»éªŒåˆ†äº«ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï¼ğŸ˜Š

> åœ¨æ„å»ºç°ä»£Webåº”ç”¨çš„è¿‡ç¨‹ä¸­ï¼ŒAPIé›†æˆå¾€å¾€è¢«ä½ä¼°ï¼Œä½†å®ƒå®é™…ä¸Šå†³å®šäº†ä½ çš„åº”ç”¨èƒ½å¦çœŸæ­£æµç•…åœ°è¿è¡Œã€‚ä¸è¦åªå…³æ³¨å‰ç«¯æ¸²æŸ“çš„ä¼˜åŒ–ï¼ŒåŒæ ·è¦é‡è§†APIè°ƒç”¨çš„æ•ˆç‡å’Œå¯é æ€§ã€‚