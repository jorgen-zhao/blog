---
title: React å¼€å‘æŒ‡å—ï¼šä»å…¥é—¨åˆ°ç²¾é€š
date: 2023-11-15 14:30:00
categories: 
  - å‰ç«¯å¼€å‘
tags:
  - React
  - JavaScript
  - å‰ç«¯æ¡†æ¶
author: 
  name: Jorgen
  link: https://github.com/jorgen-zhao
---

## å‰è¨€

ä½œä¸ºä¸€åå‰ç«¯å¼€å‘è€…ï¼Œæˆ‘æ›¾åœ¨ Vue.js çš„ä¸–ç•Œé‡Œç•…æ¸¸è®¸ä¹…ï¼Œä½“éªŒäº†å®ƒçš„ä¼˜é›…å’Œä¾¿æ·ã€‚ç„¶è€Œï¼Œå½“æˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦ React æ—¶ï¼Œé‚£ç§ç»„ä»¶åŒ–çš„æ€ç»´æ–¹å¼å’Œå‡½æ•°å¼ç¼–ç¨‹çš„ç†å¿µæ·±æ·±å¸å¼•äº†æˆ‘ã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹æˆ‘çš„ React å­¦ä¹ ä¹‹æ—…ï¼Œå¸Œæœ›èƒ½å¸®åŠ©æ›´å¤šå¼€å‘è€…æŒæ¡è¿™ä¸ªå¼ºå¤§çš„å‰ç«¯æ¡†æ¶ã€‚

::: tip
React æ˜¯ç”± Facebook å¼€å‘å¹¶ç»´æŠ¤çš„ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ã€‚å®ƒé‡‡ç”¨ç»„ä»¶åŒ–å¼€å‘æ¨¡å¼ï¼Œé€šè¿‡è™šæ‹Ÿ DOM æé«˜æ¸²æŸ“æ•ˆç‡ï¼Œæ˜¯ç›®å‰æœ€æµè¡Œçš„å‰ç«¯æ¡†æ¶ä¹‹ä¸€ã€‚
:::

## React ç®€ä»‹

React ä¹‹æ‰€ä»¥èƒ½åœ¨ä¼—å¤šå‰ç«¯æ¡†æ¶ä¸­è„±é¢–è€Œå‡ºï¼Œä¸»è¦å¾—ç›Šäºä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒç‰¹æ€§ï¼š

- **ç»„ä»¶åŒ–å¼€å‘**ï¼šå°† UI æ‹†åˆ†ä¸ºç‹¬ç«‹ã€å¯å¤ç”¨çš„ç»„ä»¶
- **è™šæ‹Ÿ DOM**ï¼šé€šè¿‡å†…å­˜ä¸­çš„ DOM è¡¨ç¤ºæé«˜æ¸²æŸ“æ€§èƒ½
- **å•å‘æ•°æ®æµ**ï¼šæ•°æ®æµå‘æ¸…æ™°ï¼Œä¾¿äºè°ƒè¯•å’Œç»´æŠ¤
- **JSX è¯­æ³•**ï¼šåœ¨ JavaScript ä¸­ç¼–å†™ç±»ä¼¼ HTML çš„ä»£ç 

## ç¯å¢ƒæ­å»º

å¼€å§‹ React å¼€å‘å‰ï¼Œæˆ‘ä»¬éœ€è¦æ­å»ºå¼€å‘ç¯å¢ƒã€‚æˆ‘æ¨èä½¿ç”¨ Create React Appï¼Œè¿™æ˜¯å®˜æ–¹æä¾›çš„è„šæ‰‹æ¶å·¥å…·ï¼š

```bash
npx create-react-app my-react-app
cd my-react-app
npm start
```

å‡ ç§’é’Ÿåï¼Œä½ å°±ä¼šçœ‹åˆ°ä¸€ä¸ªé»˜è®¤çš„ React åº”ç”¨åœ¨æµè§ˆå™¨ä¸­è¿è¡Œã€‚ğŸ‰

## JSX è¯­æ³•åˆæ¢

JSX æ˜¯ React çš„æ ¸å¿ƒè¯­æ³•ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨ JavaScript ä¸­ç¼–å†™ç±»ä¼¼ HTML çš„ä»£ç ï¼š

```jsx
function Welcome(props) {
  return <h1>Hello, {props.name}</h1>;
}

const element = <Welcome name="Jorgen" />;
```

åˆšå¼€å§‹æ¥è§¦ JSX æ—¶å¯èƒ½ä¼šæœ‰äº›ä¸ä¹ æƒ¯ï¼Œä½†ä¸€æ—¦é€‚åº”äº†è¿™ç§è¯­æ³•ï¼Œä½ ä¼šå‘ç°å®ƒå¤§å¤§æé«˜äº†ç»„ä»¶çš„å¯è¯»æ€§å’Œå¼€å‘æ•ˆç‡ã€‚

::: theorem
JSX æœ€ç»ˆä¼šè¢« Babel è½¬æ¢ä¸º React.createElement() è°ƒç”¨ï¼Œæ‰€ä»¥å®é™…ä¸Šå®ƒåªæ˜¯ React çš„ä¸€ç§è¯­æ³•ç³–ã€‚
:::

## ç»„ä»¶ä¸ Props

React çš„æ ¸å¿ƒæ€æƒ³æ˜¯ç»„ä»¶åŒ–ã€‚ç»„ä»¶æ˜¯ React åº”ç”¨çš„æ„å»ºå—ï¼Œå®ƒä»¬æ¥æ”¶è¾“å…¥ï¼ˆç§°ä¸º propsï¼‰å¹¶è¿”å›æè¿° UI çš„ React å…ƒç´ ã€‚

### å‡½æ•°ç»„ä»¶

```jsx
function Welcome(props) {
  return <h1>Hello, {props.name}</h1>;
}
```

### ç±»ç»„ä»¶

```jsx
class Welcome extends React.Component {
  render() {
    return <h1>Hello, {this.props.name}</h1>;
  }
}
```

åœ¨ç°ä»£ React å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æ›´å€¾å‘äºä½¿ç”¨å‡½æ•°ç»„ä»¶ï¼Œå°¤å…¶æ˜¯åœ¨é…åˆ Hooks ä½¿ç”¨æ—¶ã€‚

## State ä¸ç”Ÿå‘½å‘¨æœŸ

åœ¨ç±»ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ state æ¥ç®¡ç†ç»„ä»¶å†…éƒ¨çš„çŠ¶æ€ï¼š

```jsx
class Clock extends React.Component {
  constructor(props) {
    super(props);
    this.state = { date: new Date() };
  }

  componentDidMount() {
    this.timerID = setInterval(
      () => this.setState({ date: new Date() }),
      1000
    );
  }

  componentWillUnmount() {
    clearInterval(this.timerID);
  }

  render() {
    return (
      <div>
        <h1>Hello, world!</h1>
        <h2>ç°åœ¨æ˜¯ {this.state.date.toLocaleTimeString()}.</h2>
      </div>
    );
  }
}
```

## Hooksï¼šå‡½æ•°ç»„ä»¶çš„å¼ºå¤§åŠŸèƒ½

React Hooks æ˜¯ React 16.8 å¼•å…¥çš„æ–°ç‰¹æ€§ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨ state å’Œå…¶ä»– React ç‰¹æ€§ï¼š

```jsx
import React, { useState, useEffect } from 'react';

function Clock() {
  const [date, setDate] = useState(new Date());

  useEffect(() => {
    const timerID = setInterval(() => setDate(new Date()), 1000);
    return () => clearInterval(timerID);
  }, []);

  return (
    <div>
      <h1>Hello, world!</h1>
      <h2>ç°åœ¨æ˜¯ {date.toLocaleTimeString()}.</h2>
    </div>
  );
}
```

å¸¸ç”¨çš„ Hooks åŒ…æ‹¬ï¼š
- `useState`ï¼šåœ¨å‡½æ•°ç»„ä»¶ä¸­æ·»åŠ  state
- `useEffect`ï¼šå¤„ç†å‰¯ä½œç”¨ï¼ˆæ•°æ®è·å–ã€è®¢é˜…æˆ–æ‰‹åŠ¨ä¿®æ”¹ DOMï¼‰
- `useContext`ï¼šè®¿é—® React çš„ Context
- `useReducer`ï¼šç®¡ç†å¤æ‚çš„çŠ¶æ€é€»è¾‘
- `useCallback` å’Œ `useMemo`ï¼šä¼˜åŒ–æ€§èƒ½

## äº‹ä»¶å¤„ç†

React äº‹ä»¶å¤„ç†ç³»ç»Ÿä¸åŸç”Ÿ DOM äº‹ä»¶æœ‰æ‰€ä¸åŒï¼š

```jsx
function Toggle(props) {
  const [isToggleOn, setIsToggleOn] = useState(true);

  function handleClick() {
    setIsToggleOn(prevState => !prevState);
  }

  return (
    <button onClick={handleClick}>
      {isToggleOn ? 'å…³é—­' : 'å¼€å¯'}
    </button>
  );
}
```

æ³¨æ„ï¼ŒReact äº‹ä»¶åé‡‡ç”¨é©¼å³°å‘½åæ³•ï¼Œå¦‚ `onClick` è€Œä¸æ˜¯ `onclick`ã€‚

## æ¡ä»¶æ¸²æŸ“

React ä¸­æœ‰å¤šç§æ¡ä»¶æ¸²æŸ“çš„æ–¹å¼ï¼š

```jsx
function Greeting({ isLoggedIn }) {
  if (isLoggedIn) {
    return <UserGreeting />;
  }
  return <GuestGreeting />;
}

// æˆ–è€…ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦
function Greeting({ isLoggedIn }) {
  return (
    <div>
      {isLoggedIn ? <UserGreeting /> : <GuestGreeting />}
    </div>
  );
}

// æˆ–è€…ä½¿ç”¨ &&
function Mailbox({ unreadMessages }) {
  return (
    <div>
      <h1>æ‚¨çš„é‚®ç®±</h1>
      {unreadMessages.length > 0 &&
        <h2>æ‚¨æœ‰ {unreadMessages.length} å°æœªè¯»é‚®ä»¶ã€‚</h2>
      }
    </div>
  );
}
```

## åˆ—è¡¨ä¸ Keys

åœ¨ React ä¸­æ¸²æŸ“åˆ—è¡¨æ—¶ï¼Œéœ€è¦ä¸ºæ¯ä¸ªåˆ—è¡¨é¡¹æŒ‡å®šä¸€ä¸ª key å±æ€§ï¼š

```jsx
function NumberList({ numbers }) {
  const listItems = numbers.map(number => 
    <li key={number.toString()}>
      {number}
    </li>
  );
  return (
    <ul>{listItems}</ul>
  );
}
```

Keys å¸®åŠ© React è¯†åˆ«å“ªäº›å…ƒç´ å‘ç”Ÿäº†å˜åŒ–ï¼Œä»è€Œæé«˜æ¸²æŸ“æ•ˆç‡ã€‚

## è¡¨å•å¤„ç†

React ä¸­çš„è¡¨å•å¤„ç†ä¸åŸç”Ÿ HTML è¡¨å•æœ‰äº›ä¸åŒï¼š

```jsx
function NameForm(props) {
  const [value, setValue] = useState('');

  const handleChange = (event) => {
    setValue(event.target.value);
  }

  const handleSubmit = (event) => {
    alert('æäº¤çš„åå­—: ' + value);
    event.preventDefault();
  }

  return (
    <form onSubmit={handleSubmit}>
      <label>
        åå­—:
        <input type="text" value={value} onChange={handleChange} />
      </label>
      <input type="submit" value="æäº¤" />
    </form>
  );
}
```

## çŠ¶æ€æå‡

åœ¨ React ä¸­ï¼Œå…±äº«çŠ¶æ€åº”è¯¥æå‡åˆ°æœ€è¿‘çš„å…±åŒç¥–å…ˆç»„ä»¶ä¸­ï¼š

```jsx
function BoilingVerdict(props) {
  if (props.celsius >= 100) {
    return <p>æ°´ä¼šæ²¸è…¾ã€‚</p>;
  }
  return <p>æ°´ä¸ä¼šæ²¸è…¾ã€‚</p>;
}

function Calculator(props) {
  const [temperature, setTemperature] = useState('');
  const [scale, setScale] = useState('c');

  const handleCelsiusChange = (value) => {
    setTemperature(value);
    setScale('c');
  }

  const handleFahrenheitChange = (value) => {
    setTemperature(value);
    setScale('f');
  }

  const celsius = scale === 'f' ? tryConvert(temperature, toCelsius) : temperature;
  const fahrenheit = scale === 'c' ? tryConvert(temperature, toFahrenheit) : temperature;

  return (
    <div>
      <TemperatureInput
        scale="c"
        temperature={celsius}
        onTemperatureChange={handleCelsiusChange} />
      <TemperatureInput
        scale="f"
        temperature={fahrenheit}
        onTemperatureChange={handleFahrenheitChange} />
      <BoilingVerdict
        celsius={parseFloat(celsius)} />
    </div>
  );
}
```

## Contextï¼šè·¨ç»„ä»¶ä¼ é€’æ•°æ®

å½“éœ€è¦åœ¨å¤šä¸ªç»„ä»¶é—´å…±äº«æ•°æ®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ React Contextï¼š

```jsx
const ThemeContext = React.createContext('light');

function ThemedButton(props) {
  return (
    <ThemeContext.Consumer>
      {theme => (
        <button className={theme} {...props}>
          {props.children}
        </button>
      )}
    </ThemeContext.Consumer>
  );
}

function App() {
  return (
    <ThemeContext.Provider value="dark">
      <ThemedButton>ç‚¹å‡»æˆ‘</ThemedButton>
    </ThemeContext.Provider>
  );
}
```

## æ€§èƒ½ä¼˜åŒ–

React åº”ç”¨ä¸­å¸¸è§çš„æ€§èƒ½ä¼˜åŒ–æŠ€å·§ï¼š

1. **ä½¿ç”¨ React.memo** ç¼“å­˜ç»„ä»¶æ¸²æŸ“ç»“æœ
```jsx
const MemoizedComponent = React.memo(function MyComponent(props) {
  /* æ¸²æŸ“é€»è¾‘ */
});
```

2. **ä½¿ç”¨ useMemo å’Œ useCallback** ç¼“å­˜è®¡ç®—ç»“æœå’Œå‡½æ•°
```jsx
const memoizedValue = useMemo(() => computeExpensiveValue(a, b), [a, b]);

const memoizedCallback = useCallback(() => {
  doSomething(a, b);
}, [a, b]);
```

3. **ä½¿ç”¨ React.PureComponent** æ›¿ä»£ React.Component
```jsx
class Greeting extends React.PureComponent {
  render() {
    return <h1>Hello, {this.props.name}</h1>;
  }
}
```

## ç»“è¯­

React æ˜¯ä¸€ä¸ªå¼ºå¤§è€Œçµæ´»çš„å‰ç«¯æ¡†æ¶ï¼Œå®ƒé€šè¿‡ç»„ä»¶åŒ–ã€è™šæ‹Ÿ DOM å’Œ Hooks ç­‰ç‰¹æ€§ï¼Œä¸ºç°ä»£ Web å¼€å‘æä¾›äº†é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚è™½ç„¶å­¦ä¹ æ›²çº¿å¯èƒ½æœ‰äº›é™¡å³­ï¼Œä½†ä¸€æ—¦æŒæ¡äº† React çš„æ ¸å¿ƒæ¦‚å¿µï¼Œä½ å°±èƒ½æ„å»ºå‡ºé«˜æ€§èƒ½ã€å¯ç»´æŠ¤çš„ç”¨æˆ·ç•Œé¢ã€‚

::: right
"å­¦ä¹  React ä¸ä»…æ˜¯å­¦ä¹ ä¸€ä¸ªæ¡†æ¶ï¼Œæ›´æ˜¯å­¦ä¹ ä¸€ç§æ„å»ºç”¨æˆ·ç•Œé¢çš„æ€ç»´æ–¹å¼ã€‚"
:::

ä½œä¸ºä¸€åå‰ç«¯å¼€å‘è€…ï¼ŒæŒæ¡ React æ˜¯éå¸¸æœ‰ä»·å€¼çš„ã€‚å®ƒä¸ä»…èƒ½å¸®åŠ©ä½ æ„å»ºå‡ºè‰²çš„ Web åº”ç”¨ï¼Œè¿˜èƒ½è®©ä½ æ›´å¥½åœ°ç†è§£ç°ä»£å‰ç«¯å¼€å‘çš„æœ€ä½³å®è·µã€‚å¸Œæœ›è¿™ç¯‡æŒ‡å—èƒ½å¸®åŠ©ä½ é¡ºåˆ©å¼€å¯ React ä¹‹æ—…ï¼

> æœ€åï¼Œè®°ä½ç¼–ç¨‹ä¸ä»…ä»…æ˜¯å†™ä»£ç ï¼Œæ›´æ˜¯ä¸€ç§è§£å†³é—®é¢˜çš„è‰ºæœ¯ã€‚ä¿æŒå¥½å¥‡å¿ƒï¼Œä¸æ–­å­¦ä¹ ï¼Œä½ å°†åœ¨ React çš„ä¸–ç•Œé‡Œå‘ç°æ›´å¤šå¯èƒ½æ€§ï¼ğŸš€