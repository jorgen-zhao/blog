```yaml
---
title: å‰ç«¯çŠ¶æ€ç®¡ç†ï¼šä»Fluxåˆ°ç°ä»£è§£å†³æ–¹æ¡ˆ
date: 2023-10-05 14:30:00
permalink: /pages/abc123/
categories: 
  - å‰ç«¯å¼€å‘
tags:
  - çŠ¶æ€ç®¡ç†
  - React
  - Vue
  - Redux
  - MobX
author: 
  name: Jorgen
  link: https://github.com/jorgen-zhao
---

## å‰è¨€

åœ¨æ„å»ºå¤æ‚å‰ç«¯åº”ç”¨æ—¶ï¼ŒçŠ¶æ€ç®¡ç†å°±åƒåº”ç”¨çš„å¤§è„‘ğŸ§ ï¼Œå†³å®šç€æ•°æ®å¦‚ä½•æµåŠ¨å’Œå“åº”ã€‚è™½ç„¶Reactå’ŒVueæä¾›äº†åŸºç¡€çš„çŠ¶æ€ç®¡ç†èƒ½åŠ›ï¼Œä½†å½“åº”ç”¨è§„æ¨¡æ‰©å¤§æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¼ºå¤§çš„è§£å†³æ–¹æ¡ˆã€‚æœ¬æ–‡å°†å¸¦ä½ æ¢ç´¢ä»Fluxæ¶æ„åˆ°ç°ä»£çŠ¶æ€ç®¡ç†åº“çš„æ¼”è¿›ä¹‹è·¯ï¼ŒåŠ©ä½ åœ¨é¡¹ç›®ä¸­åšå‡ºæ˜æ™ºé€‰æ‹©ã€‚

::: tip
"çŠ¶æ€ç®¡ç†ä¸æ˜¯é“¶å¼¹ï¼Œè€Œæ˜¯è§£å†³ç‰¹å®šè§„æ¨¡åº”ç”¨æ•°æ®æµçš„å·¥å…·é“¾"
:::

## ä¸ºä»€ä¹ˆéœ€è¦çŠ¶æ€ç®¡ç†ï¼Ÿ

### å‰ç«¯åº”ç”¨çš„å¤æ‚åº¦æŒ‘æˆ˜

éšç€å•é¡µåº”ç”¨(SPA)çš„æ™®åŠï¼Œå‰ç«¯åº”ç”¨éœ€è¦å¤„ç†ï¼š
- å¤æ‚çš„ç”¨æˆ·äº¤äº’æµç¨‹
- å¤šç»„ä»¶é—´çš„æ•°æ®å…±äº«
- å¼‚æ­¥æ“ä½œä¸UIçŠ¶æ€åŒæ­¥
- è·¨ç»„ä»¶é€šä¿¡

> å½“Reactç»„ä»¶æ ‘æ·±åº¦è¶…è¿‡3å±‚ï¼Œprops drillingï¼ˆå±æ€§é’»å–ï¼‰ä¼šè®©ä»£ç éš¾ä»¥ç»´æŠ¤ã€‚Vueçš„provide/injectè™½ç„¶èƒ½è§£å†³éƒ¨åˆ†é—®é¢˜ï¼Œä½†åœ¨å¤§å‹é¡¹ç›®ä¸­ä»æ˜¾ä¸è¶³ã€‚

### ç°æœ‰æ–‡ç« çš„ç›²åŒº

åˆ†æç°æœ‰åšå®¢åˆ—è¡¨ï¼Œå‘ç°è™½ç„¶è¦†ç›–äº†Reactã€Vueã€å·¥ç¨‹åŒ–ç­‰ä¸»é¢˜ï¼Œä½†ç¼ºå°‘ä¸“é—¨è®¨è®ºçŠ¶æ€ç®¡ç†çš„ç³»ç»Ÿæ€§æ–‡ç« ã€‚è¿™å°±åƒå»ºé€ æˆ¿å­æœ‰äº†ç –ç“¦å’Œæ°´æ³¥ï¼Œå´ç¼ºå°‘äº†å…³é”®çš„é’¢ç­‹éª¨æ¶ã€‚

## çŠ¶æ€ç®¡ç†æ¼”è¿›å²

### 1. Fluxæ¶æ„é©å‘½

::: theorem
Fluxæ˜¯Facebookäº2014å¹´æå‡ºçš„å•å‘æ•°æ®æµæ¶æ„ï¼Œé¢ è¦†äº†ä¼ ç»Ÿçš„MVCæ¨¡å¼
::`

```mermaid
graph LR
A[View] --> B[Dispatcher]
B --> C[Store]
C --> A
```

**æ ¸å¿ƒç‰¹ç‚¹**ï¼š
- å•å‘æ•°æ®æµï¼šAction â†’ Dispatcher â†’ Store â†’ View
- Storeä¸å¯å˜ï¼šæ‰€æœ‰çŠ¶æ€å˜æ›´å¿…é¡»é€šè¿‡Dispatcher
- æ•°æ®å¯é¢„æµ‹ï¼šçŠ¶æ€å˜åŒ–è½¨è¿¹æ¸…æ™°å¯è¿½è¸ª

> ğŸ¤” ä¸ºä»€ä¹ˆReduxä¼šæˆä¸ºFluxçš„æµè¡Œå®ç°ï¼Ÿå› ä¸ºReduxç®€åŒ–äº†Fluxçš„æ ¸å¿ƒæ€æƒ³ï¼Œå¼•å…¥äº†çº¯å‡½æ•°Reducerå’Œä¸­é—´ä»¶æœºåˆ¶ã€‚

### 2. ç°ä»£çŠ¶æ€ç®¡ç†å·¥å…·å¯¹æ¯”

| å·¥å…·å       | é€‚ç”¨åœºæ™¯                 | æ ¸å¿ƒä¼˜åŠ¿                     | å­¦ä¹ æ›²çº¿ |
|--------------|--------------------------|------------------------------|----------|
| Redux        | å¤§å‹å¤æ‚åº”ç”¨             | å¼ºå¤§çš„ä¸­é—´ä»¶ç”Ÿæ€ï¼Œæ—¶é—´æ—…è¡Œè°ƒè¯• | ä¸­é«˜     |
| MobX         | ä¸­å°å‹åº”ç”¨ï¼Œé¢å‘å¯¹è±¡é£æ ¼ | å“åº”å¼ç¼–ç¨‹ï¼Œæç®€API          | ä½       |
| Vuex         | Vueç”Ÿæ€                 | é›†æˆVueå“åº”å¼ç³»ç»Ÿ            | ä¸­       |
| Context API  | å°å‹Reactç»„ä»¶æ ‘         | æ— éœ€é¢å¤–åº“                   | ä½       |
| Zustand      | è½»é‡çº§éœ€æ±‚              | æç®€APIï¼ŒTypeScriptå‹å¥½      | ä½       |

## å®æˆ˜åœºæ™¯ï¼šç”µå•†è´­ç‰©è½¦

### ä¼ ç»Ÿæ–¹æ¡ˆç—›ç‚¹

```javascript
// å±æ€§é’»å–ç¤ºä¾‹
function GrandParent() {
  const [cart, setCart] = useState([]);
  
  return <Parent cart={cart} setCart={setCart} />;
}

function Parent({ cart, setCart }) {
  return <Child cart={cart} setCart={setCart} />;
}

function Child({ cart, setCart }) {
  // æ¯ä¸ªç»„ä»¶éƒ½è¦ä¼ é€’props
}
```

### ä½¿ç”¨Reduxè§£å†³æ–¹æ¡ˆ

```javascript
// actions/cart.js
export const addToCart = (product) => ({
  type: 'cart/add',
  payload: product
});

// reducers/cart.js
export const cartReducer = (state = [], action) => {
  switch (action.type) {
    case 'cart/add':
      return [...state, action.payload];
    default:
      return state;
  }
};
```

### MobXå“åº”å¼æ–¹æ¡ˆ

```javascript
import { makeAutoObservable } from 'mobx';

class CartStore {
  items = [];
  
  constructor() {
    makeAutoObservable(this);
  }
  
  addItem(product) {
    this.items.push(product);
  }
}

// ç»„ä»¶ä¸­ä½¿ç”¨
const cartStore = new CartStore();
function ProductCard({ product }) {
  return (
    <div>
      <h2>{product.name}</h2>
      <button onClick={() => cartStore.addItem(product)}>
        åŠ å…¥è´­ç‰©è½¦
      </button>
    </div>
  );
}
```

## é€‰æ‹©æŒ‡å—

### å°å‹é¡¹ç›®ï¼ˆ<5ä¸ªç»„ä»¶ï¼‰
**æ¨èæ–¹æ¡ˆ**ï¼šReact Context + useReducer  
âœ… ä¼˜åŠ¿ï¼šé›¶ä¾èµ–ï¼ŒReactå†…ç½®æ”¯æŒ  
âŒ ç¼ºç‚¹ï¼šæ·±å±‚ç»„ä»¶ä»éœ€ä¼ é€’context

### ä¸­å‹é¡¹ç›®ï¼ˆ5-20ä¸ªç»„ä»¶ï¼‰
**æ¨èæ–¹æ¡ˆ**ï¼šZustand æˆ– MobX  
âœ… ä¼˜åŠ¿ï¼š  
- Zustandï¼šæç®€APIï¼ŒTypeScriptæ”¯æŒå¥½  
- MobXï¼šå“åº”å¼ç¼–ç¨‹ï¼Œé¢å‘å¯¹è±¡å‹å¥½

### å¤§å‹é¡¹ç›®ï¼ˆ>20ä¸ªç»„ä»¶ï¼‰
**æ¨èæ–¹æ¡ˆ**ï¼šRedux Toolkit  
âœ… ä¼˜åŠ¿ï¼š  
- å¼ºå¤§çš„å¼€å‘è€…å·¥å…·  
- ä¸­é—´ä»¶ç”Ÿæ€ï¼ˆRedux-Saga, Redux-Thunkï¼‰  
- æ—¶é—´æ—…è¡Œè°ƒè¯•

## æœªæ¥è¶‹åŠ¿

1. **å¾®å‰ç«¯çŠ¶æ€ç®¡ç†**  
   æ¯ä¸ªå¾®å‰ç«¯æ‹¥æœ‰ç‹¬ç«‹çŠ¶æ€ï¼Œé€šè¿‡äº‹ä»¶æ€»çº¿é€šä¿¡

2. **Server Stateé›†æˆ**  
   çŠ¶æ€ç®¡ç†å·¥å…·å¼€å§‹æ”¯æŒæ•°æ®è·å–ï¼ˆå¦‚React Query + Zustandï¼‰

3. **WebAssemblyåŠ é€Ÿ**  
   å¤æ‚è®¡ç®—é€»è¾‘ç§»è‡³WASMæå‡æ€§èƒ½

## ç»“è¯­

çŠ¶æ€ç®¡ç†æ²¡æœ‰é“¶å¼¹ï¼Œé€‰æ‹©å–å†³äºé¡¹ç›®è§„æ¨¡å’Œå›¢é˜Ÿåå¥½ã€‚è®°ä½ï¼š

> "å¥½çš„çŠ¶æ€ç®¡ç†åº”è¯¥è®©å¼€å‘è€…ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ï¼Œè€Œéæ•°æ®ä¼ é€’ç»†èŠ‚"

å»ºè®®ä»Context APIå¼€å§‹ï¼Œéšç€é¡¹ç›®å¤æ‚åº¦é€æ­¥å‡çº§åˆ°Zustandæˆ–Redux Toolkitã€‚æœ€é‡è¦çš„æ˜¯ä¿æŒçŠ¶æ€å˜æ›´çš„å¯é¢„æµ‹æ€§ï¼Œè¿™æ¯”é€‰æ‹©ä»»ä½•å…·ä½“æ¡†æ¶éƒ½é‡è¦ã€‚

::: right
"çŠ¶æ€ç®¡ç†ä¸æ˜¯ç›®çš„ï¼Œè€Œæ˜¯æ‰‹æ®µ â€”â€” è®©ä»£ç æ›´æ˜“ç»´æŠ¤ï¼Œæ‰æ˜¯æœ€ç»ˆç›®æ ‡"
:::
```