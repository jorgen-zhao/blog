---
title: å‰ç«¯å·¥ç¨‹åŒ–ï¼šæ„å»ºé«˜æ•ˆç°ä»£Webåº”ç”¨çš„è‰ºæœ¯
date: 2023-11-15 09:30:00
categories: 
  - å‰ç«¯å¼€å‘
tags:
  - å·¥ç¨‹åŒ–
  - æ„å»ºå·¥å…·
  - è‡ªåŠ¨åŒ–
  - å¼€å‘æ•ˆç‡
author: 
  name: Jorgen
  link: https://github.com/jorgen-zhao
---

## å‰è¨€

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Jorgenï¼ğŸ‘‹ åœ¨è¿™ä¸ªå¿«é€Ÿå‘å±•çš„å‰ç«¯ä¸–ç•Œé‡Œï¼Œæˆ‘ä»¬æ¯å¤©éƒ½åœ¨å­¦ä¹ æ–°æŠ€æœ¯ã€æ–°æ¡†æ¶ï¼Œä»Vue.jsåˆ°WebAssemblyï¼Œä»å°ç¨‹åºåˆ°å„ç§é…·ç‚«çš„åº“ã€‚~~ä½†è¯´å®è¯ï¼Œæœ‰æ—¶å€™æˆ‘è§‰å¾—è‡ªå·±åƒä¸ªæŠ€æœ¯æ”¶è—å®¶ï¼Œæ”¶è—äº†ä¸€å †å·¥å…·å´ä¸çŸ¥é“å¦‚ä½•é«˜æ•ˆåœ°ä½¿ç”¨å®ƒä»¬~~ã€‚ğŸ˜‚

ä»Šå¤©æˆ‘æƒ³å’Œå¤§å®¶èŠèŠä¸€ä¸ªä¸é‚£ä¹ˆ"é…·ç‚«"ä½†å´è‡³å…³é‡è¦çš„ä¸»é¢˜â€”â€”å‰ç«¯å·¥ç¨‹åŒ–ã€‚ğŸ—ï¸ è™½ç„¶å®ƒä¸åƒé‚£äº›æ–°æ¡†æ¶é‚£æ ·å¼•äººæ³¨ç›®ï¼Œä½†å®ƒå´æ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­æå‡æ•ˆç‡ã€ä¿è¯è´¨é‡çš„åŸºçŸ³ã€‚

::: tip
å‰ç«¯å·¥ç¨‹åŒ–ä¸ä»…ä»…æ˜¯ä½¿ç”¨æ„å»ºå·¥å…·ï¼Œå®ƒæ˜¯ä¸€ç§æ€ç»´æ–¹å¼ï¼Œæ˜¯å°†å·¥ç¨‹åŒ–æ–¹æ³•åº”ç”¨åˆ°å‰ç«¯å¼€å‘ä¸­çš„è¿‡ç¨‹ã€‚
:::

## ä»€ä¹ˆæ˜¯å‰ç«¯å·¥ç¨‹åŒ–ï¼Ÿ

å‰ç«¯å·¥ç¨‹åŒ–æ˜¯æŒ‡å°†è½¯ä»¶å·¥ç¨‹çš„æ–¹æ³•å’ŒåŸåˆ™åº”ç”¨åˆ°å‰ç«¯å¼€å‘ä¸­ï¼Œé€šè¿‡å·¥å…·é“¾ã€è§„èŒƒå’Œæµç¨‹æ¥æé«˜å¼€å‘æ•ˆç‡ã€ä¿è¯ä»£ç è´¨é‡ã€é™ä½ç»´æŠ¤æˆæœ¬çš„è¿‡ç¨‹ã€‚

åœ¨æˆ‘åˆšå¼€å§‹å†™ä»£ç çš„æ—¶å€™ï¼Œæˆ‘å¸¸å¸¸æŠŠå·¥ç¨‹åŒ–ç†è§£ä¸º"é…ç½®Webpack"ï¼Œä½†éšç€ç»éªŒçš„ç§¯ç´¯ï¼Œæˆ‘é€æ¸è®¤è¯†åˆ°å®ƒè¿œä¸æ­¢äºæ­¤ã€‚ğŸ¤”

### å‰ç«¯å·¥ç¨‹åŒ–çš„æ ¸å¿ƒè¦ç´ 

1. **æ¨¡å—åŒ–å¼€å‘**ï¼šå°†ä»£ç æ‹†åˆ†ä¸ºå¯å¤ç”¨çš„æ¨¡å—
2. **ç»„ä»¶åŒ–å¼€å‘**ï¼šæ„å»ºå¯å¤ç”¨çš„UIç»„ä»¶
3. **è‡ªåŠ¨åŒ–æ„å»º**ï¼šä½¿ç”¨å·¥å…·è‡ªåŠ¨åŒ–ç¼–è¯‘ã€æ‰“åŒ…æµç¨‹
4. **ä»£ç è§„èŒƒ**ï¼šç»Ÿä¸€çš„ä»£ç é£æ ¼å’Œæœ€ä½³å®è·µ
5. **æµ‹è¯•é©±åŠ¨**ï¼šå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œç«¯åˆ°ç«¯æµ‹è¯•
6. **æŒç»­é›†æˆ/æŒç»­éƒ¨ç½²(CI/CD)**ï¼šè‡ªåŠ¨åŒ–æµ‹è¯•å’Œéƒ¨ç½²æµç¨‹

## æ„å»ºå·¥å…·çš„é€‰æ‹©ä¸é…ç½®

æ„å»ºå·¥å…·æ˜¯å‰ç«¯å·¥ç¨‹åŒ–çš„æ ¸å¿ƒï¼Œå®ƒå°†æˆ‘ä»¬çš„æºä»£ç è½¬æ¢ä¸ºå¯åœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„ä»£ç ã€‚ç›®å‰ä¸»æµçš„æ„å»ºå·¥å…·æœ‰Webpackã€Viteã€Parcelç­‰ã€‚

### Webpackï¼šè€ç‰Œç‹è€…

Webpackå¯ä»¥è¯´æ˜¯å‰ç«¯æ„å»ºå·¥å…·çš„"å¸¸é’æ ‘"ï¼ŒåŠŸèƒ½å¼ºå¤§ä¸”ç”Ÿæ€æˆç†Ÿã€‚

```javascript
// webpack.config.js åŸºç¡€é…ç½®ç¤ºä¾‹
const path = require('path');
const HtmlWebpackPlugin = require('html-webpack-plugin');

module.exports = {
  entry: './src/index.js',
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: 'bundle.[contenthash].js'
  },
  module: {
    rules: [
      {
        test: /\.css$/,
        use: ['style-loader', 'css-loader']
      },
      {
        test: /\.js$/,
        exclude: /node_modules/,
        use: {
          loader: 'babel-loader',
          options: {
            presets: ['@babel/preset-env']
          }
        }
      }
    ]
  },
  plugins: [
    new HtmlWebpackPlugin({
      template: './src/index.html'
    })
  ]
};
```

::: theorem
Webpackçš„æ ¸å¿ƒæ¦‚å¿µæ˜¯å…¥å£(entry)ã€å‡ºå£(output)ã€åŠ è½½å™¨(loader)å’Œæ’ä»¶(plugins)ã€‚ç†è§£è¿™äº›æ¦‚å¿µæ˜¯æŒæ¡Webpackçš„å…³é”®ã€‚
:::

### Viteï¼šæ–°ä¸€ä»£æ„å»ºå·¥å…·

Viteæ˜¯ç”±Vueä½œè€…å°¤é›¨æºªå¼€å‘çš„æ–°ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·ï¼Œå®ƒåˆ©ç”¨æµè§ˆå™¨åŸç”Ÿçš„ESæ¨¡å—æ”¯æŒï¼Œå®ç°äº†æå¿«çš„çƒ­æ›´æ–°é€Ÿåº¦ã€‚

```javascript
// vite.config.js åŸºç¡€é…ç½®ç¤ºä¾‹
import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue';

export default defineConfig({
  plugins: [vue()],
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['vue', 'vue-router']
        }
      }
    }
  }
});
```

::: tip
Viteæœ€å¤§çš„ä¼˜åŠ¿åœ¨äºå¼€å‘ä½“éªŒï¼Œç‰¹åˆ«æ˜¯çƒ­æ›´æ–°é€Ÿåº¦å‡ ä¹æ˜¯ç¬æ—¶çš„ã€‚ä½†åœ¨ç”Ÿäº§æ„å»ºæ–¹é¢ï¼Œå®ƒä»ç„¶ä¾èµ–äºRollupã€‚
:::

## è‡ªåŠ¨åŒ–å·¥ä½œæµ

ç°ä»£å‰ç«¯å¼€å‘ä¸ä»…ä»…æ˜¯å†™ä»£ç ï¼Œè¿˜åŒ…æ‹¬ä»£ç æ£€æŸ¥ã€æ ¼å¼åŒ–ã€æµ‹è¯•ã€éƒ¨ç½²ç­‰ä¸€ç³»åˆ—æµç¨‹ã€‚è‡ªåŠ¨åŒ–è¿™äº›æµç¨‹å¯ä»¥å¤§å¤§æé«˜å¼€å‘æ•ˆç‡ã€‚

### ä»£ç è´¨é‡å·¥å…·

#### ESLint + Prettier

ESLintç”¨äºæ£€æŸ¥ä»£ç è´¨é‡å’Œé£æ ¼é—®é¢˜ï¼ŒPrettieråˆ™è´Ÿè´£ä»£ç æ ¼å¼åŒ–ã€‚ä¸¤è€…ç»“åˆä½¿ç”¨å¯ä»¥ç¡®ä¿å›¢é˜Ÿä»£ç é£æ ¼çš„ä¸€è‡´æ€§ã€‚

```json
// .eslintrc.json é…ç½®ç¤ºä¾‹
{
  "env": {
    "browser": true,
    "es2021": true
  },
  "extends": [
    "eslint:recommended",
    "plugin:vue/vue3-recommended",
    "prettier"
  ],
  "parserOptions": {
    "ecmaVersion": "latest",
    "sourceType": "module"
  },
  "rules": {
    "no-console": "warn",
    "vue/multi-word-component-names": "off"
  }
}
```

#### Husky + lint-staged

Huskyå¯ä»¥Git hooksï¼Œåœ¨æäº¤ä»£ç å‰è¿è¡Œæ£€æŸ¥ï¼Œlint-stagedåˆ™åªå¯¹æš‚å­˜çš„æ–‡ä»¶è¿›è¡Œæ£€æŸ¥ã€‚

```json
// package.json é…ç½®ç¤ºä¾‹
{
  "husky": {
    "hooks": {
      "pre-commit": "lint-staged"
    }
  },
  "lint-staged": {
    "*.{js,vue}": [
      "eslint --fix",
      "prettier --write"
    ]
  }
}
```

### è‡ªåŠ¨åŒ–æµ‹è¯•

æµ‹è¯•æ˜¯ä¿è¯ä»£ç è´¨é‡çš„é‡è¦æ‰‹æ®µï¼Œç°ä»£å‰ç«¯é¡¹ç›®é€šå¸¸åŒ…å«å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œç«¯åˆ°ç«¯æµ‹è¯•ã€‚

#### Jest + Vue Test Utils

Jestæ˜¯æµè¡Œçš„JavaScriptæµ‹è¯•æ¡†æ¶ï¼ŒVue Test Utilsæ˜¯ä¸“é—¨ä¸ºVueç»„ä»¶è®¾è®¡çš„æµ‹è¯•å·¥å…·ã€‚

```javascript
// ç»„ä»¶æµ‹è¯•ç¤ºä¾‹
import { mount } from '@vue/test-utils';
import MyComponent from '@/components/MyComponent.vue';

describe('MyComponent', () => {
  it('renders correctly', () => {
    const wrapper = mount(MyComponent);
    expect(wrapper.text()).toContain('Hello World');
  });
  
  it('emits event when button is clicked', async () => {
    const wrapper = mount(MyComponent);
    await wrapper.find('button').trigger('click');
    expect(wrapper.emitted().click).toBeTruthy();
  });
});
```

### CI/CD æµæ°´çº¿

ä½¿ç”¨GitHub Actionsã€GitLab CIç­‰å·¥å…·å¯ä»¥è®¾ç½®è‡ªåŠ¨åŒ–çš„æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²æµç¨‹ã€‚

```yaml
# .github/workflows/ci.yml ç¤ºä¾‹
name: CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '16'
      - run: npm install
      - run: npm run test:unit
      - run: npm run build
```

## å·¥ç¨‹åŒ–æœ€ä½³å®è·µ

åœ¨æˆ‘å¤šå¹´çš„å‰ç«¯å¼€å‘ç»éªŒä¸­ï¼Œæ€»ç»“äº†ä¸€äº›å·¥ç¨‹åŒ–æœ€ä½³å®è·µï¼š

### 1. æ¨¡å—åŒ–ä¸ç»„ä»¶åŒ–

å°†ä»£ç æ‹†åˆ†ä¸ºå°çš„ã€å¯å¤ç”¨çš„æ¨¡å—å’Œç»„ä»¶ï¼Œæ˜¯æé«˜ä»£ç å¯ç»´æŠ¤æ€§çš„å…³é”®ã€‚

```javascript
// å¥½çš„æ¨¡å—åŒ–ç¤ºä¾‹
// utils/date.js
export function formatDate(date, format) {
  // æ ¼å¼åŒ–æ—¥æœŸé€»è¾‘
}

// components/Button.vue
<template>
  <button class="btn" @click="$emit('click')">
    <slot></slot>
  </button>
</template>

<script>
export default {
  name: 'AppButton',
  emits: ['click']
}
</script>

<style scoped>
.btn {
  /* æŒ‰é’®æ ·å¼ */
}
</style>
```

### 2. ç¯å¢ƒå˜é‡ç®¡ç†

ä½¿ç”¨ç¯å¢ƒå˜é‡æ¥ç®¡ç†ä¸åŒç¯å¢ƒä¸‹çš„é…ç½®ï¼Œé¿å…ç¡¬ç¼–ç ã€‚

```bash
# .env.development
VUE_APP_API_URL=http://localhost:3000/api

# .env.production
VUE_APP_API_URL=https://api.example.com
```

### 3. æ€§èƒ½ä¼˜åŒ–

æ„å»ºå·¥å…·æä¾›äº†å¤šç§æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µï¼š

- ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰
- æ‡’åŠ è½½ï¼ˆLazy Loadingï¼‰
- ç¼“å­˜ç­–ç•¥ï¼ˆCachingï¼‰
- èµ„æºå‹ç¼©ï¼ˆMinificationï¼‰

```javascript
// è·¯ç”±æ‡’åŠ è½½ç¤ºä¾‹
const routes = [
  {
    path: '/about',
    name: 'About',
    component: () => import(/* webpackChunkName: "about" */ '../views/About.vue')
  }
];
```

## ç»“è¯­

å‰ç«¯å·¥ç¨‹åŒ–æ˜¯ä¸€ä¸ªæŒç»­æ¼”è¿›çš„è¿‡ç¨‹ï¼Œæ²¡æœ‰ä¸€æˆä¸å˜çš„"æœ€ä½³å®è·µ"ã€‚éšç€æŠ€æœ¯çš„å‘å±•å’Œé¡¹ç›®éœ€æ±‚çš„å˜åŒ–ï¼Œæˆ‘ä»¬çš„å·¥ç¨‹åŒ–æ–¹æ¡ˆä¹Ÿéœ€è¦ä¸æ–­è°ƒæ•´å’Œä¼˜åŒ–ã€‚

::: right
"å·¥ç¨‹åŒ–çš„ç›®æ ‡ä¸æ˜¯ä½¿ç”¨æœ€é…·çš„å·¥å…·ï¼Œè€Œæ˜¯è§£å†³å®é™…é—®é¢˜ã€‚"
::>

å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å‰ç«¯å·¥ç¨‹åŒ–ï¼Œå¹¶åœ¨ä½ çš„é¡¹ç›®ä¸­å®è·µè¿™äº›ç†å¿µã€‚è®°ä½ï¼Œå¥½çš„å·¥ç¨‹åŒ–åº”è¯¥è®©å¼€å‘æ›´ç®€å•ï¼Œè€Œä¸æ˜¯æ›´å¤æ‚ã€‚ğŸš€

å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–è€…æƒ³åˆ†äº«ä½ çš„å·¥ç¨‹åŒ–ç»éªŒï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºï¼æˆ‘ä»¬ä¸€èµ·è¿›æ­¥ï¼ğŸ˜Š

> æœ€åï¼Œæˆ‘æƒ³è¯´ï¼Œå‰ç«¯å·¥ç¨‹åŒ–å°±åƒæ˜¯æˆ¿å­çš„åœ°åŸºï¼Œè™½ç„¶çœ‹ä¸è§ï¼Œä½†å´å†³å®šäº†æˆ¿å­èƒ½å»ºå¤šé«˜ã€èƒ½æ‰¿å—å¤šå¤§çš„é£é›¨ã€‚æŠ•èµ„æ—¶é—´æ¥æ„å»ºè‰¯å¥½çš„å·¥ç¨‹åŒ–åŸºç¡€ï¼Œç»å¯¹æ˜¯å€¼å¾—çš„ï¼