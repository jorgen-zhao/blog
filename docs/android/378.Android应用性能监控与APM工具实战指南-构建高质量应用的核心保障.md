---
title: Androidåº”ç”¨æ€§èƒ½ç›‘æ§ä¸APMå·¥å…·å®æˆ˜æŒ‡å—-æ„å»ºé«˜è´¨é‡åº”ç”¨çš„æ ¸å¿ƒä¿éšœ
date: 2026-02-05
tags: [Androidæ€§èƒ½, APMå·¥å…·, åº”ç”¨ç›‘æ§]
---

## å‰è¨€

å—¨ï¼Œæˆ‘æ˜¯Jorgenï¼ğŸ‘‹ åœ¨Androidå¼€å‘çš„æ—…ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¸“æ³¨äºåŠŸèƒ½çš„å®ç°å’Œç•Œé¢çš„ç¾è§‚ï¼Œå´å®¹æ˜“å¿½è§†ä¸€ä¸ªè‡³å…³é‡è¦çš„æ–¹é¢â€”â€”åº”ç”¨æ€§èƒ½ç›‘æ§ã€‚~~ï¼ˆåˆ«é—®æˆ‘æ€ä¹ˆçŸ¥é“çš„ï¼Œé—®å°±æ˜¯è¡€æ³ªå²ï¼‰~~

éšç€Androidåº”ç”¨çš„æ—¥ç›Šå¤æ‚ï¼Œç”¨æˆ·å¯¹æµç•…ä½“éªŒçš„è¦æ±‚ä¹Ÿè¶Šæ¥è¶Šé«˜ã€‚ä¸€ä¸ªå¡é¡¿ã€å´©æºƒæˆ–å“åº”ç¼“æ…¢çš„åº”ç”¨ï¼Œå†ç²¾ç¾çš„UIä¹Ÿæ— æ³•ç•™ä½ç”¨æˆ·ã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³å’Œå¤§å®¶åˆ†äº«å¦‚ä½•åˆ©ç”¨APMï¼ˆApplication Performance Monitoringï¼‰å·¥å…·æ¥æ„å»ºé«˜è´¨é‡çš„åº”ç”¨ï¼Œç¡®ä¿æˆ‘ä»¬çš„ä½œå“åœ¨ç”¨æˆ·æ‰‹ä¸­èƒ½å¤Ÿå§‹ç»ˆä¿æŒæœ€ä½³çŠ¶æ€ã€‚

::: tip
æ€§èƒ½ä¸æ˜¯ä¸€æ¬¡æ€§çš„ä¼˜åŒ–ï¼Œè€Œæ˜¯ä¸€ä¸ªæŒç»­ç›‘æ§å’Œæ”¹è¿›çš„è¿‡ç¨‹ã€‚APMå·¥å…·å°±åƒåº”ç”¨çš„"å¥åº·ç›‘æµ‹ä»ª"ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿå®æ—¶äº†è§£åº”ç”¨çŠ¶æ€ï¼ŒåŠæ—¶å‘ç°å¹¶è§£å†³é—®é¢˜ã€‚
:::

## APMå·¥å…·æ¦‚è¿°

APMå·¥å…·æ˜¯ä¸“é—¨ç”¨äºç›‘æ§ã€åˆ†æå’Œä¼˜åŒ–åº”ç”¨ç¨‹åºæ€§èƒ½çš„è½¯ä»¶è§£å†³æ–¹æ¡ˆã€‚å®ƒä»¬å¯ä»¥å¸®åŠ©å¼€å‘è€…ï¼š

- å®æ—¶ç›‘æ§åº”ç”¨æ€§èƒ½æŒ‡æ ‡
- æ•è·å’Œåˆ†æå´©æºƒæŠ¥å‘Š
- è¿½è¸ªç”¨æˆ·è¡Œä¸ºå’Œè·¯å¾„
- è¯†åˆ«æ€§èƒ½ç“¶é¢ˆå’Œå¼‚å¸¸
- æä¾›è¯¦ç»†çš„æ€§èƒ½åˆ†ææŠ¥å‘Š

### ä¸»æµAndroid APMå·¥å…·å¯¹æ¯”

| å·¥å…·åç§° | ç‰¹ç‚¹ | ä¼˜åŠ¿ | é€‚ç”¨åœºæ™¯ |
|---------|------|------|---------|
| Firebase Performance Monitoring | Googleå®˜æ–¹é›†æˆï¼Œç®€å•æ˜“ç”¨ | æ— éœ€é¢å¤–æœåŠ¡å™¨ï¼Œä¸Firebaseç”Ÿæ€æ— ç¼é›†æˆ | ä¸­å°å‹åº”ç”¨ï¼Œéœ€è¦å¿«é€Ÿéƒ¨ç½² |
| Bugsnag | ä¸“æ³¨å´©æºƒå’Œé”™è¯¯ç›‘æ§ | è¯¦ç»†çš„é”™è¯¯ä¸Šä¸‹æ–‡ï¼Œæ™ºèƒ½åˆ†ç»„ | å¯¹ç¨³å®šæ€§è¦æ±‚é«˜çš„åº”ç”¨ |
| Sentry | å¼€æºï¼Œå¯è‡ªæ‰˜ç®¡ | é«˜åº¦å¯å®šåˆ¶ï¼Œå¼ºå¤§çš„é”™è¯¯è¿½è¸ª | å¤§å‹ä¼ä¸šåº”ç”¨ï¼Œéœ€è¦ç§æœ‰åŒ–éƒ¨ç½² |
| Instabug | åŠŸèƒ½å…¨é¢ï¼Œæ”¯æŒç”¨æˆ·åé¦ˆ | ä¸€é”®æˆªå›¾å½•å±ï¼Œç”¨æˆ·ç›´æ¥å‚ä¸ | éœ€è¦ç”¨æˆ·åé¦ˆçš„åº”ç”¨ |
| Dynatrace | ä¼ä¸šçº§APMè§£å†³æ–¹æ¡ˆ | å…¨æ ˆç›‘æ§ï¼ŒAIåˆ†æ | å¤§å‹ä¼ä¸šï¼Œå¤æ‚åº”ç”¨æ¶æ„ |

## Firebase Performance Monitoringå®æˆ˜

Firebase Performance Monitoringæ˜¯Googleå®˜æ–¹æä¾›çš„æ€§èƒ½ç›‘æ§å·¥å…·ï¼Œä¸Firebaseå…¶ä»–æœåŠ¡æ·±åº¦é›†æˆï¼Œä½¿ç”¨ç®€å•ä¸”åŠŸèƒ½å¼ºå¤§ã€‚

### é›†æˆæ­¥éª¤

1. **æ·»åŠ ä¾èµ–**

```gradle
// build.gradle (Module: app)
dependencies {
    implementation 'com.google.firebase:firebase-perf:20.5.0'
}
```

2. **å¯ç”¨Performance Monitoring**

```kotlin
// Applicationç±»ä¸­åˆå§‹åŒ–
class MyApp : Application() {
    override fun onCreate() {
        super.onCreate()
        FirebaseApp.initializeApp(this)
        FirebasePerformance.getInstance().isPerformanceCollectionEnabled = true
    }
}
```

3. **è‡ªå®šä¹‰ç›‘æ§**

```kotlin
// åˆ›å»ºè‡ªå®šä¹‰æ€§èƒ½æŒ‡æ ‡
val trace = FirebasePerformance.getInstance().newTrace("custom_trace")

trace.start()
// æ‰§è¡Œéœ€è¦ç›‘æ§çš„æ“ä½œ
trace.stop()
```

### ç›‘æ§å…³é”®æŒ‡æ ‡

Firebase Performance Monitoringä¼šè‡ªåŠ¨ç›‘æ§ä»¥ä¸‹æŒ‡æ ‡ï¼š

- åº”ç”¨å¯åŠ¨æ—¶é—´
- ç½‘ç»œè¯·æ±‚æ€§èƒ½
- æ•°æ®åº“æ“ä½œæ€§èƒ½
- åå°ä»»åŠ¡æ‰§è¡Œæ—¶é—´

æˆ‘ä»¬å¯ä»¥é€šè¿‡Firebaseæ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†çš„æ•°æ®åˆ†æå’Œè¶‹åŠ¿å›¾è¡¨ï¼Œå¸®åŠ©æˆ‘ä»¬å‘ç°æ€§èƒ½é—®é¢˜ã€‚

```kotlin
// ç›‘æ§ç½‘ç»œè¯·æ±‚
val networkTrace = FirebasePerformance.getInstance().newHttpMetric("https://api.example.com/data", FirebasePerformance.HttpMethod.GET)

networkTrace.start()
// æ‰§è¡Œç½‘ç»œè¯·æ±‚
networkTrace.stop()
```

## Bugsnagå´©æºƒç›‘æ§å®æˆ˜

Bugsnagä¸“æ³¨äºé”™è¯¯å’Œå´©æºƒç›‘æ§ï¼Œæä¾›è¯¦ç»†çš„é”™è¯¯ä¸Šä¸‹æ–‡ï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå®šä½é—®é¢˜ã€‚

### é›†æˆæ­¥éª¤

1. **æ·»åŠ ä¾èµ–**

```gradle
// build.gradle (Module: app)
dependencies {
    implementation 'com.bugsnag:bugsnag-android:6.0.0'
}
```

2. **åˆå§‹åŒ–Bugsnag**

```kotlin
// Applicationç±»ä¸­åˆå§‹åŒ–
class MyApp : Application() {
    override fun onCreate() {
        super.onCreate()
        Bugsnag.start(this)
    }
}
```

3. **è‡ªåŠ¨æ•è·å¼‚å¸¸**

Bugsnagä¼šè‡ªåŠ¨æ•è·æœªå¤„ç†çš„å¼‚å¸¸ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨æŠ¥å‘Šé”™è¯¯ï¼š

```kotlin
try {
    // å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç 
} catch (e: Exception) {
    Bugsnag.notify(e)
}
```

### é«˜çº§åŠŸèƒ½

Bugsnagæä¾›äº†ä¸€äº›é«˜çº§åŠŸèƒ½ï¼Œå¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£é”™è¯¯ï¼š

```kotlin
// æ·»åŠ é”™è¯¯æ ‡ç­¾
Bugsnag.addToTab("user", "id", "12345")
Bugsnag.addToTab("device", "model", "Pixel 4")

// å‘é€é”™è¯¯é€šçŸ¥
Bugsnag.notify(RuntimeException("Something went wrong"), Severity.ERROR)

// æ·»åŠ ä¸Šä¸‹æ–‡ä¿¡æ¯
Bugsnag.context("User registration flow")
```

## Sentryé”™è¯¯è¿½è¸ªå®æˆ˜

Sentryæ˜¯ä¸€ä¸ªå¼€æºçš„APMå·¥å…·ï¼Œæ”¯æŒè‡ªæ‰˜ç®¡ï¼Œé€‚åˆå¯¹æ•°æ®éšç§æœ‰è¦æ±‚çš„ä¼ä¸šã€‚

### é›†æˆæ­¥éª¤

1. **æ·»åŠ ä¾èµ–**

```gradle
// build.gradle (Module: app)
dependencies {
    implementation 'io.sentry:sentry-android:6.25.0'
}
```

2. **åˆå§‹åŒ–Sentry**

```kotlin
// Applicationç±»ä¸­åˆå§‹åŒ–
class MyApp : Application() {
    override fun onCreate() {
        super.onCreate()
        Sentry.init { options ->
            options.dsn = "YOUR_DSN_HERE"
            options.tracesSampleRate = 1.0
        }
    }
}
```

3. **æ•è·äº‹ä»¶**

```kotlin
try {
    // å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç 
} catch (e: Exception) {
    Sentry.captureException(e)
}

// æˆ–è€…æ‰‹åŠ¨å‘é€äº‹ä»¶
Sentry.captureMessage("Something happened")
```

### æ€§èƒ½ç›‘æ§

Sentryè¿˜æä¾›äº†æ€§èƒ½ç›‘æ§åŠŸèƒ½ï¼š

```kotlin
// åˆ›å»ºäº‹åŠ¡
val transaction = Sentry.startTransaction("ExampleTransaction", "http")

// æ·»åŠ _span
val span = transaction.startChild("ExampleSpan")

// æ‰§è¡Œæ“ä½œ
span.finish()

// ç»“æŸäº‹åŠ¡
transaction.finish()
```

## è‡ªå®šä¹‰æ€§èƒ½ç›‘æ§

é™¤äº†ä½¿ç”¨ç°æˆçš„APMå·¥å…·ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å®ç°è‡ªå®šä¹‰çš„æ€§èƒ½ç›‘æ§ï¼Œé’ˆå¯¹ç‰¹å®šåœºæ™¯è¿›è¡Œä¼˜åŒ–ã€‚

### åº”ç”¨å¯åŠ¨ç›‘æ§

```kotlin
class StartupTimeMonitor {
    private val startTime = System.currentTimeMillis()
    
    fun logColdStartTime() {
        val coldStartTime = System.currentTimeMillis() - startTime
        Log.d("StartupTime", "Cold start time: ${coldStartTime}ms")
        
        // å¯ä»¥å‘é€åˆ°APMå·¥å…·
        FirebasePerformance.getInstance().newTrace("cold_start").apply {
            putMetric("duration", coldStartTime.toDouble())
            stop()
        }
    }
}
```

### å¸§ç‡ç›‘æ§

```kotlin
class FrameRateMonitor {
    private val frameTimestamps = mutableListOf<Long>()
    private val handler = Handler(Looper.getMainLooper())
    private var isMonitoring = false
    
    fun startMonitoring() {
        isMonitoring = true
        handler.post(frameRateRunnable)
    }
    
    fun stopMonitoring() {
        isMonitoring = false
        handler.removeCallbacks(frameRateRunnable)
    }
    
    private val frameRateRunnable = object : Runnable {
        override fun run() {
            if (!isMonitoring) return
            
            frameTimestamps.add(System.currentTimeMillis())
            
            // ä¿ç•™æœ€è¿‘1ç§’çš„å¸§æ—¶é—´æˆ³
            val oneSecondAgo = System.currentTimeMillis() - 1000
            while (frameTimestamps.isNotEmpty() && frameTimestamps[0] < oneSecondAgo) {
                frameTimestamps.removeAt(0)
            }
            
            val fps = frameTimestamps.size
            Log.d("FrameRate", "Current FPS: $fps")
            
            handler.postDelayed(this, 1000)
        }
    }
}
```

### å†…å­˜ä½¿ç”¨ç›‘æ§

```kotlin
class MemoryMonitor {
    fun logMemoryUsage() {
        val runtime = Runtime.getRuntime()
        val usedMemory = runtime.totalMemory() - runtime.freeMemory()
        val maxMemory = runtime.maxMemory()
        val percentage = (usedMemory.toDouble() / maxMemory * 100).toInt()
        
        Log.d("MemoryUsage", "Used: ${usedMemory / 1024 / 1024}MB, Max: ${maxMemory / 1024 / 1024}MB, $percentage%")
        
        // å¦‚æœå†…å­˜ä½¿ç”¨è¶…è¿‡80%ï¼Œå‘å‡ºè­¦å‘Š
        if (percentage > 80) {
            Log.w("MemoryWarning", "Memory usage is high: $percentage%")
        }
    }
}
```

## APMæ•°æ®è§£è¯»ä¸ä¼˜åŒ–

æ”¶é›†åˆ°æ€§èƒ½æ•°æ®åï¼Œå¦‚ä½•è§£è¯»è¿™äº›æ•°æ®å¹¶é‡‡å–ä¼˜åŒ–æªæ–½æ˜¯å…³é”®ã€‚

### å…³é”®æ€§èƒ½æŒ‡æ ‡(KPI)

1. **å¸§ç‡(FPS)**
   - 60 FPS: æµç•…ä½“éªŒ
   - 30-50 FPS: å¯æ¥å—ä½†ç•¥æœ‰å¡é¡¿
   - <30 FPS: æ˜æ˜¾å¡é¡¿

2. **åº”ç”¨å¯åŠ¨æ—¶é—´**
   - å†·å¯åŠ¨: <2ç§’ä¸ºè‰¯å¥½
   - çƒ­å¯åŠ¨: <0.5ç§’ä¸ºè‰¯å¥½

3. **å†…å­˜ä½¿ç”¨**
   - å•è¿›ç¨‹å»ºè®®ä¸è¶…è¿‡200MB
   - å†…å­˜æ³„æ¼æ£€æµ‹æ˜¯å…³é”®

4. **ç½‘ç»œè¯·æ±‚æ—¶é—´**
   - ç®€å•è¯·æ±‚: <500ms
   - å¤æ‚æ•°æ®è¯·æ±‚: <2s

### ä¼˜åŒ–ç­–ç•¥

åŸºäºAPMæ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–ä»¥ä¸‹ä¼˜åŒ–ç­–ç•¥ï¼š

1. **UIä¼˜åŒ–**
   - å‡å°‘è¿‡åº¦ç»˜åˆ¶
   - ä½¿ç”¨RecyclerViewæ›¿ä»£ListView
   - ä¼˜åŒ–å¸ƒå±€å±‚çº§

2. **å†…å­˜ä¼˜åŒ–**
   - é¿å…å†…å­˜æ³„æ¼
   - ä½¿ç”¨å¯¹è±¡æ± 
   - åŠæ—¶é‡Šæ”¾èµ„æº

3. **ç½‘ç»œä¼˜åŒ–**
   - ä½¿ç”¨ç¼“å­˜
   - è¯·æ±‚åˆå¹¶
   - æ•°æ®å‹ç¼©

4. **ä»£ç ä¼˜åŒ–**
   - é¿å…ä¸»çº¿ç¨‹é˜»å¡
   - ä½¿ç”¨åç¨‹å¤„ç†å¼‚æ­¥ä»»åŠ¡
   - ä¼˜åŒ–ç®—æ³•å¤æ‚åº¦

## ç»“è¯­

APMå·¥å…·æ˜¯ç°ä»£Androidåº”ç”¨å¼€å‘ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä»¬å¸®åŠ©æˆ‘ä»¬æ„å»ºé«˜è´¨é‡ã€é«˜æ€§èƒ½çš„åº”ç”¨ã€‚é€šè¿‡Firebase Performance Monitoringã€Bugsnagã€Sentryç­‰å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥å®æ—¶ç›‘æ§åº”ç”¨çŠ¶æ€ï¼ŒåŠæ—¶å‘ç°å¹¶è§£å†³é—®é¢˜ã€‚

è®°ä½ï¼Œæ€§èƒ½ä¼˜åŒ–ä¸æ˜¯ä¸€æ¬¡æ€§çš„å·¥ä½œï¼Œè€Œæ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ã€‚ğŸ”„ å®šæœŸæ£€æŸ¥APMæ•°æ®ï¼Œåˆ†ææ€§èƒ½è¶‹åŠ¿ï¼Œä¸æ–­ä¼˜åŒ–æˆ‘ä»¬çš„åº”ç”¨ï¼Œæ‰èƒ½ä¸ºç”¨æˆ·æä¾›æœ€ä½³çš„ä½“éªŒã€‚

å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨APMå·¥å…·ã€‚å¦‚æœä½ æœ‰å…¶ä»–APMå·¥å…·çš„ä½¿ç”¨ç»éªŒæˆ–è€…ä¼˜åŒ–æŠ€å·§ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ï¼ğŸ‘‡

> æ€§èƒ½ä¼˜åŒ–å°±åƒé©¬æ‹‰æ¾ï¼Œä¸æ˜¯çŸ­è·‘ã€‚æŒç»­ç›‘æ§ï¼ŒæŒç»­æ”¹è¿›ï¼Œæ‰èƒ½æ‰“é€ çœŸæ­£ä¼˜ç§€çš„åº”ç”¨ã€‚