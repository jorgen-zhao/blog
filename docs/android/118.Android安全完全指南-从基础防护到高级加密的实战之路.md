---
title: Androidå®‰å…¨å®Œå…¨æŒ‡å—-ä»åŸºç¡€é˜²æŠ¤åˆ°é«˜çº§åŠ å¯†çš„å®æˆ˜ä¹‹è·¯
date: 2026-01-28
tags: [Androidå®‰å…¨, æ•°æ®åŠ å¯†, å®‰å…¨ç¼–ç ]
---

## å‰è¨€

ä½œä¸ºä¸€åAndroidå¼€å‘è€…ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¸“æ³¨äºå®ç°åŠŸèƒ½ã€ä¼˜åŒ–æ€§èƒ½å’Œæå‡ç”¨æˆ·ä½“éªŒã€‚ç„¶è€Œï¼Œåœ¨è¿½æ±‚è¿™äº›ç›®æ ‡çš„åŒæ—¶ï¼Œæœ‰ä¸€ä¸ªè‡³å…³é‡è¦çš„æ–¹é¢æˆ‘ä»¬ç»ä¸èƒ½å¿½è§†â€”â€”**å®‰å…¨**ã€‚ğŸ›¡ï¸ éšç€ç§»åŠ¨åº”ç”¨è¶Šæ¥è¶Šæ·±å…¥æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ï¼Œä¿æŠ¤ç”¨æˆ·æ•°æ®å’Œéšç§å˜å¾—å‰æ‰€æœªæœ‰çš„é‡è¦ã€‚

::: tip
"å®‰å…¨ä¸æ˜¯ä¸€æ¬¡æ€§çš„ä»»åŠ¡ï¼Œè€Œæ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ã€‚"
:::

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å¸¦å¤§å®¶å…¨é¢äº†è§£Androidåº”ç”¨å®‰å…¨çš„å…³é”®æ–¹é¢ï¼Œä»åŸºç¡€çš„å®‰å…¨ç¼–ç å®è·µåˆ°é«˜çº§çš„æ•°æ®åŠ å¯†æŠ€æœ¯ï¼Œå¸®åŠ©å¤§å®¶æ„å»ºæ›´åŠ å®‰å…¨å¯é çš„Androidåº”ç”¨ã€‚

## Androidå®‰å…¨çš„é‡è¦æ€§

åœ¨æ·±å…¥æ¢è®¨å…·ä½“æŠ€æœ¯ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç†è§£ä¸ºä»€ä¹ˆAndroidå®‰å…¨å¦‚æ­¤é‡è¦ï¼š

1. **ç”¨æˆ·ä¿¡ä»»** - å®‰å…¨æ¼æ´ä¼šä¸¥é‡æŸå®³ç”¨æˆ·å¯¹åº”ç”¨çš„ä¿¡ä»»
2. **æ•°æ®ä¿æŠ¤** - ä¿æŠ¤ç”¨æˆ·ä¸ªäººä¿¡æ¯ã€æ”¯ä»˜ä¿¡æ¯ç­‰æ•æ„Ÿæ•°æ®
3. **æ³•å¾‹åˆè§„** - éµå¾ªGDPRã€CCPAç­‰éšç§æ³•è§„è¦æ±‚
4. **å“ç‰Œå£°èª‰** - å®‰å…¨äº‹ä»¶å¯èƒ½å¯¼è‡´å“ç‰Œå½¢è±¡å—æŸ
5. **å•†ä¸šè¿ç»­æ€§** - å®‰å…¨æ¼æ´å¯èƒ½å¯¼è‡´åº”ç”¨è¢«ä¸‹æ¶ï¼Œå½±å“ä¸šåŠ¡è¿è¥

> "åœ¨æ•°å­—æ—¶ä»£ï¼Œå®‰å…¨ä¸æ˜¯é€‰æ‹©ï¼Œè€Œæ˜¯å¿…éœ€å“ã€‚"

## Androidå®‰å…¨åŸºç¡€

### å®‰å…¨ç¼–ç å®è·µ

å®‰å…¨çš„ç¬¬ä¸€é“é˜²çº¿æ˜¯ç¼–å†™å®‰å…¨çš„ä»£ç ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…³é”®çš„å®‰å…¨ç¼–ç å®è·µï¼š

#### è¾“å…¥éªŒè¯

```kotlin
// é”™è¯¯çš„åšæ³• - ç›´æ¥ä¿¡ä»»ç”¨æˆ·è¾“å…¥
fun processInput(input: String) {
    val command = "rm -rf " + input
    Runtime.getRuntime().exec(command)
}

// æ­£ç¡®çš„åšæ³• - ä¸¥æ ¼éªŒè¯å’Œæ¸…ç†è¾“å…¥
fun processInputSafely(input: String) {
    if (input.matches(Regex("^[a-zA-Z0-9_]+$"))) {
        // å®‰å…¨å¤„ç†è¾“å…¥
    } else {
        // æ‹’ç»æ— æ•ˆè¾“å…¥
    }
}
```

#### é¿å…ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯

```kotlin
// é”™è¯¯çš„åšæ³• - åœ¨ä»£ç ä¸­ç¡¬ç¼–ç APIå¯†é’¥
const val API_KEY = "sk-1234567890abcdef"

// æ­£ç¡®çš„åšæ³• - ä»å®‰å…¨çš„ä½ç½®è·å–å¯†é’¥
val apiKey: String by lazy {
    val key = KeystoreManager.getSecretKey("api_key")
    if (key.isNullOrEmpty()) throw IllegalStateException("API key not configured")
    key
}
```

#### æœ€å°æƒé™åŸåˆ™

åªè¯·æ±‚åº”ç”¨çœŸæ­£éœ€è¦çš„æƒé™ï¼Œå¹¶åœ¨ä½¿ç”¨ååŠæ—¶æ’¤é”€ï¼š

```kotlin
// åªåœ¨éœ€è¦æ—¶è¯·æ±‚ä½ç½®æƒé™
private fun requestLocationPermission() {
    if (checkSelfPermission(Manifest.permission.ACCESS_FINE_LOCATION) 
        != PackageManager.PERMISSION_GRANTED) {
        requestPermissions(arrayOf(Manifest.permission.ACCESS_FINE_LOCATION), LOCATION_REQUEST_CODE)
    }
}

// ä½¿ç”¨å®Œä½ç½®åä¸å†ä¿æŒæƒé™
private fun releaseLocationPermission() {
    // åº”ç”¨é€»è¾‘å¤„ç†å®Œæ¯•å
}
```

### ç½‘ç»œå®‰å…¨

#### HTTPSå¼ºåˆ¶æ‰§è¡Œ

```kotlin
// åœ¨NetworkSecurityConfig.xmlä¸­é…ç½®
<network-security-config>
    <domain-config>
        <domain includeSubdomains="true">api.yourdomain.com</domain>
        <pin-set>
            <pin digest="SHA-256">pinHashHere</pin>
        </pin-set>
    </domain-config>
</network-security-config>
```

#### éªŒè¯SSLè¯ä¹¦

```kotlin
// è‡ªå®šä¹‰TrustManageréªŒè¯æœåŠ¡å™¨è¯ä¹¦
val okHttpClient = OkHttpClient.Builder()
    .sslSocketFactory(TrustManager.getSSLSocketFactory(), TrustManager())
    .build()
```

## æ•°æ®å®‰å…¨ä¸åŠ å¯†

### Keystoreç³»ç»Ÿä½¿ç”¨

Android Keystoreç³»ç»Ÿæ˜¯å®‰å…¨å­˜å‚¨å¯†é’¥çš„æ¨èæ–¹å¼ï¼š

```kotlin
// ç”Ÿæˆå¯†é’¥å¯¹
fun generateKeyPair(): KeyPair {
    val keyGenerator = KeyPairGenerator.getInstance(
        KeyProperties.KEY_ALGORITHM_RSA, "AndroidKeyStore"
    )
    val keyPairSpec = KeyGenParameterSpec.Builder(
        "my_key_pair",
        KeyProperties.PURPOSE_ENCRYPT or KeyProperties.PURPOSE_DECRYPT
    )
        .setDigests(KeyProperties.DIGEST_SHA256)
        .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_RSA_OAEP)
        .build()
    
    keyGenerator.initialize(keyPairSpec)
    return keyGenerator.generateKeyPair()
}
```

### æ•°æ®åŠ å¯†

#### åŠ å¯†SharedPreferences

```kotlin
// ä½¿ç”¨EncryptedSharedPreferences
val masterKey = MasterKey.Builder(context)
    .setKeyScheme(MasterKey.KeyScheme.AES256_GCM)
    .build()

val encryptedPrefs = EncryptedSharedPreferences.create(
    context,
    "secret_shared_prefs",
    masterKey,
    EncryptedSharedPreferences.PrefKeyEncryptionScheme.AES256_SIV,
    EncryptedSharedPreferences.PrefValueEncryptionScheme.AES256_GCM
)
```

#### åŠ å¯†æ•°æ®åº“

```kotlin
// ä½¿ç”¨Room + SQLCipher
@Database(entities = [User::class], version = 1)
@TypeConverters(Converters::class)
abstract class AppDatabase : RoomDatabase() {
    abstract fun userDao(): UserDao()
}

// åœ¨Applicationç±»ä¸­é…ç½®
val db = Room.databaseBuilder(
    context.applicationContext,
    AppDatabase::class.java, "database-name"
)
    .openHelperFactory(SQLiteDatabase.create(null).apply {
        rawExecSQL("PRAGMA key = 'your-secret-key';")
    })
    .build()
```

## é«˜çº§å®‰å…¨ä¸»é¢˜

### ç”Ÿç‰©è¯†åˆ«è®¤è¯

```kotlin
// ä½¿ç”¨BiometricPrompt
private fun showBiometricPrompt() {
    val promptInfo = BiometricPrompt.PromptInfo.Builder()
        .setTitle("ç”Ÿç‰©è¯†åˆ«è®¤è¯")
        .setSubtitle("ä½¿ç”¨æŒ‡çº¹æˆ–é¢éƒ¨è¯†åˆ«è§£é”")
        .setNegativeButtonText("ä½¿ç”¨å¯†ç ")
        .build()

    val biometricPrompt = BiometricPrompt(
        this,
        ContextCompat.getMainExecutor(this),
        object : BiometricPrompt.AuthenticationCallback() {
            override fun onAuthenticationSucceeded(result: BiometricPrompt.AuthenticationResult) {
                // è®¤è¯æˆåŠŸ
            }
        }
    )

    biometricPrompt.authenticate(promptInfo)
}
```

### å®‰å…¨æ—¥å¿—è®°å½•

```kotlin
// åˆ›å»ºå®‰å…¨çš„æ—¥å¿—è®°å½•å™¨
object SecureLogger {
    private const val MAX_LOG_LENGTH = 4000
    private const val TAG = "SecureLogger"
    
    fun logDebug(message: String) {
        if (BuildConfig.DEBUG) {
            // åœ¨è°ƒè¯•æ¨¡å¼ä¸‹è®°å½•å®Œæ•´æ—¥å¿—
            Log.d(TAG, message)
        } else {
            // åœ¨å‘å¸ƒæ¨¡å¼ä¸‹è®°å½•æœ€å°åŒ–æ—¥å¿—
            Log.d(TAG, "Security event occurred")
        }
    }
    
    private fun chunkLog(message: String) {
        if (message.length <= MAX_LOG_LENGTH) {
            Log.d(TAG, message)
        } else {
            var i = 0
            while (i < message.length) {
                val chunk = message.substring(
                    i.coerceAtLeast(0),
                    (i + MAX_LOG_LENGTH).coerceAtMost(message.length)
                )
                Log.d(TAG, chunk)
                i += MAX_LOG_LENGTH
            }
        }
    }
}
```

## å®‰å…¨æµ‹è¯•

### é™æ€ä»£ç åˆ†æ

é›†æˆé™æ€ä»£ç åˆ†æå·¥å…·åˆ°æ„å»ºæµç¨‹ä¸­ï¼š

```gradle
// build.gradle
plugins {
    id 'com.github.ben-manes.versions' version '0.42.0'
    id 'com.github.triplet.play' version '3.7.0'
    id 'com.android.application'
    id 'org.jetbrains.kotlin.android'
    id 'com.diffplug.spotless' version '6.11.0'
}

spotless {
    kotlin {
        target('src/**/*.kt')
        licenseHeaderFile('spotless/copyright.kt')
        trimTrailingWhitespace()
        endWithNewline()
        // æ•´åˆKtlint
        ktlint("0.48.2")
            .setEditorConfigPath("$projectDir/ktlint-editor-config.properties")
    }
}
```

### åŠ¨æ€å®‰å…¨æµ‹è¯•

ä½¿ç”¨Fridaç­‰å·¥å…·è¿›è¡ŒåŠ¨æ€å®‰å…¨æµ‹è¯•ï¼š

```javascript
// Fridaè„šæœ¬ç¤ºä¾‹ - ç›‘æ§ç½‘ç»œè¯·æ±‚
Interceptor.attach("libssl.so!SSL_write", {
    onEnter: function(args) {
        this.data = new Uint8Array(args[1], args[2]);
    },
    onLeave: function(retval) {
        const data = String.fromCharCode.apply(null, this.data);
        console.log("SSL Write Data:", data);
    }
});
```

## ç»“è¯­

Androidå®‰å…¨æ˜¯ä¸€ä¸ªå¹¿é˜”è€Œå¤æ‚çš„é¢†åŸŸï¼Œæœ¬æ–‡åªæ˜¯è§¦åŠäº†å†°å±±ä¸€è§’ã€‚æ„å»ºå®‰å…¨çš„åº”ç”¨ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ä»»åŠ¡ï¼Œè€Œæ˜¯éœ€è¦åœ¨å¼€å‘å…¨ç”Ÿå‘½å‘¨æœŸä¸­æŒç»­å…³æ³¨å’Œå®è·µçš„è¿‡ç¨‹ã€‚

::: theorem
å®‰å…¨ä¸æ˜¯æ·»åŠ çš„åŠŸèƒ½ï¼Œè€Œæ˜¯è®¾è®¡çš„åŸåˆ™ã€‚ä»é¡¹ç›®åˆæœŸå°±å°†å®‰å…¨çº³å…¥è€ƒè™‘ï¼Œè¿œæ¯”äº‹åå¼¥è¡¥è¦æœ‰æ•ˆå¾—å¤šã€‚
:::

ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬æœ‰è´£ä»»ä¿æŠ¤ç”¨æˆ·çš„éšç§å’Œæ•°æ®å®‰å…¨ã€‚é€šè¿‡éµå¾ªæœ¬æ–‡ä»‹ç»çš„æœ€ä½³å®è·µï¼Œå¹¶æŒç»­å…³æ³¨æœ€æ–°çš„å®‰å…¨å¨èƒå’Œé˜²æŠ¤æªæ–½ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºæ›´åŠ å®‰å…¨å¯é çš„Androidåº”ç”¨ï¼Œèµ¢å¾—ç”¨æˆ·çš„ä¿¡ä»»å’Œå°Šé‡ã€‚

> "å®‰å…¨ä¸æ˜¯ç»ˆç‚¹ï¼Œè€Œæ˜¯ä¸€æ®µæ—…ç¨‹ã€‚ä¿æŒè­¦æƒ•ï¼ŒæŒç»­å­¦ä¹ ï¼Œæ‰èƒ½åœ¨è¿™æ®µæ—…ç¨‹ä¸­èµ°å¾—æ›´è¿œã€‚"

å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©å¤§å®¶åœ¨Androidå¼€å‘ä¸­æ›´åŠ æ³¨é‡å®‰å…¨ã€‚å¦‚æœä½ æœ‰ä»»ä½•å®‰å…¨é—®é¢˜æˆ–ç»éªŒåˆ†äº«ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµè®¨è®ºï¼ğŸ”’ğŸ’»