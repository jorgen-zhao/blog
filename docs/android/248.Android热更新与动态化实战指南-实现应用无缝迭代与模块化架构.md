---
title: Androidçƒ­æ›´æ–°ä¸åŠ¨æ€åŒ–å®æˆ˜æŒ‡å— - å®ç°åº”ç”¨æ— ç¼è¿­ä»£ä¸æ¨¡å—åŒ–æ¶æ„
date: 2026-02-04
tags:
  - Androidæ¶æ„
  - çƒ­æ›´æ–°
  - åŠ¨æ€åŒ–
---

## å‰è¨€

åœ¨Androidå¼€å‘çš„ä¸–ç•Œé‡Œï¼Œæˆ‘ä»¬å¸¸å¸¸é¢ä¸´è¿™æ ·çš„å›°å¢ƒï¼šåº”ç”¨åˆšå‘å¸ƒå°±å‘ç°äº†å…³é”®bugï¼Œæˆ–è€…éœ€è¦ç´§æ€¥ä¿®å¤å®‰å…¨é—®é¢˜ã€‚ä¼ ç»Ÿçš„åº”ç”¨æ›´æ–°æµç¨‹éœ€è¦é‡æ–°æ‰“åŒ…ã€å®¡æ ¸ã€å‘å¸ƒï¼Œç”¨æˆ·ä½“éªŒä¸­æ–­ï¼Œä¸šåŠ¡æŸå¤±éš¾ä»¥ä¼°é‡ã€‚ğŸ¤”

ä»Šå¤©ï¼Œæˆ‘å°†å¸¦å¤§å®¶æ·±å…¥æ¢ç´¢Androidçƒ­æ›´æ–°ä¸åŠ¨æ€åŒ–æŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯èƒ½å¤Ÿè®©æˆ‘ä»¬åœ¨ä¸é‡æ–°å‘å¸ƒåº”ç”¨çš„æƒ…å†µä¸‹ä¿®å¤bugã€æ›´æ–°åŠŸèƒ½ï¼Œç”šè‡³å®ç°æ¨¡å—çš„åŠ¨æ€åŠ è½½ã€‚è¿™ä¸ä»…æ˜¯æå‡ç”¨æˆ·ä½“éªŒçš„å…³é”®ï¼Œæ›´æ˜¯ç°ä»£Androidæ¶æ„è®¾è®¡çš„æ ¸å¿ƒèƒ½åŠ›ä¹‹ä¸€ã€‚ğŸš€

::: tip
"çƒ­æ›´æ–°ä¸åŠ¨æ€åŒ–æŠ€æœ¯æ˜¯ç°ä»£Androidåº”ç”¨æ¶æ„çš„'è¶…èƒ½åŠ›'ï¼Œå®ƒè®©æˆ‘ä»¬çš„åº”ç”¨æ‹¥æœ‰äº†'è‡ªæˆ‘ä¿®å¤'å’Œ'åŠ¨æ€è¿›åŒ–'çš„èƒ½åŠ›ã€‚"
:::

## çƒ­æ›´æ–°æŠ€æœ¯åŸç†

### çƒ­æ›´æ–°çš„æ ¸å¿ƒæœºåˆ¶

Androidçƒ­æ›´æ–°çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡åŠ¨æ€åŠ è½½æŠ€æœ¯æ›¿æ¢è¿è¡Œä¸­çš„ä»£ç æˆ–èµ„æºã€‚å½“åº”ç”¨æ£€æµ‹åˆ°éœ€è¦æ›´æ–°æ—¶ï¼Œä¼šä»æœåŠ¡å™¨ä¸‹è½½è¡¥ä¸åŒ…ï¼Œç„¶ååœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½è¿™äº›è¡¥ä¸ï¼Œå®ç°æ— ç¼æ›´æ–°ã€‚

```mermaid
graph LR
A[ç”¨æˆ·å‘ç°bug] --> B[å¼€å‘çƒ­æ›´æ–°è¡¥ä¸]
B --> C[æœåŠ¡å™¨å‘å¸ƒè¡¥ä¸]
C --> D[å®¢æˆ·ç«¯ä¸‹è½½è¡¥ä¸]
D --> E[åŠ¨æ€åŠ è½½è¡¥ä¸]
E --> F[é—®é¢˜ä¿®å¤å®Œæˆ]
```

### ä¸»æµçƒ­æ›´æ–°æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | åŸç† | ä¼˜åŠ¿ | åŠ£åŠ¿ |
|------|------|------|------|
| Tinker | Nativeå±‚æ›¿æ¢ | æˆç†Ÿç¨³å®šï¼Œå…¼å®¹æ€§å¥½ | è¡¥ä¸ä½“ç§¯è¾ƒå¤§ |
| Sophix | ç±»åŠ è½½æœºåˆ¶ | è¡¥ä¸ä½“ç§¯å°ï¼Œæ€§èƒ½å¥½ | éœ€è¦å®šåˆ¶Androidæ¡†æ¶ |
| Robust | Instant Runæœºåˆ¶ | æ”¯æŒæ–¹æ³•çº§æ›¿æ¢ | éœ€è¦ä¾µå…¥å¼ç¼–è¯‘ |
| AndFix | æ–¹æ³•æ›¿æ¢ | å®æ—¶ç”Ÿæ•ˆ | å…¼å®¹æ€§é—®é¢˜è¾ƒå¤š |

> ğŸ’¡ **é€‰æ‹©å»ºè®®**ï¼šå¯¹äºå¤§å¤šæ•°åº”ç”¨ï¼ŒTinkeræ˜¯è¾ƒä¸ºç¨³å¦¥çš„é€‰æ‹©ï¼›å¯¹äºè¿½æ±‚æè‡´æ€§èƒ½å’Œè¡¥ä¸ä½“ç§¯çš„åœºæ™¯ï¼Œå¯ä»¥è€ƒè™‘Sophixã€‚

## åŠ¨æ€åŒ–æ¶æ„å®æˆ˜

### æ¨¡å—åŒ–åŠ¨æ€åŠ è½½æ¶æ„

ç°ä»£Androidåº”ç”¨æ™®éé‡‡ç”¨æ¨¡å—åŒ–æ¶æ„ï¼Œä½†çœŸæ­£çš„åŠ¨æ€åŒ–æ¶æ„éœ€è¦å®ç°ä»¥ä¸‹ç‰¹ç‚¹ï¼š

1. **åŸºç¡€æ¨¡å—ä¸ä¸šåŠ¡æ¨¡å—åˆ†ç¦»**
2. **ä¸šåŠ¡æ¨¡å—å¯ç‹¬ç«‹å¼€å‘ã€æµ‹è¯•**
3. **è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ä¸šåŠ¡æ¨¡å—**

```kotlin
// åŠ¨æ€åŠ è½½ä¸šåŠ¡æ¨¡å—ç¤ºä¾‹
fun loadBusinessModule(moduleName: String) {
    val dexPath = "$filesDir/modules/$moduleName.jar"
    val optimizedDexPath = "$filesDir/odex"
    
    val classLoader = DexClassLoader(
        dexPath,
        optimizedDexPath,
        null,
        this.javaClass.classLoader
    )
    
    val businessClass = classLoader.loadClass("com.example.BusinessModule")
    val instance = businessClass.newInstance() as IBusinessModule
    instance.init(this)
}
```

### æ’ä»¶åŒ–å¼€å‘å®è·µ

æ’ä»¶åŒ–æ˜¯å®ç°åŠ¨æ€åŒ–çš„ç»ˆææ–¹æ¡ˆï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†åº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªå¯ç‹¬ç«‹è¿è¡Œçš„"æ’ä»¶"ï¼š

```kotlin
// æ’ä»¶æ¥å£å®šä¹‰
interface IPlugin {
    fun attach(context: Context)
    fun start()
    fun stop()
}

// æ’ä»¶ç®¡ç†å™¨
class PluginManager {
    private val loadedPlugins = mutableMapOf<String, IPlugin>()
    
    fun loadPlugin(pluginName: String, apkPath: String) {
        // åŠ è½½æ’ä»¶APKå¹¶åˆå§‹åŒ–
        val plugin = loadPluginFromApk(pluginName, apkPath)
        loadedPlugins[pluginName] = plugin
        plugin.attach(context)
    }
    
    fun startPlugin(pluginName: String) {
        loadedPlugins[pluginName]?.start()
    }
}
```

## å®æˆ˜æ¡ˆä¾‹ï¼šçƒ­æ›´æ–°ä¿®å¤å´©æºƒ

### åœºæ™¯æè¿°

æˆ‘ä»¬çš„åº”ç”¨åˆšå‘å¸ƒäº†ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œä½†ä¸Šçº¿åç«‹å³æ”¶åˆ°å¤§é‡å´©æºƒæŠ¥å‘Šï¼Œé—®é¢˜å‡ºåœ¨ä¸€ä¸ªæ–°åŠŸèƒ½ä¸Šã€‚æˆ‘ä»¬éœ€è¦ç«‹å³ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œä½†åº”ç”¨å•†åº—å®¡æ ¸æµç¨‹éœ€è¦7å¤©ã€‚

### è§£å†³æ–¹æ¡ˆ

1. **åˆ›å»ºçƒ­æ›´æ–°è¡¥ä¸**
   ```bash
   # ä½¿ç”¨Tinkerå‘½ä»¤ç”Ÿæˆè¡¥ä¸
   ./gradlew tinkerPatchDebugRelease
   ```

2. **è¡¥ä¸åŒ…ç»“æ„**
   ```
   app/build/outputs/tinkerPatch/
   â”œâ”€â”€ patch_signed.apk        # ç­¾ååçš„è¡¥ä¸åŒ…
   â”œâ”€â”€ patch_signed_7zip.apk   # 7zipå‹ç¼©æ ¼å¼
   â””â”€â”€ manifest/               # è¡¥ä¸æ¸…å•
   ```

3. **å®¢æˆ·ç«¯é›†æˆ**
   ```kotlin
   // Applicationä¸­åˆå§‹åŒ–Tinker
   class MyApp : Application() {
       override fun onCreate() {
           super.onCreate()
           TinkerInstaller.install(this)
       }
   }
   
   // æ£€æŸ¥å¹¶åº”ç”¨è¡¥ä¸
   TinkerPatch.with(this)
       .patchListener { patchResult ->
           when (patchResult) {
               is TinkerPatchResult.Success -> {
                   Toast.makeText(this, "è¡¥ä¸åº”ç”¨æˆåŠŸ", Toast.LENGTH_SHORT).show()
               }
               is TinkerPatchResult.Fail -> {
                   Toast.makeText(this, "è¡¥ä¸åº”ç”¨å¤±è´¥", Toast.LENGTH_SHORT).show()
               }
           }
       }
       .fetchPatchUpdate(true)  // ç«‹å³æ£€æŸ¥æ›´æ–°
   }
   ```

## å®‰å…¨ä¸å…¼å®¹æ€§è€ƒé‡

### çƒ­æ›´æ–°å®‰å…¨æœºåˆ¶

1. **ç­¾åéªŒè¯**ï¼šæ‰€æœ‰è¡¥ä¸å¿…é¡»ä½¿ç”¨ä¸APKç›¸åŒçš„ç­¾å
2. **ç‰ˆæœ¬æ§åˆ¶**ï¼šè¡¥ä¸å¿…é¡»ä¸å½“å‰åº”ç”¨ç‰ˆæœ¬åŒ¹é…
3. **é˜²ç¯¡æ”¹æœºåˆ¶**ï¼šè¡¥ä¸åŒ…å®Œæ•´æ€§æ ¡éªŒ

```kotlin
// è¡¥ä¸ç­¾åéªŒè¯ç¤ºä¾‹
fun verifyPatchSignature(patchFile: File): Boolean {
    val cert = getCertificateFromApk(patchFile)
    return cert.equals(originalAppCertificate)
}
```

### å…¼å®¹æ€§è§£å†³æ–¹æ¡ˆ

1. **å¤šæ¸ é“é€‚é…**ï¼šä¸ºä¸åŒå‚å•†å®šåˆ¶è¡¥ä¸åŠ è½½é€»è¾‘
2. **é™çº§æœºåˆ¶**ï¼šå½“çƒ­æ›´æ–°å¤±è´¥æ—¶è‡ªåŠ¨å›é€€
3. **ç‰ˆæœ¬æ£€æŸ¥**ï¼šé¿å…é”™è¯¯ç‰ˆæœ¬åº”ç”¨è¡¥ä¸

```kotlin
// é™çº§å¤„ç†ç¤ºä¾‹
class TinkerPatchService : IntentService("TinkerPatchService") {
    override fun onHandleIntent(intent: Intent?) {
        try {
            TinkerInstaller.onReceiveUpgradePatch(this, intent?.data)
        } catch (e: Exception) {
            // è®°å½•é”™è¯¯å¹¶å›é€€
            Tinker.with(application).cleanPatch()
            // é€šçŸ¥ç”¨æˆ·
            showUpdateFailedNotification()
        }
    }
}
```

## æœªæ¥å±•æœ›

éšç€Androidç³»ç»Ÿä¸æ–­æ¼”è¿›ï¼Œçƒ­æ›´æ–°ä¸åŠ¨æ€åŒ–æŠ€æœ¯ä¹Ÿåœ¨ä¸æ–­å‘å±•ï¼š

1. **Android Instant Apps**ï¼šæ— éœ€å®‰è£…å³å¯è¿è¡Œåº”ç”¨ï¼Œå¤©ç„¶æ”¯æŒåŠ¨æ€æ›´æ–°
2. **Jetpack Compose**ï¼šå£°æ˜å¼UIæ¡†æ¶ä¸ºåŠ¨æ€UIæ›´æ–°æä¾›æ–°å¯èƒ½
3. **Kotlin Multiplatform**ï¼šè·¨å¹³å°åŠ¨æ€åŒ–è§£å†³æ–¹æ¡ˆ

ğŸ¤·â€â™‚ï¸ ~~å…¶å®æœ€å¥½çš„çƒ­æ›´æ–°å°±æ˜¯ä¸çƒ­æ›´æ–°ï¼Œå†™å‡ºæ²¡æœ‰bugçš„ä»£ç ~~ â€”â€” ä½†ç°å®æ€»æ˜¯éª¨æ„Ÿçš„ï¼ŒæŒæ¡è¿™äº›æŠ€æœ¯èƒ½è®©æˆ‘ä»¬åœ¨å…³é”®æ—¶åˆ»åŠ›æŒ½ç‹‚æ¾œï¼

## ç»“è¯­

çƒ­æ›´æ–°ä¸åŠ¨æ€åŒ–æŠ€æœ¯æ˜¯ç°ä»£Androidå¼€å‘è€…çš„å¿…å¤‡æŠ€èƒ½ï¼Œå®ƒä¸ä»…èƒ½å¤Ÿæå‡åº”ç”¨çš„ç”¨æˆ·ä½“éªŒï¼Œè¿˜èƒ½æå¤§æé«˜å¼€å‘æ•ˆç‡ã€‚é€šè¿‡åˆç†åº”ç”¨è¿™äº›æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå‡ºæ›´åŠ çµæ´»ã€å¯ç»´æŠ¤çš„Androidåº”ç”¨æ¶æ„ã€‚

è®°ä½ï¼ŒæŠ€æœ¯åªæ˜¯å·¥å…·ï¼ŒçœŸæ­£çš„ä»·å€¼åœ¨äºå¦‚ä½•ç”¨è¿™äº›å·¥å…·è§£å†³å®é™…é—®é¢˜ã€‚å¸Œæœ›ä»Šå¤©çš„åˆ†äº«èƒ½ç»™å¤§å®¶å¸¦æ¥å¯å‘ï¼Œåœ¨æœªæ¥çš„é¡¹ç›®ä¸­å®ç°æ›´ä¼˜é›…çš„æ¶æ„è®¾è®¡ï¼

> "åœ¨å¿«é€Ÿè¿­ä»£çš„ç§»åŠ¨æ—¶ä»£ï¼ŒåŠ¨æ€åŒ–èƒ½åŠ›å°±æ˜¯åº”ç”¨çš„'å…ç–«ç³»ç»Ÿ'ï¼Œå®ƒè®©æˆ‘ä»¬çš„åº”ç”¨èƒ½å¤Ÿå¿«é€Ÿå“åº”å˜åŒ–ï¼ŒæŒç»­è¿›åŒ–ã€‚"