---
title: æ¡†æ¶çš„å¹¶å‘æ¨¡å‹ä¸å¼‚æ­¥å¤„ç†ï¼šæ„å»ºé«˜æ€§èƒ½åº”ç”¨çš„æ ¸å¿ƒå¼•æ“
date: 2026-02-04
tags: ["å¹¶å‘æ¨¡å‹", "å¼‚æ­¥å¤„ç†", "æ€§èƒ½ä¼˜åŒ–"]
---

## å‰è¨€

åœ¨æ„å»ºç°ä»£Webåº”ç”¨æ—¶ï¼Œæˆ‘ä»¬å¸¸å¸¸é‡åˆ°è¿™æ ·çš„å›°å¢ƒï¼šæ˜æ˜ä»£ç é€»è¾‘æ­£ç¡®ï¼Œåº”ç”¨å´åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹é¢‘ç¹å´©æºƒæˆ–å“åº”ç¼“æ…¢ã€‚ğŸ¤” è¿™èƒŒåå¾€å¾€éšè—ç€å¹¶å‘æ¨¡å‹ä¸å¼‚æ­¥å¤„ç†çš„çŸ­æ¿ã€‚ä»Šå¤©æˆ‘ä»¬å°±æ¥èŠèŠæ¡†æ¶ä¸­è¿™ä¸ªå®¹æ˜“è¢«å¿½è§†å´è‡³å…³é‡è¦çš„ä¸»é¢˜â€”â€”å¦‚ä½•é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„å¹¶å‘æ¨¡å‹å’Œå¼‚æ­¥å¤„ç†æœºåˆ¶ï¼Œè®©æˆ‘ä»¬çš„åº”ç”¨åœ¨æµé‡æ´ªå³°ä¸­ä¾ç„¶åšå¦‚ç£çŸ³ã€‚

> "ä¼˜ç§€çš„æ¡†æ¶ä¸ä»…è¦è®©å¼€å‘è€…å†™ä»£ç æ›´ç®€å•ï¼Œæ›´è¦è®©ä»£ç åœ¨å‹åŠ›ä¸‹è¡¨ç°æ›´ç¨³å®šã€‚" â€”â€” æ¥è‡ªä¸€çº¿æ¶æ„å¸ˆçš„è‚ºè…‘ä¹‹è¨€

## ç†è§£å¹¶å‘æ¨¡å‹çš„æœ¬è´¨

### åŒæ­¥æ¨¡å‹çš„å±€é™æ€§

ä¼ ç»Ÿçš„åŒæ­¥å¤„ç†æ¨¡å‹å°±åƒåªæœ‰ä¸€ä¸ªæ”¶é“¶å‘˜çš„è¶…å¸‚ç»“è´¦å£ï¼š

```javascript
// åŒæ­¥å¤„ç†ä¼ªä»£ç 
function handleRequest(request) {
  const result = database.query(request); // é˜»å¡æ“ä½œ
  return process(result); // å¤„ç†ç»“æœ
}
```

å½“å¤§é‡è¯·æ±‚åŒæ—¶æ¶Œå…¥æ—¶ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ä¼šæ’é˜Ÿç­‰å¾…æ•°æ®åº“æ“ä½œå®Œæˆï¼Œå¯¼è‡´çº¿ç¨‹æ± è¢«è¿…é€Ÿè€—å°½ã€‚ğŸ“‰

### å¼‚æ­¥æ¨¡å‹çš„é©å‘½æ€§çªç ´

å¼‚æ­¥æ¨¡å‹åˆ™å¼•å…¥äº†"éé˜»å¡I/O"çš„æ ¸å¿ƒç†å¿µï¼š

```javascript
// å¼‚æ­¥å¤„ç†ä¼ªä»£ç 
async function handleRequest(request) {
  const result = await database.query(request); // éé˜»å¡ç­‰å¾…
  return process(result); // å¤„ç†ç»“æœ
}
```

è¿™ç§æ¨¡å¼ä¸‹ï¼Œå½“ç­‰å¾…æ•°æ®åº“å“åº”æ—¶ï¼Œçº¿ç¨‹å¯ä»¥å¤„ç†å…¶ä»–è¯·æ±‚ï¼Œæå¤§æå‡äº†èµ„æºåˆ©ç”¨ç‡ã€‚ğŸ“ˆ

## æ¡†æ¶ä¸­çš„å¹¶å‘å¤„ç†æ–¹æ¡ˆ

### äº‹ä»¶å¾ªç¯æœºåˆ¶

ç°ä»£æ¡†æ¶æ™®éé‡‡ç”¨äº‹ä»¶å¾ªç¯æ¨¡å‹ï¼Œä»¥Node.jsä¸ºä¾‹ï¼š

```javascript
// äº‹ä»¶å¾ªç¯ç®€åŒ–æ¨¡å‹
while (eventLoop.waitForTask()) {
  const task = eventLoop.nextTask();
  task.execute();
}
```

**å…³é”®ç‚¹**ï¼š
- å•çº¿ç¨‹+äº‹ä»¶é˜Ÿåˆ—
- éé˜»å¡I/Oæ“ä½œ
- ä»»åŠ¡è°ƒåº¦ä¼˜å…ˆçº§æ§åˆ¶

### åç¨‹ä¸çº¤ç¨‹

æ›´é«˜çº§çš„æ¡†æ¶å¼•å…¥äº†åç¨‹ï¼ˆCoroutineï¼‰æ¦‚å¿µï¼š

```python
# Pythonåç¨‹ç¤ºä¾‹
async def handle_request(request):
    data = await db.fetch(request)  # æš‚åœæ‰§è¡Œï¼Œé‡Šæ”¾æ§åˆ¶æƒ
    return process(data)
```

**ä¼˜åŠ¿**ï¼š
- ç¼–ç¨‹æ¨¡å‹æ¥è¿‘åŒæ­¥ä»£ç 
- è‡ªåŠ¨åŒ–çš„ä¸Šä¸‹æ–‡åˆ‡æ¢
- æ›´ç»†ç²’åº¦çš„ä»»åŠ¡æ§åˆ¶

### çº¿ç¨‹æ± ä¸å·¥ä½œçº¿ç¨‹

å¯¹äºCPUå¯†é›†å‹ä»»åŠ¡ï¼Œæ¡†æ¶é€šå¸¸é‡‡ç”¨çº¿ç¨‹æ± ç­–ç•¥ï¼š

```java
// Javaçº¿ç¨‹æ± ç¤ºä¾‹
ExecutorService executor = Executors.newFixedThreadPool(10);
Future<Result> future = executor.submit(() -> process(request));
```

**é€‚ç”¨åœºæ™¯**ï¼š
- å¤æ‚è®¡ç®—ä»»åŠ¡
- CPUå¯†é›†å‹æ“ä½œ
- éœ€è¦å……åˆ†åˆ©ç”¨å¤šæ ¸CPU

## å¼‚æ­¥ç¼–ç¨‹çš„æœ€ä½³å®è·µ

### 1. é¿å…å›è°ƒåœ°ç‹±

ä½¿ç”¨ç°ä»£å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼é‡æ„å›è°ƒä»£ç ï¼š

```javascript
// âŒ å›è°ƒåœ°ç‹±
fetchData((err, data) => {
  processData(data, (err, result) => {
    saveResult(result, (err) => {
      console.log('å®Œæˆ');
    });
  });
});

// ï¿½ Promiseé“¾å¼è°ƒç”¨
fetchData()
  .then(processData)
  .then(saveResult)
  .catch(err => console.error('é”™è¯¯'));
```

### 2. åˆç†ä½¿ç”¨å¼‚æ­¥ä¸Šä¸‹æ–‡

ç¡®ä¿å¼‚æ­¥æ“ä½œä¸­æ­£ç¡®ä¼ é€’ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼š

```javascript
// ä½¿ç”¨async_hooksæˆ–ç±»ä¼¼æœºåˆ¶
const context = { userId: 123, traceId: 'abc123' };

async function withContext(fn) {
  return async (...args) => {
    // ä¿å­˜å½“å‰ä¸Šä¸‹æ–‡
    const savedContext = getCurrentContext();
    setCurrentContext(context);
    try {
      return await fn(...args);
    } finally {
      // æ¢å¤ä¸Šä¸‹æ–‡
      setCurrentContext(savedContext);
    }
  };
}
```

### 3. èµ„æºæ± ç®¡ç†

å®ç°é«˜æ•ˆçš„èµ„æºå¤ç”¨æœºåˆ¶ï¼š

```javascript
// æ•°æ®åº“è¿æ¥æ± ç¤ºä¾‹
const pool = new Pool({
  max: 10,        // æœ€å¤§è¿æ¥æ•°
  min: 2,         // æœ€å°è¿æ¥æ•°
  idleTimeoutMillis: 30000,  // ç©ºé—²è¶…æ—¶
});

// è·å–è¿æ¥
const connection = await pool.getConnection();
try {
  await connection.query('SELECT * FROM users');
} finally {
  // é‡Šæ”¾è¿æ¥
  connection.release();
}
```

## å®æˆ˜æ¡ˆä¾‹ï¼šé«˜å¹¶å‘APIæœåŠ¡

### é—®é¢˜åœºæ™¯

æŸç”µå•†ç³»ç»Ÿåœ¨å¤§ä¿ƒæœŸé—´é‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼š
1. æ•°æ®åº“è¿æ¥è€—å°½
2. å“åº”æ—¶é—´ä»50msé£™å‡è‡³5s
3. å¤§é‡è¯·æ±‚è¶…æ—¶å¤±è´¥

### è§£å†³æ–¹æ¡ˆ

1. **å¼•å…¥å¼‚æ­¥ä¸­é—´ä»¶**ï¼š
```javascript
// Expresså¼‚æ­¥ä¸­é—´ä»¶
app.use(async (req, res, next) => {
  try {
    req.context = await createContext(req);
    next();
  } catch (err) {
    next(err);
  }
});
```

2. **å®ç°è¯·æ±‚é™æµ**ï¼š
```javascript
// ä½¿ç”¨ä»¤ç‰Œæ¡¶ç®—æ³•
const rateLimiter = new RateLimiter({
  tokens: 1000,     // æ¯ç§’è¯·æ±‚æ•°
  interval: 1000,   // æ—¶é—´çª—å£
});

app.use(async (req, res, next) => {
  if (!rateLimiter.tryRemoveTokens(1)) {
    return res.status(429).json({ error: 'Too Many Requests' });
  }
  next();
});
```

3. **ä¼˜åŒ–æ•°æ®åº“è®¿é—®**ï¼š
```javascript
// æ‰¹é‡æŸ¥è¯¢ä¼˜åŒ–
async function batchGetUsers(userIds) {
  const batchSize = 100;
  const results = [];
  
  for (let i = 0; i < userIds.length; i += batchSize) {
    const batch = userIds.slice(i, i + batchSize);
    const batchResults = await db.query(
      `SELECT * FROM users WHERE id IN (${batch.map(() => '?').join(',')})`,
      batch
    );
    results.push(...batchResults);
  }
  
  return results;
}
```

### æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡å¹…åº¦ |
|------|--------|--------|----------|
| QPS   | 1,200  | 8,500  | 608%     |
| å“åº”æ—¶é—´ | 4,800ms | 45ms   | 99%      |
| é”™è¯¯ç‡   | 35%    | 0.2%   | 99.4%    |

## ç»“è¯­

æ¡†æ¶çš„å¹¶å‘æ¨¡å‹ä¸å¼‚æ­¥å¤„ç†èƒ½åŠ›ï¼Œæ˜¯å†³å®šåº”ç”¨æ€§èƒ½ä¸Šé™çš„å…³é”®å› ç´ ã€‚é€šè¿‡åˆç†é€‰æ‹©å¼‚æ­¥æ¨¡å‹ã€é¿å…é˜»å¡æ“ä½œã€ä¼˜åŒ–èµ„æºç®¡ç†ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ„å»ºå‡ºåœ¨æµé‡æ´ªå³°ä¸­ä¾ç„¶åšå¦‚ç£çŸ³çš„åº”ç”¨ã€‚

è®°ä½ï¼š**ä¼˜ç§€çš„å¼‚æ­¥è®¾è®¡ä¸æ˜¯è®©ä»£ç å˜å¾—æ›´å¤æ‚ï¼Œè€Œæ˜¯è®©å¤æ‚çš„é—®é¢˜å˜å¾—ç®€å•**ã€‚åœ¨æœªæ¥çš„æ¡†æ¶å‘å±•ä¸­ï¼Œéšç€WebAssemblyã€è¾¹ç¼˜è®¡ç®—ç­‰æ–°æŠ€æœ¯çš„å…´èµ·ï¼Œå¹¶å‘æ¨¡å‹çš„è®¾è®¡è¿˜å°†è¿æ¥æ›´å¤šåˆ›æ–°ã€‚æŒç»­å…³æ³¨è¿™äº›æ¼”è¿›ï¼Œå°†å¸®åŠ©æˆ‘ä»¬æ‰“é€ æ›´å¼ºå¤§çš„åº”ç”¨ç”Ÿæ€ç³»ç»Ÿã€‚

> "åœ¨å¼‚æ­¥çš„ä¸–ç•Œé‡Œï¼Œæ—¶é—´ä¸æ˜¯çº¿æ€§çš„ï¼Œè€Œæ˜¯ç”±äº‹ä»¶ç¼–ç»‡çš„ç½‘ã€‚" â€”â€” å¹¶å‘ç¼–ç¨‹å“²å­¦