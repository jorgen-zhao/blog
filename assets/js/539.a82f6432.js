(window.webpackJsonp=window.webpackJsonp||[]).push([[539],{891:function(s,t,a){"use strict";a.r(t);var n=a(15),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"å‰è¨€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[s._v("#")]),s._v(" å‰è¨€")]),s._v(" "),t("p",[s._v("åœ¨æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿæ—¶ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ä½œä¸ºå¼‚æ­¥é€šä¿¡çš„æ ¸å¿ƒç»„ä»¶ï¼Œå·²ç»æˆä¸ºç°ä»£æ¶æ„ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚ğŸ“¡ ç„¶è€Œï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°å„ç§å¼‚å¸¸æƒ…å†µï¼šæ¶ˆè´¹è€…æš‚æ—¶ä¸å¯ç”¨ã€æ¶ˆæ¯å¤„ç†å¤±è´¥ã€ç³»ç»Ÿè´Ÿè½½è¿‡é«˜ç­‰ç­‰ã€‚è¿™äº›æƒ…å†µå¦‚æœä¸å¦¥å–„å¤„ç†ï¼Œå¯èƒ½å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ã€ç³»ç»Ÿé˜»å¡ç”šè‡³æ•°æ®ä¸ä¸€è‡´ã€‚")]),s._v(" "),t("p",[s._v("ä»Šå¤©ï¼Œæˆ‘æƒ³å’Œå¤§å®¶æ·±å…¥æ¢è®¨ä¸¤ä¸ªéå¸¸é‡è¦çš„æ¶ˆæ¯é˜Ÿåˆ—æœºåˆ¶ï¼š"),t("strong",[s._v("å»¶è¿Ÿé˜Ÿåˆ—")]),s._v("å’Œ"),t("strong",[s._v("æ­»ä¿¡é˜Ÿåˆ—")]),s._v('ã€‚è¿™ä¸¤ä¸ªæœºåˆ¶å°±åƒæ˜¯æ¶ˆæ¯ç³»ç»Ÿçš„"å®‰å…¨ç½‘"å’Œ"æ€¥æ•‘ç«™"ï¼Œèƒ½å¤Ÿåœ¨ç³»ç»Ÿé‡åˆ°é—®é¢˜æ—¶æä¾›ä¿éšœï¼Œç¡®ä¿æ¶ˆæ¯çš„å¯é ä¼ é€’å’Œå¤„ç†ã€‚')]),s._v(" "),t("h2",{attrs:{id:"å»¶è¿Ÿé˜Ÿåˆ—-æ—¶é—´çš„è‰ºæœ¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å»¶è¿Ÿé˜Ÿåˆ—-æ—¶é—´çš„è‰ºæœ¯"}},[s._v("#")]),s._v(" å»¶è¿Ÿé˜Ÿåˆ—ï¼šæ—¶é—´çš„è‰ºæœ¯")]),s._v(" "),t("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯å»¶è¿Ÿé˜Ÿåˆ—"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯å»¶è¿Ÿé˜Ÿåˆ—"}},[s._v("#")]),s._v(" ä»€ä¹ˆæ˜¯å»¶è¿Ÿé˜Ÿåˆ—ï¼Ÿ")]),s._v(" "),t("p",[s._v("å»¶è¿Ÿé˜Ÿåˆ—ï¼ˆDelay Queueï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„é˜Ÿåˆ—ï¼Œå…¶ä¸­çš„æ¶ˆæ¯ä¸ä¼šç«‹å³è¢«æ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œè€Œæ˜¯éœ€è¦ç­‰å¾…ä¸€æ®µæŒ‡å®šçš„æ—¶é—´åæ‰èƒ½è¢«å¤„ç†ã€‚è¿™ç§æœºåˆ¶åœ¨å¾ˆå¤šåœºæ™¯ä¸‹éƒ½éå¸¸æœ‰ç”¨ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("è®¢å•è¶…æ—¶è‡ªåŠ¨å–æ¶ˆ")]),s._v(" "),t("li",[s._v("çŸ­ä¿¡éªŒè¯ç çš„å®šæ—¶å‘é€")]),s._v(" "),t("li",[s._v("å®šæ—¶ä»»åŠ¡è°ƒåº¦")]),s._v(" "),t("li",[s._v("æ¶ˆæ¯é‡è¯•æœºåˆ¶")])]),s._v(" "),t("h3",{attrs:{id:"å»¶è¿Ÿé˜Ÿåˆ—çš„å®ç°æ–¹å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å»¶è¿Ÿé˜Ÿåˆ—çš„å®ç°æ–¹å¼"}},[s._v("#")]),s._v(" å»¶è¿Ÿé˜Ÿåˆ—çš„å®ç°æ–¹å¼")]),s._v(" "),t("p",[s._v("ä¸åŒçš„æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿæä¾›äº†ä¸åŒçš„å»¶è¿Ÿé˜Ÿåˆ—å®ç°æ–¹å¼ï¼š")]),s._v(" "),t("h4",{attrs:{id:"_1-rabbitmqçš„ttlå’Œdlx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-rabbitmqçš„ttlå’Œdlx"}},[s._v("#")]),s._v(" 1. RabbitMQçš„TTLå’ŒDLX")]),s._v(" "),t("p",[s._v("RabbitMQé€šè¿‡ä¸¤ç§æœºåˆ¶å®ç°å»¶è¿Ÿé˜Ÿåˆ—ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("æ¶ˆæ¯TTLï¼ˆTime To Liveï¼‰ï¼šè®¾ç½®æ¶ˆæ¯çš„å­˜æ´»æ—¶é—´")]),s._v(" "),t("li",[s._v("æ­»ä¿¡äº¤æ¢å™¨ï¼ˆDLXï¼ŒDead Letter Exchangeï¼‰ï¼šå°†è¿‡æœŸçš„æ¶ˆæ¯è·¯ç”±åˆ°ç‰¹å®šçš„äº¤æ¢å™¨")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®¾ç½®æ¶ˆæ¯TTL")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" args "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashMap")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nargs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-message-ttl"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 60ç§’")]),s._v("\nargs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-dead-letter-exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlx.exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å£°æ˜é˜Ÿåˆ—æ—¶æŒ‡å®šå‚æ•°")]),s._v("\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queueDeclare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"delay.queue"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h4",{attrs:{id:"_2-rabbitmqçš„å»¶è¿Ÿæ¶ˆæ¯æ’ä»¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-rabbitmqçš„å»¶è¿Ÿæ¶ˆæ¯æ’ä»¶"}},[s._v("#")]),s._v(" 2. RabbitMQçš„å»¶è¿Ÿæ¶ˆæ¯æ’ä»¶")]),s._v(" "),t("p",[s._v("RabbitMQæœ‰ä¸€ä¸ªå®˜æ–¹çš„å»¶è¿Ÿæ¶ˆæ¯æ’ä»¶ï¼ˆrabbitmq-delayed-message-exchangeï¼‰ï¼Œå®ƒæä¾›äº†æ›´çµæ´»çš„å»¶è¿Ÿæ¶ˆæ¯åŠŸèƒ½ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å£°æ˜å»¶è¿Ÿäº¤æ¢å™¨")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" args "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashMap")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nargs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-delayed-type"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"direct"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exchangeDeclare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"delayed.exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-delayed-message"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‘å¸ƒå»¶è¿Ÿæ¶ˆæ¯")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AMQP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BasicProperties")]),s._v(" properties "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AMQP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BasicProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Builder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("headers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashMap")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-delay"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å»¶è¿Ÿ5ç§’")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("basicPublish")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"delayed.exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"delayed.key"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" properties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getBytes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h4",{attrs:{id:"_3-rocketmqçš„å»¶è¿Ÿæ¶ˆæ¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-rocketmqçš„å»¶è¿Ÿæ¶ˆæ¯"}},[s._v("#")]),s._v(" 3. RocketMQçš„å»¶è¿Ÿæ¶ˆæ¯")]),s._v(" "),t("p",[s._v("RocketMQåŸç”Ÿæ”¯æŒå»¶è¿Ÿæ¶ˆæ¯ï¼Œé€šè¿‡è®¾ç½®æ¶ˆæ¯çš„å»¶è¿Ÿç­‰çº§æ¥å®ç°ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®¾ç½®å»¶è¿Ÿç­‰çº§ï¼ˆ1~18åˆ†åˆ«å¯¹åº”1s~18ä¸ªå»¶è¿Ÿçº§åˆ«ï¼‰")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setDelayLevel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å»¶è¿Ÿ10ç§’")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("RocketMQçš„å»¶è¿Ÿç­‰çº§å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("å»¶è¿Ÿç­‰çº§")]),s._v(" "),t("th",[s._v("å»¶è¿Ÿæ—¶é—´")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("1")]),s._v(" "),t("td",[s._v("1ç§’å")])]),s._v(" "),t("tr",[t("td",[s._v("2")]),s._v(" "),t("td",[s._v("5ç§’å")])]),s._v(" "),t("tr",[t("td",[s._v("3")]),s._v(" "),t("td",[s._v("10ç§’å")])]),s._v(" "),t("tr",[t("td",[s._v("4")]),s._v(" "),t("td",[s._v("30ç§’å")])]),s._v(" "),t("tr",[t("td",[s._v("5")]),s._v(" "),t("td",[s._v("1åˆ†é’Ÿå")])]),s._v(" "),t("tr",[t("td",[s._v("6")]),s._v(" "),t("td",[s._v("2åˆ†é’Ÿå")])]),s._v(" "),t("tr",[t("td",[s._v("7")]),s._v(" "),t("td",[s._v("3åˆ†é’Ÿå")])]),s._v(" "),t("tr",[t("td",[s._v("8")]),s._v(" "),t("td",[s._v("4åˆ†é’Ÿå")])]),s._v(" "),t("tr",[t("td",[s._v("9")]),s._v(" "),t("td",[s._v("5åˆ†é’Ÿå")])]),s._v(" "),t("tr",[t("td",[s._v("10")]),s._v(" "),t("td",[s._v("6åˆ†é’Ÿå")])]),s._v(" "),t("tr",[t("td",[s._v("11")]),s._v(" "),t("td",[s._v("7åˆ†é’Ÿå")])]),s._v(" "),t("tr",[t("td",[s._v("12")]),s._v(" "),t("td",[s._v("8åˆ†é’Ÿå")])]),s._v(" "),t("tr",[t("td",[s._v("13")]),s._v(" "),t("td",[s._v("9åˆ†é’Ÿå")])]),s._v(" "),t("tr",[t("td",[s._v("14")]),s._v(" "),t("td",[s._v("10åˆ†é’Ÿå")])]),s._v(" "),t("tr",[t("td",[s._v("15")]),s._v(" "),t("td",[s._v("20åˆ†é’Ÿå")])]),s._v(" "),t("tr",[t("td",[s._v("16")]),s._v(" "),t("td",[s._v("30åˆ†é’Ÿå")])]),s._v(" "),t("tr",[t("td",[s._v("17")]),s._v(" "),t("td",[s._v("1å°æ—¶å")])]),s._v(" "),t("tr",[t("td",[s._v("18")]),s._v(" "),t("td",[s._v("2å°æ—¶å")])])])]),s._v(" "),t("h4",{attrs:{id:"_4-kafkaçš„å»¶è¿Ÿé˜Ÿåˆ—å®ç°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-kafkaçš„å»¶è¿Ÿé˜Ÿåˆ—å®ç°"}},[s._v("#")]),s._v(" 4. Kafkaçš„å»¶è¿Ÿé˜Ÿåˆ—å®ç°")]),s._v(" "),t("p",[s._v("Kafkaæœ¬èº«ä¸ç›´æ¥æ”¯æŒå»¶è¿Ÿé˜Ÿåˆ—ï¼Œä½†å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("ä½¿ç”¨å®šæ—¶ä»»åŠ¡å’Œä¸¤ä¸ªä¸»é¢˜ï¼ˆåŸå§‹ä¸»é¢˜å’Œå»¶è¿Ÿä¸»é¢˜ï¼‰")]),s._v(" "),t("li",[s._v("ä½¿ç”¨Kafka Streamsçš„KTableè¿›è¡ŒçŠ¶æ€ç®¡ç†å’Œå»¶è¿Ÿå¤„ç†")]),s._v(" "),t("li",[s._v("ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“å¦‚Kafka Delay Queue")])]),s._v(" "),t("h3",{attrs:{id:"å»¶è¿Ÿé˜Ÿåˆ—çš„åº”ç”¨åœºæ™¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å»¶è¿Ÿé˜Ÿåˆ—çš„åº”ç”¨åœºæ™¯"}},[s._v("#")]),s._v(" å»¶è¿Ÿé˜Ÿåˆ—çš„åº”ç”¨åœºæ™¯")]),s._v(" "),t("p",[s._v("å»¶è¿Ÿé˜Ÿåˆ—åœ¨ä»¥ä¸‹åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ï¼š")]),s._v(" "),t("h4",{attrs:{id:"_1-è®¢å•è¶…æ—¶å–æ¶ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-è®¢å•è¶…æ—¶å–æ¶ˆ"}},[s._v("#")]),s._v(" 1. è®¢å•è¶…æ—¶å–æ¶ˆ")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®¢å•åˆ›å»ºæ—¶ï¼Œå‘é€å»¶è¿Ÿæ¶ˆæ¯")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("createOrder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¿å­˜è®¢å•åˆ°æ•°æ®åº“")]),s._v("\n    orderRepository"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("save")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‘é€30åˆ†é’Ÿåæ£€æŸ¥è®¢å•çŠ¶æ€çš„å»¶è¿Ÿæ¶ˆæ¯")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Message")]),s._v(" message "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MessageBuilder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("withPayload")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setHeader")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"delay"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 30åˆ†é’Ÿ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    rocketMQTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("syncSend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order.delay.check"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å»¶è¿Ÿæ¶ˆæ¯æ¶ˆè´¹è€…")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RocketMQMessageListener")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("topic "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order.delay.check"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" consumerGroup "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order.delay.check.group"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderDelayCheckConsumer")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RocketMQListener")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("onMessage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" orderId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" order "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" orderRepository"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("findById")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("orderId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getStatus")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderStatus")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PENDING_PAYMENT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å–æ¶ˆæœªæ”¯ä»˜çš„è®¢å•")]),s._v("\n            order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setStatus")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderStatus")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CANCELLED")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            orderRepository"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("save")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("h4",{attrs:{id:"_2-çŸ­ä¿¡éªŒè¯ç å®šæ—¶å‘é€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-çŸ­ä¿¡éªŒè¯ç å®šæ—¶å‘é€"}},[s._v("#")]),s._v(" 2. çŸ­ä¿¡éªŒè¯ç å®šæ—¶å‘é€")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‘é€éªŒè¯ç æ—¶ï¼Œè®¾ç½®5åˆ†é’Ÿåè¿‡æœŸ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sendVerificationCode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" phoneNumber"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" code "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("generateVerificationCode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¿å­˜éªŒè¯ç åˆ°ç¼“å­˜ï¼Œè®¾ç½®5åˆ†é’Ÿè¿‡æœŸ")]),s._v("\n    redisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"verification.code:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" phoneNumber"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" code"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TimeUnit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MINUTES")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç«‹å³å‘é€éªŒè¯ç çŸ­ä¿¡")]),s._v("\n    smsService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("phoneNumber"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"æ‚¨çš„éªŒè¯ç æ˜¯ï¼š"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" code"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®¾ç½®5åˆ†é’Ÿåå¤±æ•ˆçš„å»¶è¿Ÿæ¶ˆæ¯")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Message")]),s._v(" message "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MessageBuilder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("withPayload")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("phoneNumber"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setHeader")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"delay"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 5åˆ†é’Ÿ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    rocketMQTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("syncSend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"verification.code.expire"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// éªŒè¯ç è¿‡æœŸå¤„ç†")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RocketMQMessageListener")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("topic "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"verification.code.expire"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" consumerGroup "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"verification.code.expire.group"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("VerificationCodeExpireConsumer")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RocketMQListener")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("onMessage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" phoneNumber"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä»ç¼“å­˜ä¸­åˆ é™¤å·²è¿‡æœŸçš„éªŒè¯ç ")]),s._v("\n        redisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("delete")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"verification.code:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" phoneNumber"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h2",{attrs:{id:"æ­»ä¿¡é˜Ÿåˆ—-å¤±è´¥çš„å½’å®¿"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ­»ä¿¡é˜Ÿåˆ—-å¤±è´¥çš„å½’å®¿"}},[s._v("#")]),s._v(" æ­»ä¿¡é˜Ÿåˆ—ï¼šå¤±è´¥çš„å½’å®¿")]),s._v(" "),t("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—"}},[s._v("#")]),s._v(" ä»€ä¹ˆæ˜¯æ­»ä¿¡é˜Ÿåˆ—ï¼Ÿ")]),s._v(" "),t("p",[s._v('æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead Letter Queueï¼ŒDLQï¼‰æ˜¯ä¸€ç§ç”¨äºå­˜å‚¨æ— æ³•è¢«æ­£å¸¸å¤„ç†çš„æ¶ˆæ¯çš„é˜Ÿåˆ—ã€‚å½“æ¶ˆæ¯åœ¨é˜Ÿåˆ—ä¸­æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€æ—¶ï¼Œä¼šè¢«è®¤ä¸ºæ˜¯"æ­»ä¿¡"å¹¶è·¯ç”±åˆ°æ­»ä¿¡é˜Ÿåˆ—ï¼š')]),s._v(" "),t("ol",[t("li",[s._v("æ¶ˆæ¯è¢«æ¶ˆè´¹è€…å¤šæ¬¡æ¶ˆè´¹åä»ç„¶å¤±è´¥")]),s._v(" "),t("li",[s._v("æ¶ˆæ¯åœ¨é˜Ÿåˆ—ä¸­è¿‡æœŸï¼ˆTTLåˆ°æœŸï¼‰")]),s._v(" "),t("li",[s._v("é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦ï¼Œæ— æ³•å†å­˜å‚¨æ–°æ¶ˆæ¯")])]),s._v(" "),t("h3",{attrs:{id:"æ­»ä¿¡é˜Ÿåˆ—çš„å·¥ä½œåŸç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ­»ä¿¡é˜Ÿåˆ—çš„å·¥ä½œåŸç†"}},[s._v("#")]),s._v(" æ­»ä¿¡é˜Ÿåˆ—çš„å·¥ä½œåŸç†")]),s._v(" "),t("p",[s._v("æ­»ä¿¡é˜Ÿåˆ—çš„å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š")]),s._v(" "),t("ol",[t("li",[s._v("æ¶ˆæ¯è¢«å‘é€åˆ°åŸå§‹é˜Ÿåˆ—")]),s._v(" "),t("li",[s._v("æ¶ˆæ¯å¤„ç†å¤±è´¥æˆ–æ»¡è¶³å…¶ä»–æ­»ä¿¡æ¡ä»¶")]),s._v(" "),t("li",[s._v("æ¶ˆæ¯è¢«è·¯ç”±åˆ°æ­»ä¿¡äº¤æ¢å™¨")]),s._v(" "),t("li",[s._v("æ¶ˆæ¯è¢«å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—")]),s._v(" "),t("li",[s._v("è¿ç»´äººå‘˜æˆ–ç‰¹æ®Šæ¶ˆè´¹è€…å¤„ç†æ­»ä¿¡é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯")])]),s._v(" "),t("h3",{attrs:{id:"æ­»ä¿¡é˜Ÿåˆ—çš„å®ç°æ–¹å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ­»ä¿¡é˜Ÿåˆ—çš„å®ç°æ–¹å¼"}},[s._v("#")]),s._v(" æ­»ä¿¡é˜Ÿåˆ—çš„å®ç°æ–¹å¼")]),s._v(" "),t("h4",{attrs:{id:"_1-rabbitmqçš„æ­»ä¿¡é˜Ÿåˆ—"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-rabbitmqçš„æ­»ä¿¡é˜Ÿåˆ—"}},[s._v("#")]),s._v(" 1. RabbitMQçš„æ­»ä¿¡é˜Ÿåˆ—")]),s._v(" "),t("p",[s._v("åœ¨RabbitMQä¸­ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼é…ç½®æ­»ä¿¡é˜Ÿåˆ—ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å£°æ˜æ­»ä¿¡äº¤æ¢å™¨å’Œé˜Ÿåˆ—")]),s._v("\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exchangeDeclare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlx.exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"direct"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queueDeclare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlq.queue"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queueBind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlq.queue"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlx.exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlq.key"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å£°æ˜åŸå§‹é˜Ÿåˆ—å¹¶è®¾ç½®æ­»ä¿¡äº¤æ¢å™¨")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" args "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashMap")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nargs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-dead-letter-exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlx.exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nargs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-dead-letter-routing-key"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlq.key"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nargs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-message-ttl"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¶ˆæ¯TTLä¸º60ç§’")]),s._v("\nargs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-max-length"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é˜Ÿåˆ—æœ€å¤§é•¿åº¦ä¸º10")]),s._v("\n\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queueDeclare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"original.queue"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h4",{attrs:{id:"_2-rocketmqçš„æ­»ä¿¡é˜Ÿåˆ—"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-rocketmqçš„æ­»ä¿¡é˜Ÿåˆ—"}},[s._v("#")]),s._v(" 2. RocketMQçš„æ­»ä¿¡é˜Ÿåˆ—")]),s._v(" "),t("p",[s._v("RocketMQé€šè¿‡è®¾ç½®æ¶ˆæ¯çš„é‡è¯•æ¬¡æ•°æ¥å®ç°æ­»ä¿¡é˜Ÿåˆ—åŠŸèƒ½ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‘é€æ¶ˆæ¯æ—¶è®¾ç½®é‡è¯•æ¬¡æ•°")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Message")]),s._v(" message "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Message")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order.topic"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order.tag"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"orderKey"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order content"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getBytes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®¾ç½®é‡è¯•æ¬¡æ•°ä¸º3æ¬¡")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setRetryTimesWhenSendFailed")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‘é€æ¶ˆæ¯")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SendResult")]),s._v(" sendResult "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" rocketMQTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getProducer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("å½“æ¶ˆæ¯é‡è¯•æ¬¡æ•°è¶…è¿‡é…ç½®çš„é˜ˆå€¼åï¼Œæ¶ˆæ¯ä¼šè¢«å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—ã€‚æ­»ä¿¡é˜Ÿåˆ—çš„å‘½åè§„åˆ™ä¸ºï¼š"),t("code",[s._v("%DLQ%+æ¶ˆè´¹è€…ç»„å")]),s._v("ã€‚")]),s._v(" "),t("h4",{attrs:{id:"_3-kafkaçš„æ­»ä¿¡ä¸»é¢˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-kafkaçš„æ­»ä¿¡ä¸»é¢˜"}},[s._v("#")]),s._v(" 3. Kafkaçš„æ­»ä¿¡ä¸»é¢˜")]),s._v(" "),t("p",[s._v("Kafkaæ²¡æœ‰åŸç”Ÿçš„æ­»ä¿¡é˜Ÿåˆ—æœºåˆ¶ï¼Œä½†å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("åˆ›å»ºä¸€ä¸ªä¸“é—¨çš„æ­»ä¿¡ä¸»é¢˜")]),s._v(" "),t("li",[s._v("åœ¨æ¶ˆè´¹è€…æ•è·å¼‚å¸¸æ—¶ï¼Œå°†å¤±è´¥çš„æ¶ˆæ¯å‘é€åˆ°æ­»ä¿¡ä¸»é¢˜")]),s._v(" "),t("li",[s._v("è®°å½•å¤±è´¥çš„åŸå› å’Œä¸Šä¸‹æ–‡ä¿¡æ¯")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@KafkaListener")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("topics "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order.processing"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" groupId "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order.processing.group"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("processOrder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Header")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaHeaders")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OFFSET")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" offset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†è®¢å•æ¶ˆæ¯")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("processOrderMessage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†å¤±è´¥ï¼Œå‘é€åˆ°æ­»ä¿¡ä¸»é¢˜")]),s._v("\n        deadLetterProducer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order.dlq"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" message "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"|error:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getMessage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®°å½•é”™è¯¯æ—¥å¿—")]),s._v("\n        log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("error")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed to process order message at offset {}: {}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" offset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h3",{attrs:{id:"æ­»ä¿¡é˜Ÿåˆ—çš„åº”ç”¨åœºæ™¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ­»ä¿¡é˜Ÿåˆ—çš„åº”ç”¨åœºæ™¯"}},[s._v("#")]),s._v(" æ­»ä¿¡é˜Ÿåˆ—çš„åº”ç”¨åœºæ™¯")]),s._v(" "),t("h4",{attrs:{id:"_1-è®¢å•å¤„ç†å¤±è´¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-è®¢å•å¤„ç†å¤±è´¥"}},[s._v("#")]),s._v(" 1. è®¢å•å¤„ç†å¤±è´¥")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®¢å•å¤„ç†æœåŠ¡")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderProcessingService")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RocketMQTemplate")]),s._v(" rocketMQTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RocketMQMessageListener")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("topic "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order.processing"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" consumerGroup "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order.processing.group"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderProcessingConsumer")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RocketMQListener")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("onMessage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" order "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("parseOrderMessage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                \n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†è®¢å•")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("processOrder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                \n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–°è®¢å•çŠ¶æ€")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateOrderStatus")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("order"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderStatus")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PROCESSED")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                \n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderProcessingException")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†å¤±è´¥ï¼Œè®°å½•æ—¥å¿—")]),s._v("\n                log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("error")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed to process order: {}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                \n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—äººå·¥å¤„ç†")]),s._v("\n                rocketMQTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("syncSend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order.dlq"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])]),t("h2",{attrs:{id:"å»¶è¿Ÿé˜Ÿåˆ—ä¸æ­»ä¿¡é˜Ÿåˆ—çš„ç»“åˆä½¿ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å»¶è¿Ÿé˜Ÿåˆ—ä¸æ­»ä¿¡é˜Ÿåˆ—çš„ç»“åˆä½¿ç”¨"}},[s._v("#")]),s._v(" å»¶è¿Ÿé˜Ÿåˆ—ä¸æ­»ä¿¡é˜Ÿåˆ—çš„ç»“åˆä½¿ç”¨")]),s._v(" "),t("p",[s._v("åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå»¶è¿Ÿé˜Ÿåˆ—å’Œæ­»ä¿¡é˜Ÿåˆ—ç»å¸¸ç»“åˆä½¿ç”¨ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„æ¶ˆæ¯å¤„ç†æµç¨‹ï¼š")]),s._v(" "),t("ol",[t("li",[s._v("æ¶ˆæ¯é¦–å…ˆè¿›å…¥åŸå§‹é˜Ÿåˆ—")]),s._v(" "),t("li",[s._v("æ¶ˆè´¹è€…å°è¯•å¤„ç†æ¶ˆæ¯")]),s._v(" "),t("li",[s._v("å¦‚æœå¤„ç†å¤±è´¥ï¼Œæ¶ˆæ¯è¿›å…¥é‡è¯•é˜Ÿåˆ—ï¼ˆå¯ä»¥æ˜¯å»¶è¿Ÿé˜Ÿåˆ—ï¼‰")]),s._v(" "),t("li",[s._v("å¦‚æœå¤šæ¬¡é‡è¯•ä»ç„¶å¤±è´¥ï¼Œæ¶ˆæ¯è¿›å…¥æ­»ä¿¡é˜Ÿåˆ—")]),s._v(" "),t("li",[s._v("è¿ç»´äººå‘˜ä»‹å…¥å¤„ç†æ­»ä¿¡é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯")])]),s._v(" "),t("h3",{attrs:{id:"rabbitmqä¸­çš„å®ç°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmqä¸­çš„å®ç°"}},[s._v("#")]),s._v(" RabbitMQä¸­çš„å®ç°")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1. å£°æ˜æ­»ä¿¡äº¤æ¢å™¨å’Œé˜Ÿåˆ—")]),s._v("\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exchangeDeclare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlx.exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"direct"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queueDeclare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlq.queue"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queueBind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlq.queue"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlx.exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlq.key"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2. å£°æ˜é‡è¯•é˜Ÿåˆ—ï¼ˆå»¶è¿Ÿé˜Ÿåˆ—ï¼‰")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" retryArgs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashMap")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nretryArgs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-dead-letter-exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlx.exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nretryArgs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-dead-letter-routing-key"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dlq.key"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nretryArgs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-message-ttl"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1åˆ†é’Ÿåæˆä¸ºæ­»ä¿¡")]),s._v("\n\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queueDeclare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"retry.queue"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" retryArgs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 3. å£°æ˜åŸå§‹é˜Ÿåˆ—ï¼Œè®¾ç½®æ­»ä¿¡äº¤æ¢å™¨ä¸ºé‡è¯•é˜Ÿåˆ—")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" originalArgs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashMap")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\noriginalArgs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-dead-letter-exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"retry.exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\noriginalArgs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-dead-letter-routing-key"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"retry.key"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queueDeclare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"original.queue"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" originalArgs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 4. å£°æ˜é‡è¯•äº¤æ¢å™¨")]),s._v("\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exchangeDeclare")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"retry.exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"direct"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nchannel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queueBind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"retry.queue"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"retry.exchange"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"retry.key"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("h2",{attrs:{id:"æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹"}},[s._v("#")]),s._v(" æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹")]),s._v(" "),t("h3",{attrs:{id:"å»¶è¿Ÿé˜Ÿåˆ—çš„æœ€ä½³å®è·µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å»¶è¿Ÿé˜Ÿåˆ—çš„æœ€ä½³å®è·µ"}},[s._v("#")]),s._v(" å»¶è¿Ÿé˜Ÿåˆ—çš„æœ€ä½³å®è·µ")]),s._v(" "),t("ol",[t("li",[t("p",[t("strong",[s._v("åˆç†è®¾ç½®å»¶è¿Ÿæ—¶é—´")]),s._v("ï¼šé¿å…è®¾ç½®è¿‡é•¿çš„å»¶è¿Ÿæ—¶é—´ï¼Œå¯èƒ½å¯¼è‡´æ¶ˆæ¯ç§¯å‹å’Œç³»ç»Ÿèµ„æºæµªè´¹ã€‚")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("ç›‘æ§å»¶è¿Ÿé˜Ÿåˆ—")]),s._v("ï¼šå®šæœŸç›‘æ§å»¶è¿Ÿé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ•°é‡å’Œå¤„ç†æƒ…å†µï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸ã€‚")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("é¿å…å»¶è¿Ÿæ—¶é—´è¿‡é•¿")]),s._v("ï¼šæŸäº›æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿï¼ˆå¦‚Kafkaï¼‰ä¸é€‚åˆå¤„ç†é•¿æ—¶é—´å»¶è¿Ÿçš„æ¶ˆæ¯ï¼Œè€ƒè™‘ä½¿ç”¨ä¸“é—¨çš„è°ƒåº¦ç³»ç»Ÿã€‚")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("ä½¿ç”¨åˆé€‚çš„å»¶è¿Ÿçº§åˆ«")]),s._v("ï¼šå¯¹äºRocketMQç­‰é¢„å®šä¹‰å»¶è¿Ÿçº§åˆ«çš„ç³»ç»Ÿï¼Œé€‰æ‹©åˆé€‚çš„å»¶è¿Ÿçº§åˆ«è€Œä¸æ˜¯éšæ„è®¾ç½®ã€‚")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("è€ƒè™‘æ—¶åŒºé—®é¢˜")]),s._v("ï¼šå¦‚æœå»¶è¿Ÿæ—¶é—´ä¸æ—¶åŒºç›¸å…³ï¼Œç¡®ä¿æ­£ç¡®å¤„ç†æ—¶åŒºè½¬æ¢ã€‚")])])]),s._v(" "),t("h3",{attrs:{id:"æ­»ä¿¡é˜Ÿåˆ—çš„æœ€ä½³å®è·µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ­»ä¿¡é˜Ÿåˆ—çš„æœ€ä½³å®è·µ"}},[s._v("#")]),s._v(" æ­»ä¿¡é˜Ÿåˆ—çš„æœ€ä½³å®è·µ")]),s._v(" "),t("ol",[t("li",[t("p",[t("strong",[s._v("è®¾ç½®åˆç†çš„é‡è¯•æ¬¡æ•°")]),s._v("ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®åˆç†çš„é‡è¯•æ¬¡æ•°ï¼Œé¿å…æ— é™é‡è¯•å¯¼è‡´èµ„æºæµªè´¹ã€‚")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("è®°å½•è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯")]),s._v("ï¼šåœ¨å‘é€æ¶ˆæ¯åˆ°æ­»ä¿¡é˜Ÿåˆ—æ—¶ï¼Œè®°å½•è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä¾¿äºåç»­åˆ†æå’Œå¤„ç†ã€‚")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("å®šæœŸå¤„ç†æ­»ä¿¡é˜Ÿåˆ—")]),s._v("ï¼šå»ºç«‹å®šæœŸæ£€æŸ¥å’Œå¤„ç†æ­»ä¿¡é˜Ÿåˆ—çš„æœºåˆ¶ï¼Œé¿å…æ­»ä¿¡é˜Ÿåˆ—æ— é™å¢é•¿ã€‚")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("åˆ†ç±»å¤„ç†æ­»ä¿¡æ¶ˆæ¯")]),s._v("ï¼šæ ¹æ®ä¸åŒçš„é”™è¯¯ç±»å‹ï¼Œé‡‡å–ä¸åŒçš„å¤„ç†ç­–ç•¥ï¼ˆå¦‚é‡è¯•ã€äººå·¥å¹²é¢„ã€ä¸¢å¼ƒç­‰ï¼‰ã€‚")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("ç›‘æ§æ­»ä¿¡é˜Ÿåˆ—")]),s._v("ï¼šè®¾ç½®å‘Šè­¦ï¼Œå½“æ­»ä¿¡é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯è¶…è¿‡ä¸€å®šæ•°é‡æ—¶åŠæ—¶é€šçŸ¥è¿ç»´äººå‘˜ã€‚")])])]),s._v(" "),t("h3",{attrs:{id:"å»¶è¿Ÿä¸æ­»ä¿¡é˜Ÿåˆ—çš„ç»“åˆä½¿ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å»¶è¿Ÿä¸æ­»ä¿¡é˜Ÿåˆ—çš„ç»“åˆä½¿ç”¨"}},[s._v("#")]),s._v(" å»¶è¿Ÿä¸æ­»ä¿¡é˜Ÿåˆ—çš„ç»“åˆä½¿ç”¨")]),s._v(" "),t("ol",[t("li",[t("p",[t("strong",[s._v("è®¾è®¡åˆç†çš„é‡è¯•ç­–ç•¥")]),s._v("ï¼šæ ¹æ®ä¸šåŠ¡é‡è¦æ€§è®¾è®¡ä¸åŒçš„é‡è¯•ç­–ç•¥ï¼Œå¦‚æŒ‡æ•°é€€é¿ã€å›ºå®šé—´éš”ç­‰ã€‚")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("å®ç°è‡ªåŠ¨åŒ–å¤„ç†æµç¨‹")]),s._v("ï¼šå¯¹äºå¯æ¢å¤çš„é”™è¯¯ï¼Œå®ç°è‡ªåŠ¨åŒ–çš„å¤„ç†æµç¨‹ï¼Œå‡å°‘äººå·¥å¹²é¢„ã€‚")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("ä¿ç•™å®Œæ•´çš„å¤„ç†å†å²")]),s._v("ï¼šè®°å½•æ¶ˆæ¯å¤„ç†çš„æ‰€æœ‰å°è¯•å’Œç»“æœï¼Œä¾¿äºé—®é¢˜æ’æŸ¥ã€‚")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("å®ç°æ­»ä¿¡æ¶ˆæ¯çš„è‡ªåŠ¨æ¢å¤")]),s._v("ï¼šå¯¹äºæŸäº›ç±»å‹çš„é”™è¯¯ï¼Œå®ç°è‡ªåŠ¨æ¢å¤æœºåˆ¶ï¼Œå°†æ­»ä¿¡æ¶ˆæ¯é‡æ–°åŠ å…¥æ­£å¸¸å¤„ç†æµç¨‹ã€‚")])])]),s._v(" "),t("h2",{attrs:{id:"ç»“è¯­"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç»“è¯­"}},[s._v("#")]),s._v(" ç»“è¯­")]),s._v(" "),t("p",[s._v("å»¶è¿Ÿé˜Ÿåˆ—å’Œæ­»ä¿¡é˜Ÿåˆ—æ˜¯æ„å»ºå¥å£®æ¶ˆæ¯ç³»ç»Ÿçš„ä¸¤ä¸ªå…³é”®æœºåˆ¶ã€‚é€šè¿‡åˆç†ä½¿ç”¨è¿™ä¸¤ç§æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰æ•ˆåº”å¯¹å„ç§å¼‚å¸¸æƒ…å†µï¼Œæé«˜ç³»ç»Ÿçš„å¯é æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚")]),s._v(" "),t("p",[s._v("åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚å’Œç³»ç»Ÿç‰¹ç‚¹ï¼Œé€‰æ‹©åˆé€‚çš„å®ç°æ–¹å¼å’Œé…ç½®å‚æ•°ã€‚åŒæ—¶ï¼Œå»ºç«‹å®Œå–„çš„ç›‘æ§å’Œå¤„ç†æœºåˆ¶ï¼Œç¡®ä¿å»¶è¿Ÿå’Œæ­»ä¿¡é˜Ÿåˆ—èƒ½å¤Ÿå‘æŒ¥åº”æœ‰çš„ä½œç”¨ã€‚")]),s._v(" "),t("p",[s._v("è®°ä½ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ä¸ä»…ä»…æ˜¯è¿æ¥ç³»ç»Ÿçš„ç®¡é“ï¼Œæ›´æ˜¯ç³»ç»Ÿç¨³å®šè¿è¡Œçš„ä¿éšœã€‚é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„å»¶è¿Ÿå’Œæ­»ä¿¡æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå‡ºæ›´åŠ å¯é å’Œå¼¹æ€§çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚ğŸš€")]),s._v(" "),t("blockquote",[t("p",[s._v('"åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½å‡è®¾ä¸€åˆ‡éƒ½ä¼šæ­£å¸¸å·¥ä½œã€‚ç›¸åï¼Œæˆ‘ä»¬åº”è¯¥è®¾è®¡ç³»ç»Ÿï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨éƒ¨åˆ†ç»„ä»¶å¤±è´¥çš„æƒ…å†µä¸‹ç»§ç»­è¿è¡Œã€‚å»¶è¿Ÿé˜Ÿåˆ—å’Œæ­»ä¿¡é˜Ÿåˆ—æ­£æ˜¯è¿™ç§è®¾è®¡å“²å­¦çš„å…·ä½“ä½“ç°ã€‚"')])]),s._v(" "),t("p",[s._v("å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨å»¶è¿Ÿé˜Ÿåˆ—ä¸æ­»ä¿¡é˜Ÿåˆ—ï¼Œæ„å»ºæ›´åŠ å¥å£®çš„æ¶ˆæ¯ç³»ç»Ÿï¼å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºã€‚ğŸ˜Š")])])}),[],!1,null,null,null);t.default=e.exports}}]);