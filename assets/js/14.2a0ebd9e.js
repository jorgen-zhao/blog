(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{359:function(t,a,r){"use strict";r.r(a);var v=r(14),s=Object(v.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("说明")]),t._v(" "),a("p",[t._v("主要记录下如何使用Poi-tl生成复杂模板")])]),t._v(" "),a("h2",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),a("p",[t._v("poi-tl（poi template language）是Word模板引擎，使用Word模板和数据创建很棒的Word文档。")]),t._v(" "),a("blockquote",[a("p",[t._v("在文档的任何地方做任何事情（Do Anything Anywhere）是poi-tl的星辰大海。")])]),t._v(" "),a("h3",{attrs:{id:"不同方案对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不同方案对比"}},[t._v("#")]),t._v(" 不同方案对比")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("方案")]),t._v(" "),a("th",[t._v("移植性")]),t._v(" "),a("th",[t._v("功能性")]),t._v(" "),a("th",[t._v("易用性")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Poi-tl")]),t._v(" "),a("td",[t._v("Java跨平台")]),t._v(" "),a("td",[t._v("Word模板引擎，基于Apache POI，提供更友好的API")]),t._v(" "),a("td",[t._v("低代码，准备文档模板和数据即可")])]),t._v(" "),a("tr",[a("td",[t._v("Apache POI")]),t._v(" "),a("td",[t._v("Java跨平台")]),t._v(" "),a("td",[t._v("Apache项目，封装了常见的文档操作，也可以操作底层XML结构")]),t._v(" "),a("td",[t._v("文档不全，这里有一个教程：http://deepoove.com/poi-tl/apache-poi-guide.html")])]),t._v(" "),a("tr",[a("td",[t._v("Freemarker")]),t._v(" "),a("td",[t._v("XML跨平台")]),t._v(" "),a("td",[t._v("仅支持文本，很大的局限性")]),t._v(" "),a("td",[t._v("不推荐，XML结构的代码几乎无法维护")])]),t._v(" "),a("tr",[a("td",[t._v("OpenOffice")]),t._v(" "),a("td",[t._v("部署OpenOffice，移植性较差")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("需要了解OpenOffice的API")])]),t._v(" "),a("tr",[a("td",[t._v("HTML浏览器导出")]),t._v(" "),a("td",[t._v("依赖浏览器的实现，移植性较差")]),t._v(" "),a("td",[t._v("HTML不能很好的兼容Word的格式，样式糟糕")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[t._v("Jacob、winlib")]),t._v(" "),a("td",[t._v("Windows平台")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("复杂，完全不推荐使用")])])])]),t._v(" "),a("h2",{attrs:{id:"功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#功能"}},[t._v("#")]),t._v(" 功能")]),t._v(" "),a("blockquote",[a("p",[t._v("使用它，你能轻松应对诸如以下这些场景")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/dev/130/1.png",alt:"场景"}}),t._v(" "),a("img",{attrs:{src:"/dev/130/2.png",alt:"场景"}}),t._v(" "),a("img",{attrs:{src:"/dev/130/3.png",alt:"场景"}})]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Word模板引擎功能")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("文本")]),t._v(" "),a("td",[t._v("将标签渲染为文本")])]),t._v(" "),a("tr",[a("td",[t._v("图片")]),t._v(" "),a("td",[t._v("将标签渲染为图片")])]),t._v(" "),a("tr",[a("td",[t._v("表格")]),t._v(" "),a("td",[t._v("将标签渲染为表格")])]),t._v(" "),a("tr",[a("td",[t._v("列表")]),t._v(" "),a("td",[t._v("将标签渲染为列表")])]),t._v(" "),a("tr",[a("td",[t._v("图表")]),t._v(" "),a("td",[t._v("条形图（3D条形图）、柱形图（3D柱形图）、面积图（3D面积图）、折线图（3D折线图）、雷达图、饼图（3D饼图）、散点图等图表渲染")])]),t._v(" "),a("tr",[a("td",[t._v("If Condition判断")]),t._v(" "),a("td",[t._v("根据条件隐藏或者显示某些文档内容（包括文本、段落、图片、表格、列表、图表等）")])]),t._v(" "),a("tr",[a("td",[t._v("Foreach Loop循环")]),t._v(" "),a("td",[t._v("根据集合循环某些文档内容（包括文本、段落、图片、表格、列表、图表等）")])]),t._v(" "),a("tr",[a("td",[t._v("Loop表格行")]),t._v(" "),a("td",[t._v("循环复制渲染表格的某一行")])]),t._v(" "),a("tr",[a("td",[t._v("Loop表格列")]),t._v(" "),a("td",[t._v("循环复制渲染表格的某一列")])]),t._v(" "),a("tr",[a("td",[t._v("Loop有序列表")]),t._v(" "),a("td",[t._v("支持有序列表的循环，同时支持多级列表")])]),t._v(" "),a("tr",[a("td",[t._v("Highlight代码高亮")]),t._v(" "),a("td",[t._v("word中代码块高亮展示，支持26种语言和上百种着色样式")])]),t._v(" "),a("tr",[a("td",[t._v("Markdown")]),t._v(" "),a("td",[t._v("将Markdown渲染为word文档")])]),t._v(" "),a("tr",[a("td",[t._v("Word批注")]),t._v(" "),a("td",[t._v("完整的批注功能，创建批注、修改批注等")])]),t._v(" "),a("tr",[a("td",[t._v("Word附件")]),t._v(" "),a("td",[t._v("Word中插入附件")])]),t._v(" "),a("tr",[a("td",[t._v("SDT内容控件")]),t._v(" "),a("td",[t._v("内容控件内标签支持")])]),t._v(" "),a("tr",[a("td",[t._v("Textbox文本框")]),t._v(" "),a("td",[t._v("文本框内标签支持")])]),t._v(" "),a("tr",[a("td",[t._v("图片替换")]),t._v(" "),a("td",[t._v("将原有图片替换成另一张图片")])]),t._v(" "),a("tr",[a("td",[t._v("书签、锚点、超链接")]),t._v(" "),a("td",[t._v("支持设置书签，文档内锚点和超链接功能")])]),t._v(" "),a("tr",[a("td",[t._v("Expression Language")]),t._v(" "),a("td",[t._v("完全支持SpringEL表达式，可以扩展更多的表达式：OGNL, MVEL…​")])]),t._v(" "),a("tr",[a("td",[t._v("样式")]),t._v(" "),a("td",[t._v("模板即样式，同时代码也可以设置样式")])]),t._v(" "),a("tr",[a("td",[t._v("模板嵌套")]),t._v(" "),a("td",[t._v("模板包含子模板，子模板再包含子模板")])]),t._v(" "),a("tr",[a("td",[t._v("合并")]),t._v(" "),a("td",[t._v("Word合并Merge，也可以在指定位置进行合并")])]),t._v(" "),a("tr",[a("td",[t._v("用户自定义函数(插件)")]),t._v(" "),a("td",[t._v("插件化设计，在文档任何位置执行函数")])])])]),t._v(" "),a("h2",{attrs:{id:"使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[t._v("#")]),t._v(" 使用")]),t._v(" "),a("blockquote",[a("p",[t._v("Java maven方式使用")])]),t._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.deepoove"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("poi-tl"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("1.12.1"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("h2",{attrs:{id:"拓展"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#拓展"}},[t._v("#")]),t._v(" 拓展")]),t._v(" "),a("blockquote",[a("p",[t._v("此处就不在详细的介绍如何使用了，感兴趣或者有报告生成需求的直接点击"),a("a",{attrs:{href:"http://deepoove.com/poi-tl/",target:"_blank",rel:"noopener noreferrer"}},[t._v("官网"),a("OutboundLink")],1),t._v("进行学习。")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("需求")]),t._v(" "),a("p",[t._v("在word文档中嵌入echarts图标")])]),t._v(" "),a("h3",{attrs:{id:"思考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#思考"}},[t._v("#")]),t._v(" 思考")]),t._v(" "),a("p",[t._v("本来这个需求原本是手工完成，用户在浏览器看到echarts图，点击下载。然后粘贴在word中，完成报告。现在需要通过程序来实现。")]),t._v(" "),a("ul",[a("li",[t._v("要么前端生成word文档，渲染后直接下载。")]),t._v(" "),a("li",[t._v("要么使用Java方式生成，并使用POI方式插入图片。")])]),t._v(" "),a("h3",{attrs:{id:"方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案"}},[t._v("#")]),t._v(" 方案")]),t._v(" "),a("p",[a("strong",[t._v("JS生成Word")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fevidenceprime%2Fhtml-docx-js",target:"_blank",rel:"noopener noreferrer"}},[t._v("html-docx-js"),a("OutboundLink")],1),t._v("：Converts HTML documents to DOCX in the browser")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/markswindoll/jQuery-Word-Export",target:"_blank",rel:"noopener noreferrer"}},[t._v("jQuery-Word-Export"),a("OutboundLink")],1),t._v("jQuery plugin for exporting HTML and images to a Microsoft Word document\n优点: 通过js的方式就能生成word。\n缺点: 文件不能太大 (5M)，不灵活。")])]),t._v(" "),a("blockquote",[a("p",[t._v("使用JS的方式不行，还是回到Java程序来生成。")])]),t._v(" "),a("p",[a("strong",[t._v("JAVA生成")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/ECharts-Java/ECharts-Java",target:"_blank",rel:"noopener noreferrer"}},[t._v("ECharts-Java"),a("OutboundLink")],1),t._v(": A Java Visualization Library based on Apache ECharts 5.x. 基于 Apache ECharts 5.x 的 Java 可视化类库。")])]),t._v(" "),a("blockquote",[a("p",[t._v("这个确实能用Java实现生成echarts图表与echarts需要option。但是，我需要拿到图片，然后将图片插入到Word中。这不算是一个最终的解决方案。")])]),t._v(" "),a("p",[a("strong",[t._v("Node")])]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/striezel/echarts-node-export-server",target:"_blank",rel:"noopener noreferrer"}},[t._v("echarts-node-export-server"),a("OutboundLink")],1),t._v(": Node.js server for offline export of ECharts graphs")])]),t._v(" "),a("blockquote",[a("p",[t._v("最终，我将目光移到了Node上。功夫不负有心人，终于找到了通过option参数就能获取到图片base64数据。也就意味着，能直接写入Word中了。")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("最终方案")]),t._v(" "),a("p",[t._v("使用 **"),a("a",{attrs:{href:"https://github.com/ECharts-Java/ECharts-Java",target:"_blank",rel:"noopener noreferrer"}},[t._v("ECharts-Java"),a("OutboundLink")],1),t._v("**生成符合格式的JSON版本的option，然后调用"),a("a",{attrs:{href:"https://github.com/FrankChen021/node-charts",target:"_blank",rel:"noopener noreferrer"}},[t._v("node-echarts"),a("OutboundLink")],1),t._v(" "),a("code",[t._v("REST")]),t._v("接口生成（图片，直接保存本地，返回地址），"),a("code",[t._v("base64")]),t._v("，然后转换成图片。再插入到Word中。")])]),t._v(" "),a("p",[t._v("最后呢，想表达一句。技术从不是从一而终的，一个需求对应一个直接的解决方案。而是多种方案的折中，取长补短，各取所长。最后达到一个相对而言的比较能接受的方案。")]),t._v(" "),a("p",[a("strong",[t._v("当然，我的这个方案也并不完美，不过提供了一种思路，解决问题时，不要总是将目光局限在自己熟悉领域的一亩三分地里，打开眼界，格局打开👐。或许就能发现不一样的风景🎨。")])])])}),[],!1,null,null,null);a.default=s.exports}}]);