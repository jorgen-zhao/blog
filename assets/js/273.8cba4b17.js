(window.webpackJsonp=window.webpackJsonp||[]).push([[273],{624:function(t,s,a){"use strict";a.r(s);var n=a(15),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"å‰è¨€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[t._v("#")]),t._v(" å‰è¨€")]),t._v(" "),s("p",[t._v("åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†Flinkçš„åŸºæœ¬æ¶æ„å’Œé…ç½®ï¼Œä¹Ÿæ·±å…¥æ¢è®¨äº†åˆ†å¸ƒå¼æ•°æ®å¤„ç†å¼•æ“çš„æ ¸å¿ƒåŸç†ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€ä¸ªè‡³å…³é‡è¦çš„ä¸»é¢˜æˆ‘ä»¬è¿˜æ²¡æœ‰è¯¦ç»†è®¨è®ºâ€”â€”é‚£å°±æ˜¯"),s("strong",[t._v("çŠ¶æ€ç®¡ç†ä¸å®¹é”™æœºåˆ¶")]),t._v("ã€‚ğŸ¤”")]),t._v(" "),s("p",[t._v("åœ¨æµå¤„ç†çš„ä¸–ç•Œé‡Œï¼Œæ•°æ®å¯èƒ½ä¼šå› ä¸ºå„ç§åŸå› ä¸¢å¤±æˆ–å¤„ç†å¤±è´¥ï¼Œæ¯”å¦‚ç½‘ç»œé—®é¢˜ã€èŠ‚ç‚¹æ•…éšœã€ç³»ç»Ÿå´©æºƒç­‰ã€‚å¦‚æœæ²¡æœ‰å¯é çš„çŠ¶æ€ç®¡ç†å’Œå®¹é”™æœºåˆ¶ï¼Œæˆ‘ä»¬çš„æ•°æ®å¤„ç†ç»“æœå°†å˜å¾—ä¸å¯é ï¼Œç”šè‡³äº§ç”Ÿé”™è¯¯çš„ä¸šåŠ¡å†³ç­–ã€‚ä»Šå¤©ï¼Œæˆ‘å°±æ¥å’Œå¤§å®¶ä¸€èµ·æ·±å…¥æ¢è®¨Flinkä¸­è¿™ä¸ªä¿è¯å¯é æ€§çš„æ ¸å¿ƒæœºåˆ¶ã€‚")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("æç¤º")]),t._v(" "),s("p",[t._v('çŠ¶æ€ç®¡ç†æ˜¯æµå¤„ç†åŒºåˆ«äºæ‰¹å¤„ç†çš„å…³é”®ç‰¹å¾ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯Flinkèƒ½å¤Ÿæä¾›"ç²¾ç¡®ä¸€æ¬¡"(exactly-once)è¯­ä¹‰ä¿è¯çš„åŸºç¡€ã€‚')])]),t._v(" "),s("h2",{attrs:{id:"flinkä¸­çš„çŠ¶æ€æ¦‚è¿°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flinkä¸­çš„çŠ¶æ€æ¦‚è¿°"}},[t._v("#")]),t._v(" Flinkä¸­çš„çŠ¶æ€æ¦‚è¿°")]),t._v(" "),s("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯çŠ¶æ€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯çŠ¶æ€"}},[t._v("#")]),t._v(" ä»€ä¹ˆæ˜¯çŠ¶æ€ï¼Ÿ")]),t._v(" "),s("p",[t._v("åœ¨æµå¤„ç†åº”ç”¨ä¸­ï¼Œ"),s("strong",[t._v("çŠ¶æ€")]),t._v("æ˜¯æŒ‡è®¡ç®—è¿‡ç¨‹ä¸­éœ€è¦è®°ä½çš„æ•°æ®ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è®¡ç®—è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ä¸­é—´ç»“æœæˆ–éœ€è¦é•¿æœŸä¿å­˜çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("åœ¨ç»Ÿè®¡å•è¯é¢‘ç‡çš„åº”ç”¨ä¸­ï¼Œæ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°å°±æ˜¯çŠ¶æ€")]),t._v(" "),s("li",[t._v("åœ¨æ£€æµ‹å¼‚å¸¸äº¤æ˜“çš„åº”ç”¨ä¸­ï¼Œæœ€è¿‘å‡ åˆ†é’Ÿçš„äº¤æ˜“è®°å½•å°±æ˜¯çŠ¶æ€")]),t._v(" "),s("li",[t._v("åœ¨è®¡ç®—ç”¨æˆ·è¡Œä¸ºçš„åº”ç”¨ä¸­ï¼Œç”¨æˆ·çš„ç‚¹å‡»å†å²å°±æ˜¯çŠ¶æ€")])]),t._v(" "),s("p",[t._v("Flinkä¸­çš„çŠ¶æ€å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("Keyed State")]),t._v(" - ä¸ç‰¹å®šé”®å…³è”çš„çŠ¶æ€ï¼Œä¾‹å¦‚æŸä¸ªç”¨æˆ·çš„è´­ç‰©è½¦å†…å®¹")]),t._v(" "),s("li",[s("strong",[t._v("Operator State")]),t._v(" - ä¸ç‰¹å®šæ“ä½œç¬¦å®ä¾‹å…³è”çš„çŠ¶æ€ï¼Œä¾‹å¦‚Kafkaæ¶ˆè´¹è€…è¯»å–çš„åç§»é‡")])]),t._v(" "),s("h3",{attrs:{id:"çŠ¶æ€åç«¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çŠ¶æ€åç«¯"}},[t._v("#")]),t._v(" çŠ¶æ€åç«¯")]),t._v(" "),s("p",[t._v("Flinkä½¿ç”¨"),s("strong",[t._v("çŠ¶æ€åç«¯")]),t._v("æ¥å­˜å‚¨å’Œç®¡ç†çŠ¶æ€ã€‚Flinkæä¾›äº†ä¸‰ç§å†…ç½®çš„çŠ¶æ€åç«¯ï¼š")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("MemoryStateBackend")]),t._v(" - çŠ¶æ€å­˜å‚¨åœ¨TaskManagerçš„å†…å­˜ä¸­")]),t._v(" "),s("li",[s("strong",[t._v("FsStateBackend")]),t._v(" - çŠ¶æ€å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­")]),t._v(" "),s("li",[s("strong",[t._v("RocksDBStateBackend")]),t._v(" - çŠ¶æ€å­˜å‚¨åœ¨RocksDBæ•°æ®åº“ä¸­")])]),t._v(" "),s("div",{staticClass:"custom-block theorem"},[s("p",{staticClass:"title"},[t._v("THEOREM")]),s("p",[t._v("é€‰æ‹©åˆé€‚çš„çŠ¶æ€åç«¯å¯¹åº”ç”¨çš„æ€§èƒ½å’Œå¯é æ€§è‡³å…³é‡è¦ã€‚å¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œé€šå¸¸æ¨èä½¿ç”¨RocksDBStateBackendï¼Œå› ä¸ºå®ƒå¯ä»¥å¤„ç†å¤§è§„æ¨¡çŠ¶æ€æ•°æ®ã€‚")])]),s("h2",{attrs:{id:"checkpointæœºåˆ¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#checkpointæœºåˆ¶"}},[t._v("#")]),t._v(" Checkpointæœºåˆ¶")]),t._v(" "),s("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯checkpoint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯checkpoint"}},[t._v("#")]),t._v(" ä»€ä¹ˆæ˜¯Checkpointï¼Ÿ")]),t._v(" "),s("p",[s("strong",[t._v("Checkpoint")]),t._v("æ˜¯Flinkæä¾›çš„ä¸€ç§å®¹é”™æœºåˆ¶ï¼Œå®ƒå®šæœŸåˆ›å»ºåˆ†å¸ƒå¼æ•°æ®æµçš„å¿«ç…§ï¼Œè®°å½•æ‰€æœ‰ç®—å­çš„çŠ¶æ€ã€‚å½“ç³»ç»Ÿå‘ç”Ÿæ•…éšœæ—¶ï¼ŒFlinkå¯ä»¥ä»æœ€è¿‘çš„Checkpointæ¢å¤çŠ¶æ€ï¼Œé‡æ–°å¤„ç†æ•°æ®ï¼Œä»è€Œä¿è¯è®¡ç®—ç»“æœçš„æ­£ç¡®æ€§ã€‚")]),t._v(" "),s("h3",{attrs:{id:"checkpointçš„å·¥ä½œåŸç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#checkpointçš„å·¥ä½œåŸç†"}},[t._v("#")]),t._v(" Checkpointçš„å·¥ä½œåŸç†")]),t._v(" "),s("p",[t._v("Flinkçš„Checkpointæœºåˆ¶åŸºäºChandy-Lamportç®—æ³•å®ç°ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("Barrierä¼ æ’­")]),t._v(" - Flinkåœ¨æ•°æ®æµä¸­æ’å…¥ç‰¹æ®Šçš„Barrierï¼Œè¿™äº›Barrierä¼šéšç€æ•°æ®ä¸€èµ·æµåŠ¨")]),t._v(" "),s("li",[s("strong",[t._v("çŠ¶æ€å¿«ç…§")]),t._v(" - å½“Barrieråˆ°è¾¾ç®—å­æ—¶ï¼Œç®—å­ä¼šä¿å­˜å½“å‰çŠ¶æ€åˆ°æŒä¹…åŒ–å­˜å‚¨")]),t._v(" "),s("li",[s("strong",[t._v("ç¡®è®¤åé¦ˆ")]),t._v(" - ç®—å­å®ŒæˆçŠ¶æ€ä¿å­˜åï¼Œä¼šå‘JobManagerå‘é€ç¡®è®¤ä¿¡æ¯")]),t._v(" "),s("li",[s("strong",[t._v("å®Œæˆé€šçŸ¥")]),t._v(" - å½“æ‰€æœ‰ç®—å­éƒ½å®ŒæˆCheckpointåï¼ŒJobManagerä¼šé€šçŸ¥æ‰€æœ‰ç®—å­Checkpointå·²å®Œæˆ")])]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/flink-checkpoint.png",alt:"Checkpointå·¥ä½œåŸç†"}})]),t._v(" "),s("h3",{attrs:{id:"é…ç½®checkpoint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®checkpoint"}},[t._v("#")]),t._v(" é…ç½®Checkpoint")]),t._v(" "),s("p",[t._v("åœ¨Flinkä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼é…ç½®Checkpointï¼š")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯ç”¨Checkpointï¼Œæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡")]),t._v("\nenv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("enableCheckpointing")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®Checkpointæ¨¡å¼ä¸ºEXACTLY_ONCE")]),t._v("\nenv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCheckpointConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCheckpointingMode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CheckpointingMode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EXACTLY_ONCE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®Checkpointè¶…æ—¶æ—¶é—´")]),t._v("\nenv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCheckpointConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCheckpointTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®ä¸¤ä¸ªCheckpointä¹‹é—´çš„æœ€å°é—´éš”")]),t._v("\nenv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCheckpointConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setMinPauseBetweenCheckpoints")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®åŒæ—¶è¿›è¡Œçš„Checkpointçš„æœ€å¤§æ•°é‡")]),t._v("\nenv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCheckpointConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setMaxConcurrentCheckpoints")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®å¤–éƒ¨æŒä¹…åŒ–å­˜å‚¨çš„è·¯å¾„")]),t._v("\nenv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setStateBackend")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RocksDBStateBackend")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hdfs://namenode:8020/flink/checkpoints"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br")])]),s("h2",{attrs:{id:"savepointæœºåˆ¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#savepointæœºåˆ¶"}},[t._v("#")]),t._v(" Savepointæœºåˆ¶")]),t._v(" "),s("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯savepoint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯savepoint"}},[t._v("#")]),t._v(" ä»€ä¹ˆæ˜¯Savepointï¼Ÿ")]),t._v(" "),s("p",[s("strong",[t._v("Savepoint")]),t._v("æ˜¯Checkpointçš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œå®ƒæä¾›äº†æ›´é«˜çº§çš„åŠŸèƒ½ï¼š")]),t._v(" "),s("ol",[s("li",[t._v("æ‰‹åŠ¨è§¦å‘ï¼Œä¸å—Checkpointé—´éš”é™åˆ¶")]),t._v(" "),s("li",[t._v("åŒ…å«æ›´å¤šå…ƒæ•°æ®ï¼Œå¯ä»¥ç”¨äºåº”ç”¨å‡çº§ã€è¿ç§»æˆ–æ¢å¤")]),t._v(" "),s("li",[t._v("å¯ä»¥åœ¨ä»»ä½•æ—¶é—´ç‚¹åˆ›å»ºï¼Œè€Œä¸å½±å“æ­£åœ¨è¿è¡Œçš„ä½œä¸š")])]),t._v(" "),s("h3",{attrs:{id:"ä½¿ç”¨savepoint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨savepoint"}},[t._v("#")]),t._v(" ä½¿ç”¨Savepoint")]),t._v(" "),s("p",[t._v("åˆ›å»ºSavepointçš„å‘½ä»¤å¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("flink savepoint "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("savepointPath"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("jobId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("ä½¿ç”¨Savepointæ¢å¤ä½œä¸šï¼š")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("flink run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("savepointPath"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("jobJarPath"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("div",{staticClass:"custom-block right"},[s("p",[t._v("Savepointæ˜¯Flinkç”Ÿäº§ç¯å¢ƒä¸­çš„å¿…å¤‡å·¥å…·ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿›è¡Œåº”ç”¨å‡çº§æˆ–è¿ç§»æ—¶ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"é«˜çº§çŠ¶æ€ç®¡ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é«˜çº§çŠ¶æ€ç®¡ç†"}},[t._v("#")]),t._v(" é«˜çº§çŠ¶æ€ç®¡ç†")]),t._v(" "),s("h3",{attrs:{id:"çŠ¶æ€ttl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çŠ¶æ€ttl"}},[t._v("#")]),t._v(" çŠ¶æ€TTL")]),t._v(" "),s("p",[s("strong",[t._v("çŠ¶æ€TTL")]),t._v("ï¼ˆTime-To-Liveï¼‰å…è®¸æˆ‘ä»¬ä¸ºçŠ¶æ€è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè‡ªåŠ¨æ¸…ç†è¿‡æœŸçŠ¶æ€ï¼Œè¿™å¯¹äºèŠ‚çœå­˜å‚¨ç©ºé—´å’Œæé«˜æ€§èƒ½éå¸¸é‡è¦ã€‚")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StateTtlConfig")]),t._v(" ttlConfig "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StateTtlConfig")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("newBuilder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Time")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hours")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setUpdateType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StateTtlConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UpdateType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OnCreateAndWrite")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setStateVisibility")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StateTtlConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StateVisibility"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NeverReturnExpired")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cleanupInRocksdbCompactFilter")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ValueStateDescriptor")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" stateDescriptor "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ValueStateDescriptor")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myState"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nstateDescriptor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("enableTimeToLive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ttlConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("h3",{attrs:{id:"çŠ¶æ€åºåˆ—åŒ–"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#çŠ¶æ€åºåˆ—åŒ–"}},[t._v("#")]),t._v(" çŠ¶æ€åºåˆ—åŒ–")]),t._v(" "),s("p",[t._v("Flinkæä¾›äº†å¤šç§çŠ¶æ€åºåˆ—åŒ–æ–¹å¼ï¼ŒåŒ…æ‹¬ï¼š")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("TypeSerializer")]),t._v(" - é€‚ç”¨äºè‡ªå®šä¹‰ç±»å‹")]),t._v(" "),s("li",[s("strong",[t._v("Kryo")]),t._v(" - é«˜æ€§èƒ½çš„åºåˆ—åŒ–æ¡†æ¶")]),t._v(" "),s("li",[s("strong",[t._v("Avro")]),t._v(" - æ”¯æŒæ¨¡å¼æ¼”è¿›çš„åºåˆ—åŒ–æ ¼å¼")])]),t._v(" "),s("p",[t._v("ä¼˜åŒ–çŠ¶æ€åºåˆ—åŒ–å¯ä»¥æ˜¾è‘—æé«˜åº”ç”¨çš„æ€§èƒ½ï¼š")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä½¿ç”¨è‡ªå®šä¹‰åºåˆ—åŒ–å™¨")]),t._v("\nenv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addDefaultKryoSerializer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyCustomType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyCustomSerializer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç¦ç”¨Kryoçš„å¼•ç”¨è·Ÿè¸ªï¼Œæé«˜æ€§èƒ½")]),t._v("\nenv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("disableGenericTypes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("h2",{attrs:{id:"å®¹é”™æœ€ä½³å®è·µ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®¹é”™æœ€ä½³å®è·µ"}},[t._v("#")]),t._v(" å®¹é”™æœ€ä½³å®è·µ")]),t._v(" "),s("h3",{attrs:{id:"checkpointè°ƒä¼˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#checkpointè°ƒä¼˜"}},[t._v("#")]),t._v(" Checkpointè°ƒä¼˜")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("åˆç†è®¾ç½®Checkpointé—´éš”")]),t._v(" - å¤ªé¢‘ç¹ä¼šå½±å“æ€§èƒ½ï¼Œå¤ªç¨€ç–ä¼šå¢åŠ æ¢å¤æ—¶é—´")]),t._v(" "),s("li",[s("strong",[t._v("é€‰æ‹©åˆé€‚çš„çŠ¶æ€åç«¯")]),t._v(" - æ ¹æ®çŠ¶æ€å¤§å°å’Œæ€§èƒ½è¦æ±‚é€‰æ‹©")]),t._v(" "),s("li",[s("strong",[t._v("ä¼˜åŒ–çŠ¶æ€è®¿é—®æ¨¡å¼")]),t._v(" - å‡å°‘éšæœºè®¿é—®ï¼Œå¢åŠ é¡ºåºè®¿é—®")]),t._v(" "),s("li",[s("strong",[t._v("ç›‘æ§Checkpointæ€§èƒ½")]),t._v(" - ä½¿ç”¨Flinkçš„ç›‘æ§å·¥å…·æ£€æŸ¥Checkpointå¤§å°å’Œè€—æ—¶")])]),t._v(" "),s("h3",{attrs:{id:"å®¹é”™ç­–ç•¥é€‰æ‹©"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®¹é”™ç­–ç•¥é€‰æ‹©"}},[t._v("#")]),t._v(" å®¹é”™ç­–ç•¥é€‰æ‹©")]),t._v(" "),s("p",[t._v("æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„å®¹é”™ç­–ç•¥ï¼š")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("å®¹é”™ç­–ç•¥")]),t._v(" "),s("th",[t._v("è¯­ä¹‰ä¿è¯")]),t._v(" "),s("th",[t._v("æ€§èƒ½å½±å“")]),t._v(" "),s("th",[t._v("é€‚ç”¨åœºæ™¯")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("AT_LEAST_ONCE")]),t._v(" "),s("td",[t._v("è‡³å°‘ä¸€æ¬¡")]),t._v(" "),s("td",[t._v("ä½")]),t._v(" "),s("td",[t._v("å¯ä»¥å®¹å¿é‡å¤æ•°æ®")])]),t._v(" "),s("tr",[s("td",[t._v("EXACTLY_ONCE")]),t._v(" "),s("td",[t._v("ç²¾ç¡®ä¸€æ¬¡")]),t._v(" "),s("td",[t._v("ä¸­")]),t._v(" "),s("td",[t._v("é‡‘èäº¤æ˜“ç­‰å…³é”®ä¸šåŠ¡")])]),t._v(" "),s("tr",[s("td",[t._v("AT_MOST_ONCE")]),t._v(" "),s("td",[t._v("æœ€å¤šä¸€æ¬¡")]),t._v(" "),s("td",[t._v("é«˜")]),t._v(" "),s("td",[t._v("å¯ä»¥å®¹å¿æ•°æ®ä¸¢å¤±")])])])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("æç¤º")]),t._v(" "),s("p",[t._v("åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒEXACTLY_ONCEè¯­ä¹‰æ˜¯æœ€å¸¸ç”¨çš„ï¼Œä½†éœ€è¦æƒè¡¡æ€§èƒ½å¼€é”€ã€‚Flink 1.12+ç‰ˆæœ¬ä¸­ï¼ŒEXACTLY_ONCEå·²ç»æˆä¸ºé»˜è®¤è®¾ç½®ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"ç»“è¯­"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç»“è¯­"}},[t._v("#")]),t._v(" ç»“è¯­")]),t._v(" "),s("p",[t._v("ä»Šå¤©æˆ‘ä»¬ä¸€èµ·æ·±å…¥æ¢è®¨äº†Flinkçš„çŠ¶æ€ç®¡ç†ä¸å®¹é”™æœºåˆ¶ï¼Œè¿™æ˜¯Flinkèƒ½å¤Ÿæä¾›å¯é æµå¤„ç†æœåŠ¡çš„æ ¸å¿ƒã€‚ä»åŸºæœ¬çš„Stateæ¦‚å¿µåˆ°é«˜çº§çš„Checkpointå’ŒSavepointæœºåˆ¶ï¼Œå†åˆ°å®é™…åº”ç”¨ä¸­çš„æœ€ä½³å®è·µï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨Flinkçš„å®¹é”™ç‰¹æ€§ã€‚")]),t._v(" "),s("p",[t._v("åœ¨æœªæ¥çš„æ–‡ç« ä¸­ï¼Œæˆ‘è®¡åˆ’ç»§ç»­æ¢è®¨Flinkä¸å…¶ä»–ç³»ç»Ÿçš„é›†æˆï¼Œç‰¹åˆ«æ˜¯ä¸Kafkaçš„æ·±åº¦é›†æˆï¼Œä»¥åŠå¦‚ä½•åœ¨çœŸå®ç”Ÿäº§ç¯å¢ƒä¸­éƒ¨ç½²å’Œè¿ç»´Flinkåº”ç”¨ã€‚å¦‚æœä½ å¯¹Flinkçš„ä»»ä½•æ–¹é¢æ„Ÿå…´è¶£ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘ä¼šæ ¹æ®å¤§å®¶çš„åé¦ˆè°ƒæ•´åç»­çš„æ–‡ç« å†…å®¹ã€‚")]),t._v(" "),s("blockquote",[s("p",[t._v("è®°ä½ï¼Œæ²¡æœ‰å®¹é”™æœºåˆ¶çš„æµå¤„ç†ç³»ç»Ÿå°±åƒæ²¡æœ‰åˆ¹è½¦çš„èµ›è½¦â€”â€”çœ‹èµ·æ¥å¾ˆé…·ï¼Œä½†ä¸€æ—¦å‡ºé—®é¢˜å°±ä¼šé€ æˆç¾éš¾æ€§çš„åæœã€‚é€‰æ‹©åˆé€‚çš„å®¹é”™ç­–ç•¥ï¼Œè®©ä½ çš„æµå¤„ç†åº”ç”¨æ—¢é«˜æ•ˆåˆå¯é ï¼")])]),t._v(" "),s("p",[t._v("Happy Flinking! ğŸš€")])])}),[],!1,null,null,null);s.default=e.exports}}]);