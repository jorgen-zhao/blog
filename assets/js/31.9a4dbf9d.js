(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{383:function(s,t,a){"use strict";a.r(t);var n=a(15),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("ğŸš€ Flink + ClickHouseï¼šç‰©è”ç½‘å®æ—¶æ•°æ®å¤„ç†çš„é»„é‡‘æ­æ¡£")]),s._v(" "),t("h2",{attrs:{id:"ğŸŒŸ-èƒŒæ™¯ä»‹ç»"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸŒŸ-èƒŒæ™¯ä»‹ç»"}},[s._v("#")]),s._v(" ğŸŒŸ èƒŒæ™¯ä»‹ç»")]),s._v(" "),t("p",[s._v("åœ¨ç‰©è”ç½‘ï¼ˆIoTï¼‰é¢†åŸŸï¼Œè®¾å¤‡æ•°æ®æºæºä¸æ–­åœ°äº§ç”Ÿï¼Œæ•°æ®é‡å¤§ã€æ—¶æ•ˆæ€§é«˜ï¼Œå¦‚ä½•é«˜æ•ˆå¤„ç†ã€å­˜å‚¨å¹¶å¿«é€ŸæŸ¥è¯¢ï¼Œæˆäº†æ¯ä¸ªæŠ€æœ¯å›¢é˜Ÿå¿…é¡»é¢å¯¹çš„é—®é¢˜ã€‚ğŸ’¡")]),s._v(" "),t("p",[s._v("åœ¨è¿™ç‰‡æ•°æ®çš„æµ·æ´‹é‡Œï¼Œæˆ‘ä»¬æ‰¾åˆ°äº† Flink + ClickHouse è¿™å¯¹é»„é‡‘æ­æ¡£ï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Apache Flink")]),s._v("ï¼šæµå¤„ç†ç¥å™¨ï¼Œèƒ½å®æ—¶è®¡ç®—ã€å¤„ç†å¤æ‚äº‹ä»¶ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("ClickHouse")]),s._v("ï¼šé«˜æ€§èƒ½åˆ—å¼æ•°æ®åº“ï¼Œé€‚åˆé«˜ååã€å®æ—¶æŸ¥è¯¢ã€‚")])]),s._v(" "),t("p",[s._v("Flink è´Ÿè´£æ•°æ®æµå¼å¤„ç†ï¼ŒClickHouse è´Ÿè´£é«˜æ•ˆå­˜å‚¨å’ŒæŸ¥è¯¢ã€‚ä¸¤è€…ç»“åˆï¼Œèƒ½è®© IoT æ•°æ®å¤„ç†æ›´ä¸æ»‘ã€æ›´é«˜æ•ˆï¼ğŸ¯")]),s._v(" "),t("hr"),s._v(" "),t("h2",{attrs:{id:"ğŸ”-flink-clickhouse-å„è‡ªçš„ç‰¹ç‚¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”-flink-clickhouse-å„è‡ªçš„ç‰¹ç‚¹"}},[s._v("#")]),s._v(" ğŸ” Flink & ClickHouse å„è‡ªçš„ç‰¹ç‚¹")]),s._v(" "),t("h3",{attrs:{id:"ğŸŒŠ-apache-flink-å®æ—¶æµå¤„ç†å¼•æ“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸŒŠ-apache-flink-å®æ—¶æµå¤„ç†å¼•æ“"}},[s._v("#")]),s._v(" ğŸŒŠ Apache Flinkï¼šå®æ—¶æµå¤„ç†å¼•æ“")]),s._v(" "),t("p",[s._v("Flink æ˜¯ä¸€æ¬¾åˆ†å¸ƒå¼æµå¤„ç†æ¡†æ¶ï¼Œä¸“æ³¨äºä½å»¶è¿Ÿã€é«˜ååçš„æµå¼è®¡ç®—ã€‚å®ƒçš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("Exactly-once è¯­ä¹‰")]),s._v("ï¼šä¿è¯æ•°æ®ä¸ä¼šé‡å¤å¤„ç†ï¼Œä¹Ÿä¸ä¼šä¸¢å¤±ã€‚")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("äº‹ä»¶æ—¶é—´ï¼ˆEvent Timeï¼‰æ”¯æŒ")]),s._v("ï¼šå¯ä»¥åŸºäºäº‹ä»¶çš„å‘ç”Ÿæ—¶é—´è€Œä¸æ˜¯ç³»ç»Ÿæ—¶é—´è¿›è¡Œè®¡ç®—ã€‚")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("å¼ºå¤§çš„çª—å£æœºåˆ¶")]),s._v("ï¼šæ”¯æŒæ»šåŠ¨çª—å£ã€æ»‘åŠ¨çª—å£ã€ä¼šè¯çª—å£ç­‰ï¼Œé€‚ç”¨äºå„ç§åœºæ™¯ã€‚")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("çŠ¶æ€ç®¡ç†")]),s._v("ï¼šé«˜æ•ˆçš„çŠ¶æ€å­˜å‚¨å’Œæ¢å¤ï¼Œé€‚åˆå¤„ç†æœ‰çŠ¶æ€çš„æµè®¡ç®—ã€‚")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("ä¸°å¯Œçš„è¿æ¥å™¨")]),s._v("ï¼šæ”¯æŒ Kafkaã€MySQLã€ClickHouseã€Elasticsearch ç­‰å¤šç§æ•°æ®æºå’Œç›®æ ‡ã€‚")]),s._v(" "),t("p",[s._v("ç›¸æ¯”äº "),t("strong",[s._v("Spark Streaming")]),s._v("ï¼ŒFlink å¤„ç†çœŸæ­£çš„æµæ•°æ®ï¼Œè€Œ Spark Streaming é‡‡ç”¨å¾®æ‰¹ï¼ˆMicro-Batchï¼‰æ¨¡å¼ï¼Œå»¶è¿Ÿè¾ƒé«˜ã€‚")]),s._v(" "),t("hr"),s._v(" "),t("h3",{attrs:{id:"ğŸ†-clickhouse-é«˜æ€§èƒ½åˆ—å¼æ•°æ®åº“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ†-clickhouse-é«˜æ€§èƒ½åˆ—å¼æ•°æ®åº“"}},[s._v("#")]),s._v(" ğŸ† ClickHouseï¼šé«˜æ€§èƒ½åˆ—å¼æ•°æ®åº“")]),s._v(" "),t("p",[s._v("ClickHouse æ˜¯ä¸€æ¬¾ä¸“ä¸º"),t("strong",[s._v("OLAP")]),s._v("ï¼ˆåœ¨çº¿åˆ†æå¤„ç†ï¼‰ä¼˜åŒ–çš„åˆ—å¼å­˜å‚¨æ•°æ®åº“ï¼Œå…·å¤‡ä»¥ä¸‹ä¼˜åŠ¿ï¼š")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("åˆ—å¼å­˜å‚¨")]),s._v("ï¼šæ•°æ®æŒ‰åˆ—å­˜å‚¨ï¼ŒæŸ¥è¯¢æ—¶åªè¯»å–ç›¸å…³åˆ—ï¼Œå¤§å¹…å‡å°‘ IOã€‚")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("æè‡´å‹ç¼©")]),s._v("ï¼šæ”¯æŒå¤šç§é«˜æ•ˆå‹ç¼©ç®—æ³•ï¼Œæ•°æ®å ç”¨æ›´å°‘å­˜å‚¨ç©ºé—´ã€‚")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("MergeTree å¼•æ“")]),s._v("ï¼šæ”¯æŒè‡ªåŠ¨æ•°æ®åˆå¹¶ã€åˆ†åŒºã€ç´¢å¼•ä¼˜åŒ–ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("é«˜å¹¶å‘æŸ¥è¯¢")]),s._v("ï¼šé€‚åˆå¤§è§„æ¨¡æ•°æ®åˆ†æï¼ŒæŸ¥è¯¢é€Ÿåº¦è¿œè¶…ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“ã€‚")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("åˆ†å¸ƒå¼æ¶æ„")]),s._v("ï¼šå¯ä»¥æ¨ªå‘æ‰©å±•ï¼Œé€‚ç”¨äº PB çº§æ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢ã€‚")]),s._v(" "),t("p",[s._v("ä¸ "),t("strong",[s._v("Elasticsearch")]),s._v(" ç›¸æ¯”ï¼ŒClickHouse åœ¨ç»“æ„åŒ–æ•°æ®åˆ†æä¸Šæ›´å¿«ï¼Œé€‚ç”¨äº BI å’ŒæŠ¥è¡¨æŸ¥è¯¢ï¼Œè€Œ Elasticsearch æ›´æ“…é•¿å…¨æ–‡æœç´¢å’Œéç»“æ„åŒ–æ•°æ®åˆ†æã€‚")]),s._v(" "),t("hr"),s._v(" "),t("h2",{attrs:{id:"ğŸ’¡-ä¸ºä»€ä¹ˆåœ¨ç‰©è”ç½‘é¢†åŸŸé€‚ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ’¡-ä¸ºä»€ä¹ˆåœ¨ç‰©è”ç½‘é¢†åŸŸé€‚ç”¨"}},[s._v("#")]),s._v(" ğŸ’¡ ä¸ºä»€ä¹ˆåœ¨ç‰©è”ç½‘é¢†åŸŸé€‚ç”¨ï¼Ÿ")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("æ•°æ®é‡å¤§")]),s._v("ï¼šæˆåƒä¸Šä¸‡å°è®¾å¤‡ï¼Œæ¯ç§’æˆç™¾ä¸Šåƒæ¡æ•°æ®ï¼Œä¼ ç»Ÿæ¶æ„æ‰›ä¸ä½ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("æ•°æ®æ—¶æ•ˆæ€§è¦æ±‚é«˜")]),s._v("ï¼šè®¾å¤‡çŠ¶æ€ã€å¼‚å¸¸æŠ¥è­¦ã€ä¼ æ„Ÿå™¨æ•°æ®ï¼Œå¿…é¡»å®æ—¶å¤„ç†ï¼Œä¸èƒ½ç­‰ï¼â³")]),s._v(" "),t("li",[t("strong",[s._v("æ•°æ®æŸ¥è¯¢éœ€æ±‚å¤æ‚")]),s._v("ï¼šæ—¢è¦æ”¯æŒå®æ—¶æµå¼è®¡ç®—ï¼ˆFlinkï¼‰ï¼Œä¹Ÿè¦æ”¯æŒå†å²æ•°æ®åˆ†æï¼ˆClickHouseï¼‰ã€‚")])]),s._v(" "),t("p",[s._v("Flink å¤„ç†å®æ—¶æ•°æ®æµï¼ŒClickHouse è¿›è¡Œ OLAP åˆ†æï¼Œå®Œç¾é€‚é… IoT ä¸šåŠ¡éœ€æ±‚ï¼ğŸ¯")]),s._v(" "),t("hr"),s._v(" "),t("h2",{attrs:{id:"âš™ï¸-å®ç°ç»†èŠ‚"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#âš™ï¸-å®ç°ç»†èŠ‚"}},[s._v("#")]),s._v(" âš™ï¸ å®ç°ç»†èŠ‚")]),s._v(" "),t("p",[s._v("æˆ‘ä»¬æ¥æ‹†è§£ä¸€ä¸ªå…¸å‹çš„æ•°æ®å¤„ç†æµç¨‹ï¼š")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("æ•°æ®æº")]),s._v("ï¼ˆIoT è®¾å¤‡ï¼‰ğŸ‘‰ MQTT / Kafka é‡‡é›†æ•°æ®")]),s._v(" "),t("li",[t("strong",[s._v("Flink å¤„ç†")]),s._v("ï¼š\n"),t("ul",[t("li",[s._v("æ•°æ®æ¸…æ´—ï¼ˆå»é‡ã€æ ¼å¼åŒ–ã€å¼‚å¸¸å¤„ç†ï¼‰")]),s._v(" "),t("li",[s._v("è®¡ç®—èšåˆï¼ˆè®¾å¤‡çŠ¶æ€ã€æµé‡ç»Ÿè®¡ã€å‘Šè­¦æ£€æµ‹ï¼‰")])])]),s._v(" "),t("li",[t("strong",[s._v("å†™å…¥ ClickHouse")]),s._v("ï¼š\n"),t("ul",[t("li",[s._v("é‡‡ç”¨ "),t("strong",[t("code",[s._v("MergeTree")])]),s._v(" è¡¨å¼•æ“ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡")]),s._v(" "),t("li",[s._v("åˆ©ç”¨ "),t("strong",[t("code",[s._v("Materialized View")])]),s._v(" é¢„è®¡ç®—ï¼Œæé«˜å“åº”é€Ÿåº¦")])])]),s._v(" "),t("li",[t("strong",[s._v("æ•°æ®æŸ¥è¯¢ & å¯è§†åŒ–")]),s._v("ï¼š\n"),t("ul",[t("li",[s._v("Grafana / Superset ç›´æ¥æŸ¥è¯¢ ClickHouseï¼Œå®æ—¶å±•ç¤ºè®¾å¤‡çŠ¶æ€ğŸ“Š")])])])]),s._v(" "),t("p",[s._v("æ¶æ„ç¤ºæ„å›¾ï¼š")]),s._v(" "),t("div",{staticClass:"language-plaintext line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-plaintext"}},[t("code",[s._v("   +-------------+      +----------+      +-------------+      +------------+\n   |  IoT è®¾å¤‡   | ---\x3e |    MQ    | ---\x3e |   Flink     | ---\x3e | ClickHouse |\n   +-------------+      +----------+      +-------------+      +------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("ğŸ“Š "),t("strong",[s._v("å®æµ‹æ•°æ®")]),s._v("ï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("50å°æœºå™¨äºº")]),s._v("ï¼Œæ¯ç§’"),t("strong",[s._v("60æ¡")]),s._v("æ•°æ®ä¸ŠæŠ¥")]),s._v(" "),t("li",[t("strong",[s._v("å­˜é‡æ•°æ®")]),s._v("çº¦"),t("strong",[s._v("2GB")]),s._v("ï¼Œå¤§çº¦"),t("strong",[s._v("4äº¿")]),s._v("æ¡")]),s._v(" "),t("li",[s._v("æ¯æ¡æ¶ˆæ¯"),t("strong",[s._v("0.5KB")]),s._v("ï¼Œ10åˆ†é’Ÿåèƒ½è¿½ä¸Šæ¶ˆè´¹é€Ÿåº¦")]),s._v(" "),t("li",[t("strong",[s._v("ClickHouse å¼€å¯å‹ç¼©åï¼Œç£ç›˜ä½¿ç”¨æ¯”æ¶ˆæ¯é˜Ÿåˆ—å‡å°‘ 3/4")])]),s._v(" "),t("li",[t("strong",[s._v("ClickHouse ç»“åˆ S3")]),s._v("ï¼Œå¯è¿›ä¸€æ­¥ä¼˜åŒ–å­˜å‚¨ï¼Œå‡å°‘ç£ç›˜å ç”¨ï¼Œé™ä½æˆæœ¬ ğŸ’°")])]),s._v(" "),t("hr"),s._v(" "),t("h2",{attrs:{id:"âš ï¸-flink-clickhouse-ç»“åˆçš„æ³¨æ„äº‹é¡¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#âš ï¸-flink-clickhouse-ç»“åˆçš„æ³¨æ„äº‹é¡¹"}},[s._v("#")]),s._v(" âš ï¸ Flink + ClickHouse ç»“åˆçš„æ³¨æ„äº‹é¡¹")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("æ‰¹é‡å†™å…¥ ClickHouse")]),s._v("ï¼šé¿å…å•æ¡æ’å…¥ï¼Œä½¿ç”¨ "),t("code",[s._v("max_insert_block_size")]),s._v(" è°ƒä¼˜ã€‚")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("æ•°æ®åˆ†åŒºç­–ç•¥")]),s._v("ï¼šåˆç†é€‰æ‹©åˆ†åŒºé”®ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½ã€‚")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("æ•°æ®èšåˆ")]),s._v("ï¼šä½¿ç”¨ ClickHouse "),t("code",[s._v("Materialized View")]),s._v(" é¢„è®¡ç®—ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("Flink Checkpoint")]),s._v("ï¼šç¡®ä¿æ•°æ®å¤„ç†çš„å¯é æ€§ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚")]),s._v(" "),t("p",[s._v("âœ… "),t("strong",[s._v("ClickHouse è¿æ¥æ± ")]),s._v("ï¼šä¼˜åŒ– "),t("code",[s._v("jdbc:clickhouse")]),s._v(" è¿æ¥æ± ï¼Œæé«˜ååé‡ã€‚")]),s._v(" "),t("hr"),s._v(" "),t("h2",{attrs:{id:"âœï¸-ç¤ºä¾‹ä»£ç "}},[t("a",{staticClass:"header-anchor",attrs:{href:"#âœï¸-ç¤ºä¾‹ä»£ç "}},[s._v("#")]),s._v(" âœï¸ ç¤ºä¾‹ä»£ç ")]),s._v(" "),t("h3",{attrs:{id:"_1ï¸âƒ£-flink-æ¶ˆè´¹-kafka-å¹¶å†™å…¥-clickhouse"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1ï¸âƒ£-flink-æ¶ˆè´¹-kafka-å¹¶å†™å…¥-clickhouse"}},[s._v("#")]),s._v(" 1ï¸âƒ£ Flink æ¶ˆè´¹ Kafka å¹¶å†™å…¥ ClickHouse")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")]),s._v(" env "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getExecutionEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),s._v(" props "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nprops"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setProperty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bootstrap.servers"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kafka-broker:9092"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nprops"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setProperty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"group.id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"flink-iot-group"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FlinkKafkaConsumer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" consumer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FlinkKafkaConsumer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"iot_topic"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SimpleStringSchema")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataStream")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" stream "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addSource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataStream")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IoTData")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" parsedStream "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" stream"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("map")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("json "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("parseIoTData")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("json"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nparsedStream"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addSink")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ClickHouseSink")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jdbc:clickhouse://clickhouse-server:8123/iot_db"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nenv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("execute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IoT Flink to ClickHouse"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h3",{attrs:{id:"_2ï¸âƒ£-clickhouse-è¡¨ç»“æ„"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2ï¸âƒ£-clickhouse-è¡¨ç»“æ„"}},[s._v("#")]),s._v(" 2ï¸âƒ£ ClickHouse è¡¨ç»“æ„")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" iot_data "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    device_id String"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    temperature Float32"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    humidity Float32"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("timestamp")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DateTime")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENGINE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" MergeTree"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("device_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("timestamp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"ğŸ˜†-é²è¿…æ›¾è¯´"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ˜†-é²è¿…æ›¾è¯´"}},[s._v("#")]),s._v(" ğŸ˜† é²è¿…æ›¾è¯´......")]),s._v(" "),t("blockquote",[t("p",[s._v('"æ•°æ®å¦‚æµæ°´ï¼Œå¤„ç†éœ€åŠæ—¶ã€‚"')])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/jorgen-zhao/picGo/blog/luxun.jpg",alt:"luxun"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);