(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{372:function(s,a,n){"use strict";n.r(a);var e=n(15),t=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("原则")]),s._v(" "),a("p",[s._v("金鳞岂是池中物，一遇风云变化龙。")])]),s._v(" "),a("h2",{attrs:{id:"背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[s._v("#")]),s._v(" 背景")]),s._v(" "),a("p",[s._v("企业级应用，特别是在现代开发的背景下。服务上云是最终的选择。")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("更轻松的设置和更好的安全性")]),s._v(" "),a("ul",[a("li",[s._v("更好地控制您的数据和带宽，以满足您的安全需求")]),s._v(" "),a("li",[s._v("利用云服务提供商的专业技术和协议，保护您的数据免受攻击和丢失")]),s._v(" "),a("li",[s._v("根据您所在行业的法律和规范，构建符合合规性的云平台")])])]),s._v(" "),a("li",[a("p",[s._v("减少许可和IT成本")]),s._v(" "),a("ul",[a("li",[s._v("选择专业品牌的云服务商，利用其优惠的价格和质量的服务，避免购买和维护昂贵的硬件和软件")]),s._v(" "),a("li",[s._v("根据业务需求，灵活调整云服务器的配置和数量，避免浪费资源和资金")]),s._v(" "),a("li",[s._v("关注存储利用率和配置，选择适合当前使用情况的存储类别，节省存储费用")])])]),s._v(" "),a("li",[a("p",[s._v("有效的远程工作能力")]),s._v(" "),a("ul",[a("li",[s._v("系统扩展：云服务可以根据远程工作的需求，快速地增加或减少资源，无需安装或升级硬件设备")]),s._v(" "),a("li",[s._v("改进可访问性：云服务可以让远程工作人员随时随地地访问和管理数据，同时保证数据的安全性和权限控制")]),s._v(" "),a("li",[s._v("提供无缝的移动性：云服务可以让远程工作人员通过不同的设备和网络，方便地访问和共享文件")]),s._v(" "),a("li",[s._v("更好的协作：云服务可以让远程工作人员利用多种云存储和协作工具，在同一文档上进行实时的编辑和评论")])])])]),s._v(" "),a("h2",{attrs:{id:"资源规划"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#资源规划"}},[s._v("#")]),s._v(" 资源规划")]),s._v(" "),a("blockquote",[a("p",[s._v("以我开源的"),a("a",{attrs:{href:"https://github.com/jorgen-zhao/lite_iot",target:"_blank",rel:"noopener noreferrer"}},[s._v("lite_iot"),a("OutboundLink")],1),s._v("为例，配合介绍一下资源的配置")])]),s._v(" "),a("p",[a("strong",[s._v("中间件")]),s._v("：zookeeper, kafka，MongoDB（"),a("a",{attrs:{href:"https://blog.51cto.com/onlyzq/557598",target:"_blank",rel:"noopener noreferrer"}},[s._v("auto-sharding"),a("OutboundLink")],1),s._v("），Redis（主从复制），MySQL，Nginx（web代理、TCP代理）")]),s._v(" "),a("p",[a("strong",[s._v("服务")]),s._v("：hub(2), admin, gateway, proxy（3）, pusher(api, ws), report，wx，monitor，nacos，sentinel")]),s._v(" "),a("p",[a("strong",[s._v("监控")]),s._v("：graylog, grafana，node_echarts, TDengine")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("服务器编号")]),s._v(" "),a("th",[s._v("软件")]),s._v(" "),a("th",[s._v("服务")]),s._v(" "),a("th",[s._v("监控")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("1")]),s._v(" "),a("td",[a("code",[s._v("Redis")]),s._v(" "),a("code",[s._v("mysql")])]),s._v(" "),a("td",[a("code",[s._v("hub")]),s._v(" "),a("code",[s._v("wx")]),s._v(" "),a("code",[s._v("node_echart")])]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("2")]),s._v(" "),a("td",[a("code",[s._v("kafka")]),s._v(" "),a("code",[s._v("nacos")])]),s._v(" "),a("td",[a("code",[s._v("hub")]),s._v(" "),a("code",[s._v("admin")]),s._v(" "),a("code",[s._v("pusher")])]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("3")]),s._v(" "),a("td",[a("code",[s._v("Redis")]),s._v(" "),a("code",[s._v("nacos")])]),s._v(" "),a("td",[a("code",[s._v("proxy")]),s._v(" "),a("code",[s._v("monitor")]),s._v(" "),a("code",[s._v("report")])]),s._v(" "),a("td",[a("code",[s._v("graylog")])])]),s._v(" "),a("tr",[a("td",[s._v("4")]),s._v(" "),a("td",[a("code",[s._v("Redis")]),s._v(" "),a("code",[s._v("nginx")]),s._v(" "),a("code",[s._v("nacos")])]),s._v(" "),a("td",[a("code",[s._v("proxy")]),s._v(" "),a("code",[s._v("gateway")]),s._v(" "),a("code",[s._v("TDengine")])]),s._v(" "),a("td",[a("code",[s._v("grafana")])])]),s._v(" "),a("tr",[a("td",[s._v("5")]),s._v(" "),a("td",[a("code",[s._v("mongodb")])]),s._v(" "),a("td",[a("code",[s._v("proxy")])]),s._v(" "),a("td")])])]),s._v(" "),a("h2",{attrs:{id:"软件部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#软件部分"}},[s._v("#")]),s._v(" 软件部分")]),s._v(" "),a("h3",{attrs:{id:"mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql"}},[s._v("#")]),s._v(" MySQL")]),s._v(" "),a("ul",[a("li",[s._v("上传安装包，解压到"),a("code",[s._v("/usr/local/mysql")])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-zxvf")]),s._v(" xxx "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" /usr/local/mysql/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("创建mysql用户组和mysql用户，并且在解压目录创建data和log目录，对mysql目录读写授权，并改变所属组和所有人")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" data\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" log\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" mysql\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-g")]),s._v(" mysql mysql\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" mysql/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" mysql:mysql mysql\n- 修改配置文件内容\n先删除原来的/etc/my.cnf\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/my.cnf\n//配置如下：\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置mysql客户端默认字符集")]),s._v("\ndefault-character-set"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8mb4\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置客户端socket")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("socket")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/mysql/mysql.sock\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove leading # and set to the amount of RAM for the most important data")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# innodb_buffer_pool_size = 128M")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove leading # to turn on a very important data integrity option: logging")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# changes to the binary log between backups.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log_bin")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove leading # to set options mainly useful for reporting servers.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The server defaults are faster for transactions and fast SELECTs.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Adjust sizes as needed, experiment to find the optimal values.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# join_buffer_size = 128M")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sort_buffer_size = 2M")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# read_rnd_buffer_size = 2M")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 忽略主机名解析")]),s._v("\nskip-name-resolve"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置端口")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置mysql安装目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("basedir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql/\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置数据存放目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("datadir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/mysqlfile\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置socket")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("socket")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/mysql/mysql.sock\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许最大连接数，如果经常出现Too Many Connection异常，修改此配置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("max_connections")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务端使用的字符集")]),s._v("\ncharacter-set-server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8mb4\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建新表时使用的默认存储引擎")]),s._v("\ndefault-storage-engine"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("INNODB\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 忽略大小写")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("lower_case_table_names")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("max_allowed_packet")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("16M\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置sql_mode")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sql_mode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置日志")]),s._v("\nlog-error"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/log/mysql-error.log\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置开启慢查询")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("slow_query_log")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置慢查询记录时间")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("long_query_time")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置慢查询日志")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("slow_query_log_file")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/log/mysql-slow.log\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置mysql日志记录时间")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("log_timestamps")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("SYSTEM\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置pid目录,不要放在/var/run下，因为run是运行在内存中，重启后会丢失")]),s._v("\npid-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/mysql/mysqld.pid\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改关于timestamp字段的设置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("explicit_defaults_for_timestamp")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Disabling symbolic-links is recommended to prevent assorted security risks")]),s._v("\nsymbolic-links"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置数据同步（信阳去掉以下配置）")]),s._v("\nlog-bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql-bin\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同一集群中的机器不能相同")]),s._v("\nserver-id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("log_slave_updates")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_format")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mixed\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("max_binlog_size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("512M\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#需要同步的表  根据项目实际情况改库")]),s._v("\nbinlog-do-db"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bda09\nbinlog-do-db"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("seata\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不需要同步的表")]),s._v("\nbinlog-ignore-db"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql\nbinlog-ignore-db"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("performance_schema\nbinlog-ignore-db"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("information_schema\nbinlog-ignore-db"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sys\n- 初始化mysql\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#初始化前根据配置文件的日志目录创建日志文件，并授权mysql所有人和所属组")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在/var/log下建立log目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /var/log/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" mysql-error.log\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" mysql.mysql mysql-error.log\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" mysql-slow.log\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" mysql.mysql mysql-slow.log\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不存在就创建")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" mysql\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" mysql.mysql mysql/\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#不存在就创建")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" mysqlfile\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" mysql.mysql mysqlfile/\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#初始化，mysql的bin目录下执行")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果初始化失败，去打印错误日志/var/log/mysql-error.log,根据报错处理一般情况下是data目录已存在，日志文件权限不够，socket文件，pid文件无法创建的问题")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#初始化完成后，日志中会显示默认的登录密码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/mysql/bin\n./mysqld --defaults-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/my.cnf "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--basedir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--datadir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/mysqlfile "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--initialize")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br")])]),a("ul",[a("li",[s._v("启动mysql")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("在bin目录下执行启动命令\n./mysqld --user=mysql \n如果提示-secure-file-priv is set to NULL. Operations related to importing and exporting data are disabled，则使用./mysqld --user=root强制启动\n启动后可以看到mysql进程\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("ul",[a("li",[s._v("登录mysql，并修改默认密码")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#添加软连接（可以全局使用mysql命令）\nln -s /usr/local/mysql/bin/mysql /usr/bin/mysql\n#在my.cnf的[mysqld]下增加skip-grant-tables可以跳过密码，配置好密码后需要删除skip-grant-tables（直接利用error.log的密码直接登录可以跳过该步骤）\nmysql -uroot -p\n//直接回车，无需输入密码\nUPDATE user SET authentication_string=PASSWORD('123456') WHERE user='root';\nFLUSH PRIVILEGES;\n\n# 直接利用error.log的密码直接登录或者关闭mysql，再次启动mysql，输入密码123456后会要求立即更改密码\nSET PASSWORD = PASSWORD('123456');\nALTER USER 'root'@'localhost' PASSWORD EXPIRE NEVER;\nFLUSH PRIVILEGES;\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("ul",[a("li",[s._v("设置允许远程登录")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("use mysql                                            #访问mysql库\nupdate user set host = '%' where user = 'root';      #使root能再任何host访问\nFLUSH PRIVILEGES;                                  #刷新\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[s._v("配置mysql环境变量(跳过)")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("vim /etc/profile\n#在最后加上\nexport MYSQL_HOME=/usr/local/mysql\nexport CLASSPATH=.:$JAVA_HOME/lib:$JAVA_HOME/jre/lib\nexport PATH=$PATH:$JAVA_HOME/bin:$MYSQL_HOME/bin\n#保存后执行\nsource /etc/profile  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ul",[a("li",[s._v("把mysql服务交给systemctl管理")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd /etc/systemd/system\nvim mysqld.service\n\n#插入以下内容：\n[Unit]\nDescription=Mysql5.7\nSourcePath=/usr/local/mysql\nBefore=shutdown.target\n\n[Install]\nWantedBy=multi-user.target\n\n[Service]\nUser=mysql\nGroup=mysql\nType=forking\nPIDFile=/home/mysql/mysqld.pid\nExecStart=/usr/local/mysql/bin/mysqld --daemonize --pid-file=/home/mysql/mysqld.pid\nRestart=on-failure\nRestartSec=3\nRestartPreventExitStatus=1\nPrivateTmp=false\n\n#保存退出后，执行以下命令\nsystemctl enable mysqld.service\nsystemctl start mysqld.service\n#查看状态\nsystemctl status mysqld.service\n如果此时不能启动，检查mysql错误日志，一般情况下都是缺少文件，或者某个文件/文件夹没有被mysql访问的权限，根据提示修改。优先检查sock文件所有人，如果是root创建，删掉sock和sock.lock重启mysql，mysql用户即可自己重新创建。\n- 目录位置\n基础目录:/usr/local/mysql\nsocket：/home/mysql/mysql.sock\ndata目录：/home/mysqlfile\nlog目录：/var/log/mysql-error.log\npid：/home/mysql/mysqld.pid\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("h3",{attrs:{id:"redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis"}},[s._v("#")]),s._v(" Redis")]),s._v(" "),a("ul",[a("li",[s._v("解压")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("tar -zxvf redis-5.0.7.tar.gz \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("下载依赖，编译源码")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("yum -y install gcc-c++  //nginx安装过可以忽略\n进入解压后的redis目录执行make,然后把该目录复制到/usr/local,重命名为redis并进入/usr/local/redis\nmake install PREFIX=/usr/local/redis\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[s._v("后台启动redis，设置开机自启动，且加入服务管理")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('mkdir /home/redis/data -p\n//修改配置文件\nvim redis.conf\n//允许守护进程启动\ndaemonize no ->yes\n//允许其他ip连接本reids实例\nbind 127.0.0.1 -> 0.0.0.0\n//设置密码\nrequirepass xxxx\n//设置作为从机时，连接到的主机密码，xxx为主机的登录密码\nmasterauth xxx\n//设置持久化文件存储路径\ndir /home/redis/data\n//设置log日志路径\nlogfile "/usr/local/redis/redis.log"\n//设置开机自启动\n进入/etc/systemd/system\nvim redis-server.service\n添加:\n[Unit]\nDescription=redis-server\nAfter=network.target\n[Service]\nType=forking\nExecStart=/usr/local/redis/bin/redis-server /usr/local/redis/redis.conf\nPrivateTmp=true\n\n[Install]\nWantedBy=multi-user.target\n保存\nservice立即生效\nsystemctl daemon-reload\n设置开机自启动\nsystemctl enable redis-server\nsystemctl daemon-reload\n\n设置redis客户端软链接\nln -s /usr/local/redis/bin/redis-cli /usr/bin/redis\n启动redis\nsystemctl restart redis-server\n连接测试\ncd /usr/local/redis/bin\n./redis-cli -h localhost -p 6379 -a Beidou_2021#shangrao\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br")])]),a("h3",{attrs:{id:"kafka"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kafka"}},[s._v("#")]),s._v(" Kafka")]),s._v(" "),a("ul",[a("li",[s._v("配置server")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('cd /usr/local/kafka/config\n创建kafka_server_jaas.conf配置文件\nvim kafka_server_jaas.conf\n添加如下内容:\nKafkaServer {\n    org.apache.kafka.common.security.plain.PlainLoginModule required\n    username="admin"\n    password="bd#93H-dys"\n    user_admin="bd#93H-dys"\n    user_producer="bdprod_E7*2"\n    user_consumer="bdcons@H2b_5";\n};\n修改server.properties\nvim server.properties\n添加如下内容:\nlisteners=SASL_PLAINTEXT://192.168.1.120:9092\nsecurity.inter.broker.protocol=SASL_PLAINTEXT\nsasl.enabled.mechanisms=PLAIN\nsasl.mechanism.inter.broker.protocol=PLAIN\nauthorizer.class.name=kafka.security.auth.SimpleAclAuthorizer\nallow.everyone.if.no.acl.found=false\nsuper.users=User:admin\n修改如下内容:\nlog.dirs=/usr/local/kafka/dataLog\nzookeeper.connect=192.168.1.120:2181\n\ncd /usr/local/kafka/bin\n修改启动文件\nvim kafka-server-start.sh\n在exec $base_dir/kafka-run-class.sh $EXTRA_ARGS和kafka.Kafka "$@"之间添加 -Djava.security.auth.login.config=/usr/local/kafka/config/kafka_server_jaas.conf\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("ul",[a("li",[s._v("配置客户端\n"),a("ul",[a("li",[s._v("配置producer")])])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('cd /usr/local/kafka/config\n创建生产端配置文件\nvim kafka_client_producer_jaas.conf\n添加如下内容:\nKafkaClient {\n    org.apache.kafka.common.security.plain.PlainLoginModule required\n    username="producer"\n    password="bdprod_E7*2";\n};\n\n修改生产端测试文件\nvim producer.properties\n添加如下内容:\nsecurity.protocol=SASL_PLAINTEXT\nsasl.mechanism=PLAIN\nsasl.jaas.config=org.apache.kafka.common.security.plain.PlainLoginModule required username="producer" password="bdprod_E7*2";\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("ul",[a("li",[s._v("配置consumer")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('cd /usr/local/kafka/config\n创建消费端配置文件\nvim kafka_client_consumer_jaas.conf\n添加如下内容:\nKafkaClient {\n    org.apache.kafka.common.security.plain.PlainLoginModule required\n    username="consumer"\n    password="bdcons@H2b_5";\n};\n\n修改消费端测试文件\nvim consumer.properties\n添加如下内容:\nsecurity.protocol=SASL_PLAINTEXT\nsasl.mechanism=PLAIN\nsasl.jaas.config=org.apache.kafka.common.security.plain.PlainLoginModule required username="consumer" password="bdcons@H2b_5";\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("ul",[a("li",[s._v("zookeeper")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("创建 zoo_jaas.conf\ncd /usr/local/zookeeper/conf\n创建 zoo.cfg配置文件(zookeeper启动时会自动加载该文件)\nvim zoo.cfg\n添加如下内容:\ntickTime=2000\ninitLimit=10\nsyncLimit=5\ndataDir=/usr/local/zookeeper/data\ndataLogDir=/usr/local/zookeeper/dataLog\n#Start Port 默认为8080\nadmin.serverPort=8085\nclientPort=2181\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("ul",[a("li",[s._v("测试")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("添加权限acl\nbin/kafka-acls.sh --authorizer-properties zookeeper.connect=192.168.1.120:2181 --add --allow-principal User:producer --producer --topic quickstart-events\nbin/kafka-acls.sh --authorizer-properties zookeeper.connect=192.168.1.120:2181 --add --allow-principal User:consumer --consumer --topic quickstart-events --group test-consumer-group\n\n生产测试\nbin/kafka-console-producer.sh --bootstrap-server 192.168.1.120:9092 --topic quickstart-events --producer.config config/producer.properties\n\n消费测试\nbin/kafka-console-consumer.sh --bootstrap-server 192.168.1.120:9092 --topic quickstart-events --from-beginning --consumer.config config/consumer.properties\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("ul",[a("li",[s._v("常用命令")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('创建topic\nbin/kafka-topics.sh --create --topic testaaa --bootstrap-server 192.168.1.120:9092\n\n查看topic列表\nbin/kafka-topics.sh --bootstrap-server 192.168.1.120:9092 --command-config config/sasl-consumer.properties --list\n\n查看topic详情(需要使用admin用户身份查看,使用其他身份会报错:ERROR org.apache.kafka.common.errors.TopicAuthorizationException: Topic authorization failed.)\nbin/kafka-topics.sh --bootstrap-server 192.168.1.120:9092 --command-config config/sasl-admin.properties --describe --topic IOT_REQUEST\n\n查看acl列表\nbin/kafka-acls.sh --authorizer-properties zookeeper.connect=192.168.1.120:2181 --list --topic quickstart-events\n\n查看group相关所需配置\nvim sasl-consumer.properties\n添加如下内容:\nsecurity.protocol=SASL_PLAINTEXT\nsasl.mechanism=PLAIN\nsasl.jaas.config=org.apache.kafka.common.security.plain.PlainLoginModule required username="consumer" password="bdcons@H2b_5";\n\n查看group列表命令(出现警告：WARN The configuration \'sasl.jaas.config\' was supplied but isn\'t a known config不用管)\nbin/kafka-consumer-groups.sh --command-config config/sasl-consumer.properties --bootstrap-server 192.168.1.120:9092 --list\n查看指定group\nbin/kafka-consumer-groups.sh --command-config config/sasl-consumer.properties --bootstrap-server 192.168.1.120:9092 --group KAFKA_CONSUMER_GROUP_ID --describe\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h3",{attrs:{id:"jdk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jdk"}},[s._v("#")]),s._v(" JDK")]),s._v(" "),a("ul",[a("li",[s._v("上传jdk安装包")]),s._v(" "),a("li",[s._v("解压到/usr/local/java/目录下")]),s._v(" "),a("li",[s._v("卸载自带的openjdk")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -qa"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" jdk\n卸载已安装的openjdk\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--nodeps")]),s._v(" java-1.8.0-openjdk-1.8.0.181-7.b13.el7.x86_64\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--nodeps")]),s._v(" java-1.8.0-openjdk-headless-1.8.0.181-7.b13.el7.x86_64\n去掉动态jdk /etc/alternatives/java\n安装jdk\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/local/java/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-zxvf")]),s._v(" jdkxxx.tar.gz "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" /usr/local/java\n//解压完后看一下目录，环境变量配置要用到，本例为:/usr/local/java/jdk1.8.0_211 把\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("ul",[a("li",[s._v("设置环境变量")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/profile  //打开环境变量配置文件,在文件末尾添加以下内容\n\n设置jkd环境\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JAVA_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/java\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JRE_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${JAVA_HOME}")]),s._v("/jre\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CLASSPATH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/dt.jar:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/tools.jar:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JRE_HOME")]),s._v("/lib\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" JAVA_HOME JRE_HOME CLASSPATH "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile  //添加完后生效环境变量\n//添加软链接"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("java和javac提示找不到命令时才添加"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /usr/local/java/bin/java /usr/bin/java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("加上为好，因为activemq和seata经常找不到JAVA_HOME"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /usr/local/java/bin/java /etc/alternatives/java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("不一定要加"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-version")]),s._v(" //版本检查\n安装路径 /usr/local/java\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h2",{attrs:{id:"应用程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用程序"}},[s._v("#")]),s._v(" 应用程序")]),s._v(" "),a("p",[s._v("包含该系统需要的编译好的前端程序，以及打包好的后端jar包。")]),s._v(" "),a("h3",{attrs:{id:"后端服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#后端服务"}},[s._v("#")]),s._v(" 后端服务")]),s._v(" "),a("p",[s._v("将系统所有的服务达成jar包。通过XFTP工具上传至云服务器。然后正对每个服务，都配置加入自动启动(注意先后顺序)。最后按照版本命名文件夹，将制定的jar放在制定的版本下。避免紧急情况需要回滚。")]),s._v(" "),a("h3",{attrs:{id:"前端服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前端服务"}},[s._v("#")]),s._v(" 前端服务")]),s._v(" "),a("p",[s._v("通过webpack将打包好的js与静态页面放到指定的文件下。然后编写Nginx中的配置文件。监听指定路由，然后在连接到系统文件即可。")]),s._v(" "),a("h2",{attrs:{id:"安全组"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安全组"}},[s._v("#")]),s._v(" 安全组")]),s._v(" "),a("p",[s._v("云服务器都有个安全组，用来管理访问的客户端。首先在这里将需要的端口打开。其实默认443就是打开的。")]),s._v(" "),a("p",[s._v("使用Nginx搭配申请好的域名，配置好证书。此时就能通过域名访问了。")])])}),[],!1,null,null,null);a.default=t.exports}}]);