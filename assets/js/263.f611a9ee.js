(window.webpackJsonp=window.webpackJsonp||[]).push([[263],{613:function(e,a,t){"use strict";t.r(a);var r=t(15),v=Object(r.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"内存配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内存配置"}},[e._v("#")]),e._v(" 内存配置")]),e._v(" "),a("h3",{attrs:{id:"flink进程内存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flink进程内存"}},[e._v("#")]),e._v(" Flink进程内存")]),e._v(" "),a("blockquote",[a("p",[e._v("配置 Flink 进程内存最简单的方法是指定以下两个配置项中的任意一个：")])]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("配置项")]),e._v(" "),a("th",[e._v("TaskManager配置参数")]),e._v(" "),a("th",[e._v("JobManager配置参数")]),e._v(" "),a("th",[e._v("包含模块")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("Total process memory"),a("br"),e._v(" 进程总内存")]),e._v(" "),a("td",[e._v("taskmanager.memory.process.size")]),e._v(" "),a("td",[e._v("jobmanager.memory.process.size")]),e._v(" "),a("td",[e._v("1. Total Flink memory 2. 运行 Flink 的 JVM 使用的内存")])]),e._v(" "),a("tr",[a("td",[e._v("Total Flink memory"),a("br"),e._v(" Flink总内存")]),e._v(" "),a("td",[e._v("taskmanager.memory.flink.size")]),e._v(" "),a("td",[e._v("jobmanager.memory.flink.size")]),e._v(" "),a("td",[e._v("1. JVM Heap "),a("br"),e._v("2. Off-heap memory "),a("br"),e._v(" 2- 1. Direct "),a("br"),e._v("2- 2. Native")])])])]),e._v(" "),a("blockquote",[a("p",[e._v("不建议同时设置进程总内存（Total process memory）和 Flink 总内存（Total Flink memory）。 这可能会造成内存配置冲突，从而导致部署失败。 额外配置其他内存部分时，同样需要注意可能产生的配置冲突。")])]),e._v(" "),a("p",[e._v("详细参见："),a("a",{attrs:{href:"https://nightlies.apache.org/flink/flink-docs-release-1.15/zh/docs/deployment/memory/mem_setup/",target:"_blank",rel:"noopener noreferrer"}},[e._v("配置 Flink 进程的内存"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("img",{attrs:{src:"/tool/05/202/jobmanager.png",alt:"clash"}})]),e._v(" "),a("h3",{attrs:{id:"jobmanager"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jobmanager"}},[e._v("#")]),e._v(" JobManager")]),e._v(" "),a("blockquote",[a("p",[e._v("如果同时配置了 Flink 总内存（Total Flink Memory）和 JVM 堆内存（JVM Heap），且没有配置堆外内存，那么堆外内存的大小将会是 Flink 总内存（Total Flink Memory）减去JVM 堆内存（JVM Heap）。 这种情况下，堆外内存的默认大小将不会生效。")])]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("组成部分")]),e._v(" "),a("th",[e._v("配置参数")]),e._v(" "),a("th",[e._v("描述")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("JVM HeapJVM 堆内存")]),e._v(" "),a("td",[e._v("jobmanager.memory.heap.size")]),e._v(" "),a("td",[e._v("JobManager 的 JVM 堆内存。")])]),e._v(" "),a("tr",[a("td",[e._v("Off-Heap Memory 堆外内存")]),e._v(" "),a("td",[e._v("jobmanager.memory.off-heap.size")]),e._v(" "),a("td",[e._v("JobManager 的堆外内存（直接内存或本地内存）。")])]),e._v(" "),a("tr",[a("td",[e._v("JVM Metaspace")]),e._v(" "),a("td",[e._v("jobmanager.memory.jvm-metaspace.size")]),e._v(" "),a("td",[e._v("Flink JVM 进程的 Metaspace。")])]),e._v(" "),a("tr",[a("td",[e._v("JVM OverheadJVM 开销")]),e._v(" "),a("td",[e._v("jobmanager.memory.jvm-overhead.minjobmanager.memory.jvm-overhead.maxjobmanager.memory.jvm-overhead.fraction")]),e._v(" "),a("td",[e._v("用于其他 JVM 开销的本地内存，例如栈空间、垃圾回收空间等。该内存部分为基于"),a("a",{attrs:{href:"https://nightlies.apache.org/flink/flink-docs-release-1.15/zh/docs/deployment/memory/mem_setup/#configure-total-memory",target:"_blank",rel:"noopener noreferrer"}},[e._v("进程总内存"),a("OutboundLink")],1),e._v("的"),a("a",{attrs:{href:"https://nightlies.apache.org/flink/flink-docs-release-1.15/zh/docs/deployment/memory/mem_setup/#capped-fractionated-components",target:"_blank",rel:"noopener noreferrer"}},[e._v("受限的等比内存部分"),a("OutboundLink")],1),e._v("。")])])])]),e._v(" "),a("blockquote",[a("p",[e._v("如果已经明确设置了 JVM 堆内存，建议不要再设置进程总内存（total process memory）或 Flink 总内存（total Flink memory），否则可能会造成内存配置冲突。")])]),e._v(" "),a("p",[e._v("详情参见："),a("a",{attrs:{href:"https://nightlies.apache.org/flink/flink-docs-release-1.15/zh/docs/deployment/memory/mem_setup_jobmanager/",target:"_blank",rel:"noopener noreferrer"}},[e._v("配置 JobManager 内存"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("img",{attrs:{src:"/tool/05/202/taskmanager.png",alt:"clash"}})]),e._v(" "),a("h3",{attrs:{id:"taskmanager"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#taskmanager"}},[e._v("#")]),e._v(" Taskmanager")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("组成部分")]),e._v(" "),a("th",[e._v("配置参数")]),e._v(" "),a("th",[e._v("描述")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("Framework Heap框架堆内存")]),e._v(" "),a("td",[e._v("taskmanager.memory.framework.heap.size")]),e._v(" "),a("td",[e._v("用于 Flink 框架的 JVM 堆内存（进阶配置）。")])]),e._v(" "),a("tr",[a("td",[e._v("Task Heap任务堆内存")]),e._v(" "),a("td",[e._v("taskmanager.memory.task.heap.size")]),e._v(" "),a("td",[e._v("用于 Flink 应用的算子及用户代码的 JVM 堆内存。")])]),e._v(" "),a("tr",[a("td",[e._v("Managed Memory托管内存")]),e._v(" "),a("td",[e._v("taskmanager.memory.managed.size"),a("br"),e._v("taskmanager.memory.managed.fraction")]),e._v(" "),a("td",[e._v("由 Flink 管理的用于排序、哈希表、缓存中间结果及 RocksDB State Backend 的本地内存。")])]),e._v(" "),a("tr",[a("td",[e._v("Framework Off-Heap")]),e._v(" "),a("td"),e._v(" "),a("td")]),e._v(" "),a("tr",[a("td",[e._v("框架堆外内存")]),e._v(" "),a("td",[e._v("taskmanager.memory.framework.off-heap.size")]),e._v(" "),a("td",[e._v("用于 Flink 框架的堆外内存（直接内存或本地内存）（进阶配置）。")])]),e._v(" "),a("tr",[a("td",[e._v("Task Off-Heap任务堆外内存")]),e._v(" "),a("td",[e._v("taskmanager.memory.task.off-heap.size")]),e._v(" "),a("td",[e._v("用于 Flink 应用的算子及用户代码的堆外内存（直接内存或本地内存）。")])]),e._v(" "),a("tr",[a("td",[e._v("Network网络内存")]),e._v(" "),a("td",[e._v("taskmanager.memory.network.min"),a("br"),e._v("taskmanager.memory.network.max"),a("br"),e._v("taskmanager.memory.network.fraction")]),e._v(" "),a("td",[e._v("用于任务之间数据传输的直接内存（例如网络传输缓冲）。该内存部分为基于 Flink 总内存的受限的等比内存部分。这块内存被用于分配网络缓冲")])]),e._v(" "),a("tr",[a("td",[e._v("JVM Metaspace")]),e._v(" "),a("td",[e._v("taskmanager.memory.jvm-metaspace.size")]),e._v(" "),a("td",[e._v("Flink JVM 进程的 Metaspace。")])]),e._v(" "),a("tr",[a("td",[e._v("JVM Overhead")]),e._v(" "),a("td",[e._v("taskmanager.memory.jvm-overhead.min"),a("br"),e._v("taskmanager.memory.jvm-overhead.max"),a("br"),e._v("taskmanager.memory.jvm-overhead.fraction")]),e._v(" "),a("td",[e._v("用于其他 JVM 开销的本地内存，例如栈空间、垃圾回收空间等。该内存部分为基于进程总内存的受限的等比内存部分。")])])])]),e._v(" "),a("p",[e._v("详情参见："),a("a",{attrs:{href:"https://nightlies.apache.org/flink/flink-docs-release-1.15/zh/docs/deployment/memory/mem_setup_tm/",target:"_blank",rel:"noopener noreferrer"}},[e._v("配置 TaskManager 内存"),a("OutboundLink")],1)]),e._v(" "),a("h3",{attrs:{id:"部署推荐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署推荐"}},[e._v("#")]),e._v(" 部署推荐")]),e._v(" "),a("p",[e._v("独立部署模式下，通常更关注 Flink 应用本身使用的内存大小。\n建议配置")]),e._v(" "),a("ul",[a("li",[e._v("Flink 总内存（taskmanager.memory.flink.size 或者 jobmanager.memory.flink.size）")]),e._v(" "),a("li",[e._v("其组成部分。\n此外，如果出现 Metaspace 不足的问题，可以调整 JVM Metaspace 的大小。\n这种情况下通常无需配置进程总内存，因为不管是 Flink 还是部署环境都不会对 JVM 开销 进行限制，它只与机器的物理资源相关。")])])])}),[],!1,null,null,null);a.default=v.exports}}]);