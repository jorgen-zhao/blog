(window.webpackJsonp=window.webpackJsonp||[]).push([[410],{762:function(s,t,a){"use strict";a.r(t);var n=a(15),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"å‰è¨€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[s._v("#")]),s._v(" å‰è¨€")]),s._v(" "),t("p",[s._v("å¤§å®¶å¥½ï¼åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†åŸºç¡€è®¾æ–½å³ä»£ç (IaC)çš„é©å‘½æ€§æ„ä¹‰ï¼Œä»¥åŠå„ç§IaCå·¥å…·ä¹‹é—´çš„æ¯”è¾ƒã€‚ğŸ— ä½†æ˜¯ï¼Œä»…ä»…é€‰æ‹©åˆé€‚çš„å·¥å…·æ˜¯ä¸å¤Ÿçš„â€”â€”å¦‚ä½•ç¼–å†™å‡ºé«˜è´¨é‡ã€å¯ç»´æŠ¤çš„IaCä»£ç æ‰æ˜¯çœŸæ­£æŒ‘æˆ˜æ‰€åœ¨ã€‚")]),s._v(" "),t("p",[s._v('ä½œä¸ºä¸€ååœ¨DevOpsé¢†åŸŸæ‘¸çˆ¬æ»šæ‰“å¤šå¹´çš„"è€å…µ"ï¼Œæˆ‘è¸©è¿‡ä¸å°‘å‘ï¼Œä¹Ÿæ€»ç»“äº†ä¸€äº›ç»éªŒã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³å’Œå¤§å®¶åˆ†äº«IaCçš„æœ€ä½³å®è·µå’Œæ¨¡å¼ï¼Œå¸®åŠ©ä½ æ„å»ºæ›´åŠ å¥å£®å’Œå¯ç»´æŠ¤çš„åŸºç¡€è®¾æ–½ä»£ç ã€‚')]),s._v(" "),t("h2",{attrs:{id:"ä¸ºä»€ä¹ˆiacæœ€ä½³å®è·µå¦‚æ­¤é‡è¦"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆiacæœ€ä½³å®è·µå¦‚æ­¤é‡è¦"}},[s._v("#")]),s._v(" ä¸ºä»€ä¹ˆIaCæœ€ä½³å®è·µå¦‚æ­¤é‡è¦ï¼Ÿ")]),s._v(" "),t("p",[s._v('IaCè™½ç„¶è®©åŸºç¡€è®¾æ–½ç®¡ç†å˜å¾—ä»£ç åŒ–ï¼Œä½†å¦‚æœä¸éµå¾ªè‰¯å¥½çš„å®è·µï¼Œå¾ˆå®¹æ˜“é™·å…¥"ä»£ç åœ°ç‹±"ï¼š')]),s._v(" "),t("ul",[t("li",[s._v("é‡å¤çš„é…ç½®ä»£ç æ•£å¸ƒåœ¨å„å¤„")]),s._v(" "),t("li",[s._v("ç¯å¢ƒä¹‹é—´çš„å·®å¼‚éš¾ä»¥è¿½è¸ª")]),s._v(" "),t("li",[s._v("å˜æ›´å¯¼è‡´çš„ç”Ÿäº§äº‹æ•…é¢‘å‘")]),s._v(" "),t("li",[s._v("å›¢é˜Ÿæˆå‘˜åä½œæ•ˆç‡ä½ä¸‹")])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("æç¤º")]),s._v(" "),t("p",[s._v('è®°ä½ï¼šç³Ÿç³•çš„IaCä»£ç æ¯”æ‰‹åŠ¨ç®¡ç†æ›´ç³Ÿç³•ï¼è‡³å°‘æ‰‹åŠ¨ç®¡ç†æ—¶ï¼Œä½ çŸ¥é“"è¿™æ˜¯æ‰‹åŠ¨é…ç½®çš„"ï¼Œè€Œç³Ÿç³•çš„IaCä»£ç ä¼šè®©ä½ è¯¯ä»¥ä¸ºå®ƒæ˜¯å¯é çš„ã€‚')])]),s._v(" "),t("h2",{attrs:{id:"iacæ ¸å¿ƒæœ€ä½³å®è·µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iacæ ¸å¿ƒæœ€ä½³å®è·µ"}},[s._v("#")]),s._v(" IaCæ ¸å¿ƒæœ€ä½³å®è·µ")]),s._v(" "),t("h3",{attrs:{id:"ç›®å½•ç»“æ„è®¾è®¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç›®å½•ç»“æ„è®¾è®¡"}},[s._v("#")]),s._v(" ç›®å½•ç»“æ„è®¾è®¡")]),s._v(" "),t("p",[s._v("è‰¯å¥½çš„ç›®å½•ç»“æ„æ˜¯IaCé¡¹ç›®çš„åŸºçŸ³ã€‚ä»¥ä¸‹æ˜¯æˆ‘æ¨èçš„ç›®å½•ç»“æ„ï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("terraform/\nâ”œâ”€â”€ modules/          # å¯é‡ç”¨çš„æ¨¡å—\nâ”‚   â”œâ”€â”€ vpc/\nâ”‚   â”œâ”€â”€ rds/\nâ”‚   â””â”€â”€ iam/\nâ”œâ”€â”€ environments/     # ä¸åŒç¯å¢ƒçš„é…ç½®\nâ”‚   â”œâ”€â”€ dev/\nâ”‚   â”œâ”€â”€ staging/\nâ”‚   â””â”€â”€ prod/\nâ”œâ”€â”€ scripts/          # è¾…åŠ©è„šæœ¬\nâ”œâ”€â”€ main.tf          # ä¸»å…¥å£æ–‡ä»¶\nâ”œâ”€â”€ variables.tf     # å˜é‡å®šä¹‰\nâ”œâ”€â”€ outputs.tf       # è¾“å‡ºå®šä¹‰\nâ””â”€â”€ terraform.tfvars # ç¯å¢ƒç‰¹å®šå˜é‡\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"æ¨¡å—åŒ–è®¾è®¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ¨¡å—åŒ–è®¾è®¡"}},[s._v("#")]),s._v(" æ¨¡å—åŒ–è®¾è®¡")]),s._v(" "),t("p",[s._v("æ¨¡å—åŒ–æ˜¯IaCçš„æ ¸å¿ƒæ€æƒ³ä¹‹ä¸€ã€‚å°†å¤æ‚çš„åŸºç¡€è®¾æ–½æ‹†åˆ†ä¸ºå¯é‡ç”¨çš„æ¨¡å—ï¼š")]),s._v(" "),t("div",{staticClass:"language-hcl line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-hcl"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# modules/vpc/main.tf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("resource "),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v('"aws_vpc"')])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("cidr_block")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" var.cidr_block\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("enable_dns_support")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("enable_dns_hostnames")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  \n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("tags")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("Name")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),s._v('-vpc"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("resource "),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v('"aws_subnet"')])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"public"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("count")]),s._v("                   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" length(var.availability_zones)\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("vpc_id")]),s._v("                  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" aws_vpc.main.id\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("cidr_block")]),s._v("              "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" cidrsubnet(var.cidr_block, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(", count.index)\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("availability_zone")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" var.availability_zones"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("count.index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("map_public_ip_on_launch")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n  \n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("tags")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("Name")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),s._v("-public-subnet-"),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("count")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v("index")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),s._v('"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("h3",{attrs:{id:"å˜é‡ç®¡ç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å˜é‡ç®¡ç†"}},[s._v("#")]),s._v(" å˜é‡ç®¡ç†")]),s._v(" "),t("p",[s._v("è‰¯å¥½çš„å˜é‡ç®¡ç†æ˜¯IaCé¡¹ç›®æˆåŠŸçš„å…³é”®ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("ä½¿ç”¨"),t("code",[s._v("variables.tf")]),s._v("å®šä¹‰æ‰€æœ‰å˜é‡")]),s._v(" "),t("li",[s._v("ä½¿ç”¨"),t("code",[s._v("terraform.tfvars")]),s._v("æä¾›ç¯å¢ƒç‰¹å®šå€¼")]),s._v(" "),t("li",[s._v("ä¸ºæ‰€æœ‰å˜é‡æä¾›æè¿°å’Œé»˜è®¤å€¼")]),s._v(" "),t("li",[s._v("ä½¿ç”¨ç±»å‹çº¦æŸç¡®ä¿è¾“å…¥æ­£ç¡®")])]),s._v(" "),t("div",{staticClass:"language-hcl line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-hcl"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# variables.tf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("variable"),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v(' "environment" ')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("description")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The environment name (dev, staging, prod)"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("type")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" string\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("default")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dev"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("variable"),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v(' "instance_type" ')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("description")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EC2 instance type"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("type")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" string\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("validation")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("condition")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" contains("),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"t2.micro"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"t2.small"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"t2.medium"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", var.instance_type)\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("error_message")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Invalid instance type. Allowed values: t2.micro, t2.small, t2.medium."')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h2",{attrs:{id:"ç¯å¢ƒç®¡ç†ç­–ç•¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¯å¢ƒç®¡ç†ç­–ç•¥"}},[s._v("#")]),s._v(" ç¯å¢ƒç®¡ç†ç­–ç•¥")]),s._v(" "),t("h3",{attrs:{id:"å¤šç¯å¢ƒé…ç½®ç®¡ç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¤šç¯å¢ƒé…ç½®ç®¡ç†"}},[s._v("#")]),s._v(" å¤šç¯å¢ƒé…ç½®ç®¡ç†")]),s._v(" "),t("p",[s._v("ç®¡ç†å¤šä¸ªç¯å¢ƒæ˜¯IaCä¸­çš„å¸¸è§æŒ‘æˆ˜ã€‚ä»¥ä¸‹æ˜¯å‡ ç§æœ‰æ•ˆç­–ç•¥ï¼š")]),s._v(" "),t("h4",{attrs:{id:"_1-å·¥ä½œåŒº-workspaces-æ–¹æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-å·¥ä½œåŒº-workspaces-æ–¹æ³•"}},[s._v("#")]),s._v(" 1. å·¥ä½œåŒº(Workspaces)æ–¹æ³•")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ›å»ºä¸åŒç¯å¢ƒçš„å·¥ä½œåŒº")]),s._v("\nterraform workspace new dev\nterraform workspace new staging\nterraform workspace new prod\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ‡æ¢åˆ°ç‰¹å®šå·¥ä½œåŒº")]),s._v("\nterraform workspace "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" dev\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h4",{attrs:{id:"_2-ç›®å½•åˆ†ç¦»æ–¹æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-ç›®å½•åˆ†ç¦»æ–¹æ³•"}},[s._v("#")]),s._v(" 2. ç›®å½•åˆ†ç¦»æ–¹æ³•")]),s._v(" "),t("p",[s._v("ä¸ºæ¯ä¸ªç¯å¢ƒåˆ›å»ºç‹¬ç«‹ç›®å½•ï¼Œå…±äº«æ¨¡å—ï¼š")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("terraform/\nâ”œâ”€â”€ modules/\nâ”‚   â””â”€â”€ common/\nâ”œâ”€â”€ environments/\nâ”‚   â”œâ”€â”€ dev/\nâ”‚   â”‚   â”œâ”€â”€ main.tf\nâ”‚   â”‚   â””â”€â”€ terraform.tfvars\nâ”‚   â”œâ”€â”€ staging/\nâ”‚   â”‚   â”œâ”€â”€ main.tf\nâ”‚   â”‚   â””â”€â”€ terraform.tfvars\nâ”‚   â””â”€â”€ prod/\nâ”‚       â”œâ”€â”€ main.tf\nâ”‚       â””â”€â”€ terraform.tfvars\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h4",{attrs:{id:"_3-åç¼€æ–¹æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-åç¼€æ–¹æ³•"}},[s._v("#")]),s._v(" 3. åç¼€æ–¹æ³•")]),s._v(" "),t("p",[s._v("ä½¿ç”¨åç¼€åŒºåˆ†ä¸åŒç¯å¢ƒï¼š")]),s._v(" "),t("div",{staticClass:"language-hcl line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-hcl"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("resource "),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v('"aws_s3_bucket"')])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"app"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("count")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" var.create_buckets ? "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" : "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("bucket")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v("app_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),s._v("-"),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),s._v('-bucket"')]),s._v("\n  \n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("tags")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("Environment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" var.environment\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"ç¯å¢ƒå˜é‡ä¸æ•æ„Ÿæ•°æ®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç¯å¢ƒå˜é‡ä¸æ•æ„Ÿæ•°æ®"}},[s._v("#")]),s._v(" ç¯å¢ƒå˜é‡ä¸æ•æ„Ÿæ•°æ®")]),s._v(" "),t("p",[s._v("å¯¹äºæ•æ„Ÿæ•°æ®ï¼Œæ°¸è¿œä¸è¦å°†å…¶ç¡¬ç¼–ç åœ¨ä»£ç ä¸­ï¼š")]),s._v(" "),t("div",{staticClass:"language-hcl line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-hcl"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ä½¿ç”¨ç¯å¢ƒå˜é‡")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("variable"),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v(' "db_password" ')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("description")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Database password"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("type")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" string\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("sensitive")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æˆ–è€…ä½¿ç”¨HashiCorp Vault")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data "),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v('"vault_generic_secret"')])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db_credentials"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("path")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"secret/database/credentials"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("resource "),t("span",{pre:!0,attrs:{class:"token type variable"}},[s._v('"aws_db_instance"')])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("username")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" data.vault_generic_secret.db_credentials.data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("password")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" data.vault_generic_secret.db_credentials.data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h2",{attrs:{id:"ç‰ˆæœ¬æ§åˆ¶ä¸åä½œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç‰ˆæœ¬æ§åˆ¶ä¸åä½œ"}},[s._v("#")]),s._v(" ç‰ˆæœ¬æ§åˆ¶ä¸åä½œ")]),s._v(" "),t("h3",{attrs:{id:"ç‰ˆæœ¬æ§åˆ¶æœ€ä½³å®è·µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç‰ˆæœ¬æ§åˆ¶æœ€ä½³å®è·µ"}},[s._v("#")]),s._v(" ç‰ˆæœ¬æ§åˆ¶æœ€ä½³å®è·µ")]),s._v(" "),t("ul",[t("li",[s._v("ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶")]),s._v(" "),t("li",[s._v("ä¸ºæ¯ä¸ªå˜æ›´åˆ›å»ºåˆ†æ”¯")]),s._v(" "),t("li",[s._v("ä½¿ç”¨Pull Requestæµç¨‹è¿›è¡Œä»£ç å®¡æŸ¥")]),s._v(" "),t("li",[s._v("å°†IaCä»£ç ä¸åº”ç”¨ä»£ç ä¸€èµ·å­˜å‚¨åœ¨åŒä¸€ä¸ªä»“åº“ä¸­")])]),s._v(" "),t("h3",{attrs:{id:"å˜æ›´ç®¡ç†æµç¨‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å˜æ›´ç®¡ç†æµç¨‹"}},[s._v("#")]),s._v(" å˜æ›´ç®¡ç†æµç¨‹")]),s._v(" "),t("div",{staticClass:"custom-block theorem"},[t("p",{staticClass:"title"},[s._v("THEOREM")]),t("p",[s._v("IaCå˜æ›´ç®¡ç†å››æ­¥æ³•ï¼š")]),s._v(" "),t("ol",[t("li",[s._v("è®¡åˆ’(Plan)ï¼šä½¿ç”¨"),t("code",[s._v("terraform plan")]),s._v("é¢„è§ˆå˜æ›´")]),s._v(" "),t("li",[s._v("å®¡æ ¸(Review)ï¼šå›¢é˜Ÿæˆå‘˜å®¡æŸ¥å˜æ›´")]),s._v(" "),t("li",[s._v("åº”ç”¨(Apply)ï¼šä½¿ç”¨"),t("code",[s._v("terraform apply")]),s._v("æ‰§è¡Œå˜æ›´")]),s._v(" "),t("li",[s._v("éªŒè¯(Verify)ï¼šéªŒè¯å˜æ›´æ˜¯å¦ç¬¦åˆé¢„æœŸ")])])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å®Œæ•´çš„å˜æ›´æµç¨‹ç¤ºä¾‹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" feature/add-new-service\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ä¿®æ”¹ä»£ç ...")]),s._v("\nterraform plan\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"feat: add new service infrastructure"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push origin feature/add-new-service\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åˆ›å»ºPull Requestå¹¶ç­‰å¾…å®¡æŸ¥")]),s._v("\nterraform apply\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h2",{attrs:{id:"æµ‹è¯•ç­–ç•¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æµ‹è¯•ç­–ç•¥"}},[s._v("#")]),s._v(" æµ‹è¯•ç­–ç•¥")]),s._v(" "),t("h3",{attrs:{id:"å•å…ƒæµ‹è¯•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å•å…ƒæµ‹è¯•"}},[s._v("#")]),s._v(" å•å…ƒæµ‹è¯•")]),s._v(" "),t("p",[s._v("ä½¿ç”¨Terratestå¯¹IaCæ¨¡å—è¿›è¡Œæµ‹è¯•ï¼š")]),s._v(" "),t("div",{staticClass:"language-go line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-go"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// test/vpc_test.go")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" test\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"testing"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/gruntwork-io/terratest/modules/terraform"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/stretchr/testify/assert"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("TestVpcModule")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("t "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("testing"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("T"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    terraformOptions "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("terraform"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Terraformç›®å½•è·¯å¾„")]),s._v("\n        TerraformDir"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"../modules/vpc"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®¾ç½®å˜é‡")]),s._v("\n        Vars"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("map")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cidr_block"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.0.0.0/16"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"environment"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åœ¨æµ‹è¯•ç»“æŸæ—¶æ¸…ç†èµ„æº")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defer")]),s._v(" terraform"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Destroy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" terraformOptions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆå§‹åŒ–å¹¶åº”ç”¨Terraformé…ç½®")]),s._v("\n    terraform"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("InitAndApply")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" terraformOptions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// éªŒè¯VPCæ˜¯å¦å·²åˆ›å»º")]),s._v("\n    vpcId "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" terraform"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Output")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" terraformOptions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vpc_id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    assert"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("NotEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vpcId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])]),t("h3",{attrs:{id:"é›†æˆæµ‹è¯•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é›†æˆæµ‹è¯•"}},[s._v("#")]),s._v(" é›†æˆæµ‹è¯•")]),s._v(" "),t("ul",[t("li",[s._v("ä½¿ç”¨"),t("code",[s._v("terraform plan")]),s._v("è¿›è¡Œè®¡åˆ’æµ‹è¯•")]),s._v(" "),t("li",[s._v("ä½¿ç”¨"),t("code",[s._v("terraform validate")]),s._v("è¿›è¡Œè¯­æ³•æ£€æŸ¥")]),s._v(" "),t("li",[s._v("ä½¿ç”¨"),t("code",[s._v("tflint")]),s._v("è¿›è¡Œä»£ç è´¨é‡æ£€æŸ¥")])]),s._v(" "),t("h2",{attrs:{id:"å®‰å…¨ä¸åˆè§„"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®‰å…¨ä¸åˆè§„"}},[s._v("#")]),s._v(" å®‰å…¨ä¸åˆè§„")]),s._v(" "),t("h3",{attrs:{id:"å®‰å…¨æœ€ä½³å®è·µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®‰å…¨æœ€ä½³å®è·µ"}},[s._v("#")]),s._v(" å®‰å…¨æœ€ä½³å®è·µ")]),s._v(" "),t("ul",[t("li",[s._v("å®šæœŸè½®æ¢è®¿é—®å¯†é’¥å’Œå¯†ç ")]),s._v(" "),t("li",[s._v("ä½¿ç”¨IAMæœ€å°æƒé™åŸåˆ™")]),s._v(" "),t("li",[s._v("å¯ç”¨äº‘æœåŠ¡æä¾›å•†çš„å®‰å…¨åŠŸèƒ½")]),s._v(" "),t("li",[s._v("å®šæœŸè¿›è¡Œå®‰å…¨å®¡è®¡")])]),s._v(" "),t("h3",{attrs:{id:"åˆè§„æ€§æ£€æŸ¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆè§„æ€§æ£€æŸ¥"}},[s._v("#")]),s._v(" åˆè§„æ€§æ£€æŸ¥")]),s._v(" "),t("p",[s._v("ä½¿ç”¨å·¥å…·å¦‚Open Policy Agent(OPA)æˆ–Conftestè¿›è¡Œç­–ç•¥å³ä»£ç æ£€æŸ¥ï¼š")]),s._v(" "),t("div",{staticClass:"language-rego line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-rego"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# opa.rego")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" terraform\n\ndeny"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("msg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    resource "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" input"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    resource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("type "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aws_security_group_rule"')]),s._v("\n    resource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("properties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("from_port "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n    resource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("properties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("to_port "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("\n    resource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("properties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cidr_blocks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("_")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0/0"')]),s._v("\n    msg "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Security group allows SSH access from the internet"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h2",{attrs:{id:"ç»“è¯­"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç»“è¯­"}},[s._v("#")]),s._v(" ç»“è¯­")]),s._v(" "),t("p",[s._v("IaCæœ€ä½³å®è·µæ˜¯DevOpsæ—…ç¨‹ä¸­çš„é‡è¦ä¸€ç¯ã€‚é€šè¿‡éµå¾ªè¿™äº›å®è·µï¼Œä½ å¯ä»¥æ„å»ºå‡ºæ›´åŠ å¥å£®ã€å¯ç»´æŠ¤å’Œå¯æ‰©å±•çš„åŸºç¡€è®¾æ–½ä»£ç ã€‚")]),s._v(" "),t("p",[s._v("è®°ä½ï¼ŒIaCä¸ä»…ä»…æ˜¯å…³äºå·¥å…·ï¼Œæ›´æ˜¯å…³äºæ€ç»´æ–¹å¼çš„è½¬å˜ã€‚å®ƒè¦æ±‚æˆ‘ä»¬åƒè½¯ä»¶å¼€å‘ä¸€æ ·æ€è€ƒåŸºç¡€è®¾æ–½ç®¡ç†â€”â€”æ³¨é‡ä»£ç è´¨é‡ã€æµ‹è¯•ã€ç‰ˆæœ¬æ§åˆ¶å’Œåä½œã€‚")]),s._v(" "),t("p",[s._v("å¸Œæœ›è¿™äº›æœ€ä½³å®è·µèƒ½å¸®åŠ©ä½ åœ¨IaCçš„é“è·¯ä¸Šå°‘èµ°å¼¯è·¯ï¼Œæ„å»ºå‡ºæ›´åŠ å¯é çš„åŸºç¡€è®¾æ–½ï¼")]),s._v(" "),t("blockquote",[t("p",[s._v('"åŸºç¡€è®¾æ–½å³ä»£ç ä¸æ˜¯ç»ˆç‚¹ï¼Œè€Œæ˜¯DevOpsæ—…ç¨‹ä¸­çš„ä¸€ä¸ªé‡Œç¨‹ç¢‘ã€‚æŒç»­æ”¹è¿›å’Œä¼˜åŒ–æ‰æ˜¯çœŸæ­£çš„ç›®æ ‡ã€‚"')])]),s._v(" "),t("p",[s._v("å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–æƒ³åˆ†äº«ä½ çš„IaCæœ€ä½³å®è·µï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼è®©æˆ‘ä»¬ä¸€èµ·è¿›æ­¥ï¼ğŸš€")])])}),[],!1,null,null,null);t.default=r.exports}}]);