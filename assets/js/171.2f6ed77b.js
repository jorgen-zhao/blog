(window.webpackJsonp=window.webpackJsonp||[]).push([[171],{523:function(s,t,a){"use strict";a.r(t);var n=a(15),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"å‰è¨€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[s._v("#")]),s._v(" å‰è¨€")]),s._v(" "),t("p",[s._v("å—¨ï¼Œå¤§å®¶å¥½ï¼æˆ‘æ˜¯Jorgenï¼Œä»Šå¤©æƒ³å’Œå¤§å®¶èŠèŠä¸€ä¸ªåœ¨MCPå¼€å‘ä¸­ç»å¸¸è¢«å¿½è§†ä½†åˆæå…¶é‡è¦çš„ä¸»é¢˜â€”â€”å¤šç§Ÿæˆ·ä¸æƒé™ç®¡ç†ã€‚ğŸ¤”")]),s._v(" "),t("p",[s._v("åœ¨æ„å»ºä¼ä¸šçº§åº”ç”¨æ—¶ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦åœ¨ä¸€ä¸ªå¹³å°ä¸Šä¸ºå¤šä¸ªå®¢æˆ·æä¾›æœåŠ¡ï¼Œè¿™å°±æ¶‰åŠåˆ°å¤šç§Ÿæˆ·æ¶æ„ã€‚è€Œå¦‚ä½•ç¡®ä¿æ¯ä¸ªå®¢æˆ·çš„æ•°æ®å®‰å…¨ã€æ“ä½œæƒé™åˆ†æ˜ï¼Œåˆ™æ˜¯æƒé™ç®¡ç†çš„æ ¸å¿ƒã€‚"),t("s",[s._v("è¯´å®è¯ï¼Œæˆ‘æ›¾ç»å› ä¸ºå¿½ç•¥äº†è¿™ä¸€ç‚¹ï¼Œå·®ç‚¹æŠŠAå…¬å¸çš„æ•°æ®å±•ç¤ºç»™äº†Bå…¬å¸çš„å®¢æˆ·ï¼Œå¹¸å¥½åŠæ—¶å‘ç°ï¼Œå¦åˆ™åæœä¸å ªè®¾æƒ³ï¼")])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("æç¤º")]),s._v(" "),t("p",[s._v("å¤šç§Ÿæˆ·æ¶æ„æ˜¯ä¸€ç§è½¯ä»¶æ¶æ„æ¨¡å¼ï¼Œå…¶ä¸­å•ä¸ªè½¯ä»¶å®ä¾‹æœåŠ¡äºå¤šä¸ªå®¢æˆ·ï¼ˆç§Ÿæˆ·ï¼‰ï¼Œä½†æ¯ä¸ªå®¢æˆ·çš„æ•°æ®å’Œé…ç½®æ˜¯ç›¸äº’éš”ç¦»çš„ã€‚")])]),s._v(" "),t("p",[s._v("ä»Šå¤©ï¼Œæˆ‘å°†å¸¦å¤§å®¶æ·±å…¥äº†è§£å¦‚ä½•åœ¨MCPå¹³å°ä¸­å®ç°é«˜æ•ˆçš„å¤šç§Ÿæˆ·æ¶æ„ä¸ç²¾ç»†åŒ–çš„æƒé™ç®¡ç†ï¼Œè®©ä½ çš„åº”ç”¨æ—¢å®‰å…¨åˆçµæ´»ï¼")]),s._v(" "),t("h2",{attrs:{id:"mcpå¤šç§Ÿæˆ·æ¶æ„åŸºç¡€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mcpå¤šç§Ÿæˆ·æ¶æ„åŸºç¡€"}},[s._v("#")]),s._v(" MCPå¤šç§Ÿæˆ·æ¶æ„åŸºç¡€")]),s._v(" "),t("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯å¤šç§Ÿæˆ·æ¶æ„"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯å¤šç§Ÿæˆ·æ¶æ„"}},[s._v("#")]),s._v(" ä»€ä¹ˆæ˜¯å¤šç§Ÿæˆ·æ¶æ„ï¼Ÿ")]),s._v(" "),t("p",[s._v("å¤šç§Ÿæˆ·æ¶æ„æ˜¯æŒ‡å•ä¸ªè½¯ä»¶å®ä¾‹ä¸ºå¤šä¸ªå®¢æˆ·ï¼ˆç§Ÿæˆ·ï¼‰æä¾›æœåŠ¡çš„ä¸€ç§æ¶æ„æ¨¡å¼ã€‚åœ¨è¿™ç§æ¶æ„ä¸­ï¼Œä¸åŒç§Ÿæˆ·çš„æ•°æ®å’Œé…ç½®æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œä½†å…±äº«ç›¸åŒçš„ä»£ç åº“å’ŒåŸºç¡€è®¾æ–½ã€‚")]),s._v(" "),t("div",{staticClass:"custom-block theorem"},[t("p",{staticClass:"title"},[s._v("THEOREM")]),t("p",[s._v("å¤šç§Ÿæˆ·æ¶æ„çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("æˆæœ¬æ•ˆç›Š")]),s._v("ï¼šå¤šä¸ªç§Ÿæˆ·å…±äº«èµ„æºï¼Œé™ä½æ€»ä½“æ‹¥æœ‰æˆæœ¬")]),s._v(" "),t("li",[t("strong",[s._v("é›†ä¸­ç»´æŠ¤")]),s._v("ï¼šåªéœ€ç»´æŠ¤ä¸€ä¸ªä»£ç åº“ï¼Œç®€åŒ–å‡çº§å’Œç»´æŠ¤")]),s._v(" "),t("li",[t("strong",[s._v("ä¸€è‡´æ€§ä½“éªŒ")]),s._v("ï¼šæ‰€æœ‰ç§Ÿæˆ·ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„åŠŸèƒ½")])])]),t("h3",{attrs:{id:"mcpä¸­çš„å¤šç§Ÿæˆ·å®ç°æ¨¡å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mcpä¸­çš„å¤šç§Ÿæˆ·å®ç°æ¨¡å¼"}},[s._v("#")]),s._v(" MCPä¸­çš„å¤šç§Ÿæˆ·å®ç°æ¨¡å¼")]),s._v(" "),t("p",[s._v("åœ¨MCPå¹³å°ä¸­ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§å¤šç§Ÿæˆ·å®ç°æ¨¡å¼ï¼š")]),s._v(" "),t("h4",{attrs:{id:"_1-å…±äº«æ•°æ®åº“-å…±äº«æ¶æ„æ¨¡å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-å…±äº«æ•°æ®åº“-å…±äº«æ¶æ„æ¨¡å¼"}},[s._v("#")]),s._v(" 1. å…±äº«æ•°æ®åº“ï¼Œå…±äº«æ¶æ„æ¨¡å¼")]),s._v(" "),t("p",[s._v("æ‰€æœ‰ç§Ÿæˆ·ä½¿ç”¨ç›¸åŒçš„æ•°æ®åº“æ¶æ„ï¼Œé€šè¿‡ç§Ÿæˆ·IDè¿›è¡Œæ•°æ®éš”ç¦»ã€‚")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- ç¤ºä¾‹ï¼šé€šè¿‡ç§Ÿæˆ·IDéš”ç¦»æ•°æ®")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" orders "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" tenant_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tenant123'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("strong",[s._v("ä¼˜ç‚¹")]),s._v("ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("å®ç°ç®€å•ï¼Œèµ„æºåˆ©ç”¨ç‡é«˜")]),s._v(" "),t("li",[s._v("æŸ¥è¯¢æ€§èƒ½è¾ƒå¥½")])]),s._v(" "),t("p",[t("strong",[s._v("ç¼ºç‚¹")]),s._v("ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("å­˜åœ¨æ•°æ®æ³„éœ²é£é™©ï¼ˆå¦‚æœç§Ÿæˆ·IDå¤„ç†ä¸å½“ï¼‰")]),s._v(" "),t("li",[s._v("éš¾ä»¥å®ç°å®šåˆ¶åŒ–çš„æ¶æ„éœ€æ±‚")])]),s._v(" "),t("h4",{attrs:{id:"_2-ç‹¬ç«‹æ•°æ®åº“æ¨¡å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-ç‹¬ç«‹æ•°æ®åº“æ¨¡å¼"}},[s._v("#")]),s._v(" 2. ç‹¬ç«‹æ•°æ®åº“æ¨¡å¼")]),s._v(" "),t("p",[s._v("æ¯ä¸ªç§Ÿæˆ·æ‹¥æœ‰ç‹¬ç«‹çš„æ•°æ®åº“ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("ä¼˜ç‚¹")]),s._v("ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("æ•°æ®éš”ç¦»æ€§æœ€å¼º")]),s._v(" "),t("li",[s._v("å¯ä»¥ä¸ºæ¯ä¸ªç§Ÿæˆ·å®šåˆ¶æ•°æ®åº“æ¶æ„")]),s._v(" "),t("li",[s._v("æ˜“äºè¿ç§»å’Œå¤‡ä»½")])]),s._v(" "),t("p",[t("strong",[s._v("ç¼ºç‚¹")]),s._v("ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("èµ„æºæ¶ˆè€—å¤§")]),s._v(" "),t("li",[s._v("ç®¡ç†å¤æ‚åº¦é«˜")])]),s._v(" "),t("h4",{attrs:{id:"_3-å…±äº«æ•°æ®åº“-ç‹¬ç«‹æ¶æ„æ¨¡å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-å…±äº«æ•°æ®åº“-ç‹¬ç«‹æ¶æ„æ¨¡å¼"}},[s._v("#")]),s._v(" 3. å…±äº«æ•°æ®åº“ï¼Œç‹¬ç«‹æ¶æ„æ¨¡å¼")]),s._v(" "),t("p",[s._v("å…±äº«æ•°æ®åº“ï¼Œä½†æ¯ä¸ªç§Ÿæˆ·æ‹¥æœ‰ç‹¬ç«‹çš„æ•°æ®åº“æ¶æ„ï¼ˆé€šè¿‡ä¸åŒçš„è¡¨å‰ç¼€æˆ–schemaå®ç°ï¼‰ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("ä¼˜ç‚¹")]),s._v("ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("å¹³è¡¡äº†éš”ç¦»æ€§å’Œèµ„æºåˆ©ç”¨ç‡")]),s._v(" "),t("li",[s._v("å¯ä»¥å®ç°ä¸€å®šç¨‹åº¦çš„å®šåˆ¶åŒ–")])]),s._v(" "),t("p",[t("strong",[s._v("ç¼ºç‚¹")]),s._v("ï¼š")]),s._v(" "),t("ul",[t("li",[s._v("ç®¡ç†å¤æ‚åº¦è¾ƒé«˜")]),s._v(" "),t("li",[s._v("æŸäº›æ•°æ®åº“æ“ä½œå¯èƒ½å—é™")])]),s._v(" "),t("p",[s._v("åœ¨MCPå¹³å°ä¸­ï¼Œæˆ‘æ¨èä½¿ç”¨"),t("strong",[s._v("å…±äº«æ•°æ®åº“ï¼Œç‹¬ç«‹æ¶æ„æ¨¡å¼")]),s._v("ä½œä¸ºé»˜è®¤é€‰æ‹©ï¼Œå› ä¸ºå®ƒåœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹æä¾›äº†æœ€ä½³çš„æ€§èƒ½ä¸éš”ç¦»æ€§å¹³è¡¡ã€‚")]),s._v(" "),t("h2",{attrs:{id:"mcpæƒé™ç®¡ç†ç³»ç»Ÿè®¾è®¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mcpæƒé™ç®¡ç†ç³»ç»Ÿè®¾è®¡"}},[s._v("#")]),s._v(" MCPæƒé™ç®¡ç†ç³»ç»Ÿè®¾è®¡")]),s._v(" "),t("h3",{attrs:{id:"æƒé™æ¨¡å‹æ¦‚è¿°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æƒé™æ¨¡å‹æ¦‚è¿°"}},[s._v("#")]),s._v(" æƒé™æ¨¡å‹æ¦‚è¿°")]),s._v(" "),t("p",[s._v("ä¸€ä¸ªå®Œå–„çš„æƒé™ç®¡ç†ç³»ç»Ÿåº”è¯¥åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("ç”¨æˆ·ï¼ˆUserï¼‰")]),s._v("ï¼šç³»ç»Ÿçš„å®é™…ä½¿ç”¨è€…")]),s._v(" "),t("li",[t("strong",[s._v("è§’è‰²ï¼ˆRoleï¼‰")]),s._v("ï¼šæƒé™çš„é›†åˆï¼Œå¦‚ç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·ç­‰")]),s._v(" "),t("li",[t("strong",[s._v("æƒé™ï¼ˆPermissionï¼‰")]),s._v('ï¼šå…·ä½“çš„æ“ä½œæƒé™ï¼Œå¦‚"åˆ›å»ºè®¢å•"ã€"æŸ¥çœ‹æŠ¥è¡¨"ç­‰')]),s._v(" "),t("li",[t("strong",[s._v("èµ„æºï¼ˆResourceï¼‰")]),s._v("ï¼šç³»ç»Ÿä¸­çš„å¯æ“ä½œå¯¹è±¡ï¼Œå¦‚è®¢å•ã€å®¢æˆ·ã€äº§å“ç­‰")])]),s._v(" "),t("div",{staticClass:"custom-block right"},[t("p",[s._v('"æƒé™ç®¡ç†ä¸æ˜¯é™åˆ¶ç”¨æˆ·ï¼Œè€Œæ˜¯ä¿æŠ¤æ•°æ®å’ŒåŠŸèƒ½çš„å®‰å…¨è¾¹ç•Œ"')])]),s._v(" "),t("h3",{attrs:{id:"åŸºäºrbacçš„æƒé™æ¨¡å‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åŸºäºrbacçš„æƒé™æ¨¡å‹"}},[s._v("#")]),s._v(" åŸºäºRBACçš„æƒé™æ¨¡å‹")]),s._v(" "),t("p",[s._v("åœ¨MCPä¸­ï¼Œæˆ‘æ¨èä½¿ç”¨åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰æ¨¡å‹ï¼Œå› ä¸ºå®ƒæ—¢çµæ´»åˆæ˜“äºç†è§£å’Œå®ç°ã€‚")]),s._v(" "),t("div",{staticClass:"language-mermaid line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-mermaid"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("graph")]),s._v(" TD\n    A"),t("span",{pre:!0,attrs:{class:"token text string"}},[s._v("[ç”¨æˆ·]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e")]),s._v(" B"),t("span",{pre:!0,attrs:{class:"token text string"}},[s._v("[è§’è‰²]")]),s._v("\n    B "),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e")]),s._v(" C"),t("span",{pre:!0,attrs:{class:"token text string"}},[s._v("[æƒé™]")]),s._v("\n    C "),t("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e")]),s._v(" D"),t("span",{pre:!0,attrs:{class:"token text string"}},[s._v("[èµ„æºæ“ä½œ]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"å®ç°ç¤ºä¾‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°ç¤ºä¾‹"}},[s._v("#")]),s._v(" å®ç°ç¤ºä¾‹")]),s._v(" "),t("p",[s._v("ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºäºRBACçš„æƒé™ç®¡ç†å®ç°ç¤ºä¾‹ï¼š")]),s._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ç”¨æˆ·æ¨¡å‹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__init__")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" user_id\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("username "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" username\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("roles "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è§’è‰²æ¨¡å‹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Role")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__init__")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" role_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" role_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("role_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" role_id\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("role_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" role_name\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("permissions "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æƒé™æ¨¡å‹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Permission")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("__init__")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" permission_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" resource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" action"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("permission_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" permission_id\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" resource  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¦‚ 'order', 'product'")]),s._v("\n        self"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("action "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" action      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¦‚ 'create', 'read', 'update', 'delete'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰ç‰¹å®šæƒé™")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("has_permission")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" resource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" action"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" role "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("roles"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" permission "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" role"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("permissions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" permission"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" resource "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("and")]),s._v(" permission"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("action "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" action"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h3",{attrs:{id:"mcpä¸­çš„æƒé™å®ç°ç­–ç•¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mcpä¸­çš„æƒé™å®ç°ç­–ç•¥"}},[s._v("#")]),s._v(" MCPä¸­çš„æƒé™å®ç°ç­–ç•¥")]),s._v(" "),t("h4",{attrs:{id:"_1-å£°æ˜å¼æƒé™æ§åˆ¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-å£°æ˜å¼æƒé™æ§åˆ¶"}},[s._v("#")]),s._v(" 1. å£°æ˜å¼æƒé™æ§åˆ¶")]),s._v(" "),t("p",[s._v("åœ¨MCPä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ³¨è§£æˆ–è£…é¥°å™¨æ¥å®ç°å£°æ˜å¼æƒé™æ§åˆ¶ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Javaç¤ºä¾‹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@PreAuthorize")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"hasPermission('order', 'create')\"")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("createOrder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderRequest")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ›å»ºè®¢å•é€»è¾‘")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" orderService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("createOrder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h4",{attrs:{id:"_2-æ•°æ®è¿‡æ»¤æƒé™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-æ•°æ®è¿‡æ»¤æƒé™"}},[s._v("#")]),s._v(" 2. æ•°æ®è¿‡æ»¤æƒé™")]),s._v(" "),t("p",[s._v("åœ¨æ•°æ®æŸ¥è¯¢æ—¶ï¼Œè‡ªåŠ¨åº”ç”¨æƒé™è¿‡æ»¤ï¼š")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- è‡ªåŠ¨æ·»åŠ ç§Ÿæˆ·IDå’Œæƒé™è¿‡æ»¤æ¡ä»¶")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" orders \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" tenant_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" :tenantId \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("created_by "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" :userId "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("OR")]),s._v(" has_permission"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(":userId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'order'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'read'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"_3-uiçº§æƒé™æ§åˆ¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-uiçº§æƒé™æ§åˆ¶"}},[s._v("#")]),s._v(" 3. UIçº§æƒé™æ§åˆ¶")]),s._v(" "),t("p",[s._v("åœ¨å‰ç«¯å®ç°åŸºäºæƒé™çš„UIæ§åˆ¶ï¼š")]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Vue.jsç¤ºä¾‹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("template"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("div v"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"hasPermission('order', 'create')\"")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("button @click"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"showCreateOrderDialog"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("åˆ›å»ºè®¢å•"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("button"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("div"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("template"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("script"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("methods")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hasPermission")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("resource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" action")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("$store"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("getters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hasPermission")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" action"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("script"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h2",{attrs:{id:"mcpå¤šç§Ÿæˆ·æœ€ä½³å®è·µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mcpå¤šç§Ÿæˆ·æœ€ä½³å®è·µ"}},[s._v("#")]),s._v(" MCPå¤šç§Ÿæˆ·æœ€ä½³å®è·µ")]),s._v(" "),t("h3",{attrs:{id:"_1-æ•°æ®éš”ç¦»ç­–ç•¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-æ•°æ®éš”ç¦»ç­–ç•¥"}},[s._v("#")]),s._v(" 1. æ•°æ®éš”ç¦»ç­–ç•¥")]),s._v(" "),t("p",[s._v("ç¡®ä¿æ•°æ®éš”ç¦»æ˜¯å¤šç§Ÿæˆ·æ¶æ„çš„æ ¸å¿ƒã€‚ä»¥ä¸‹æ˜¯å‡ ç§æœ‰æ•ˆçš„æ•°æ®éš”ç¦»ç­–ç•¥ï¼š")]),s._v(" "),t("h4",{attrs:{id:"ç§Ÿæˆ·ä¸Šä¸‹æ–‡ä¼ é€’"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç§Ÿæˆ·ä¸Šä¸‹æ–‡ä¼ é€’"}},[s._v("#")]),s._v(" ç§Ÿæˆ·ä¸Šä¸‹æ–‡ä¼ é€’")]),s._v(" "),t("p",[s._v("åœ¨æ¯ä¸ªè¯·æ±‚ä¸­ä¼ é€’ç§Ÿæˆ·ä¸Šä¸‹æ–‡ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä½¿ç”¨çº¿ç¨‹å±€éƒ¨å˜é‡å­˜å‚¨å½“å‰ç§Ÿæˆ·ID")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ThreadLocal")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CURRENT_TENANT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ThreadLocal")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setCurrentTenant")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" tenantId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CURRENT_TENANT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tenantId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCurrentTenant")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CURRENT_TENANT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h4",{attrs:{id:"è‡ªåŠ¨ç§Ÿæˆ·è¿‡æ»¤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è‡ªåŠ¨ç§Ÿæˆ·è¿‡æ»¤"}},[s._v("#")]),s._v(" è‡ªåŠ¨ç§Ÿæˆ·è¿‡æ»¤")]),s._v(" "),t("p",[s._v("å®ç°è‡ªåŠ¨ç§Ÿæˆ·è¿‡æ»¤çš„æ‹¦æˆªå™¨ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TenantFilter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Filter")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("doFilter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletRequest")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletResponse")]),s._v(" response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FilterChain")]),s._v(" chain"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")]),s._v(" httpRequest "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" tenantId "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" httpRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getHeader")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"X-Tenant-ID"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®¾ç½®å½“å‰ç§Ÿæˆ·ä¸Šä¸‹æ–‡")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setCurrentTenant")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tenantId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            chain"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("doFilter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¸…ç†ç§Ÿæˆ·ä¸Šä¸‹æ–‡")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("clearCurrentTenant")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h3",{attrs:{id:"_2-ç¼“å­˜ç­–ç•¥ä¼˜åŒ–"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-ç¼“å­˜ç­–ç•¥ä¼˜åŒ–"}},[s._v("#")]),s._v(" 2. ç¼“å­˜ç­–ç•¥ä¼˜åŒ–")]),s._v(" "),t("p",[s._v("å¤šç§Ÿæˆ·ç¯å¢ƒä¸‹çš„ç¼“å­˜éœ€è¦ç‰¹åˆ«æ³¨æ„éš”ç¦»æ€§ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä½¿ç”¨ç§Ÿæˆ·IDä½œä¸ºç¼“å­˜é”®å‰ç¼€")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCacheKey")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" tenantId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" tenantId "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('":"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç¤ºä¾‹ä½¿ç”¨")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" productKey "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCacheKey")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"product:123"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCurrentTenant")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Product")]),s._v(" product "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cache"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("productKey"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"_3-ç›‘æ§ä¸æ—¥å¿—"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-ç›‘æ§ä¸æ—¥å¿—"}},[s._v("#")]),s._v(" 3. ç›‘æ§ä¸æ—¥å¿—")]),s._v(" "),t("p",[s._v("å®ç°ç§Ÿæˆ·çº§åˆ«çš„ç›‘æ§å’Œæ—¥å¿—ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä½¿ç”¨MDCï¼ˆMapped Diagnostic Contextï¼‰è®°å½•ç§Ÿæˆ·ä¿¡æ¯")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MDC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tenantId"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCurrentTenant")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ—¥å¿—è¾“å‡ºç¤ºä¾‹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2026-01-30 10:15:30 [main] INFO com.example.service.OrderService - Created order for tenant: tenant123")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"mcpæƒé™ç®¡ç†è¿›é˜¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mcpæƒé™ç®¡ç†è¿›é˜¶"}},[s._v("#")]),s._v(" MCPæƒé™ç®¡ç†è¿›é˜¶")]),s._v(" "),t("h3",{attrs:{id:"åŠ¨æ€æƒé™æ§åˆ¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åŠ¨æ€æƒé™æ§åˆ¶"}},[s._v("#")]),s._v(" åŠ¨æ€æƒé™æ§åˆ¶")]),s._v(" "),t("p",[s._v("åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å®ç°åŠ¨æ€æƒé™æ§åˆ¶ï¼Œä¾‹å¦‚åŸºäºæ•°æ®æ‰€æœ‰æƒçš„æƒé™ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@PreAuthorize")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"hasPermission(#orderId, 'order', 'read') or hasRole('ADMIN')\"")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getOrder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" orderId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è·å–è®¢å•é€»è¾‘")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" orderService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getOrder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("orderId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"æƒé™ç»§æ‰¿ä¸ç»„åˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æƒé™ç»§æ‰¿ä¸ç»„åˆ"}},[s._v("#")]),s._v(" æƒé™ç»§æ‰¿ä¸ç»„åˆ")]),s._v(" "),t("p",[s._v("å®ç°è§’è‰²ç»§æ‰¿å’Œæƒé™ç»„åˆï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è§’è‰²ç»§æ‰¿")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Role")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Role")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" inheritsFrom "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hasPermission")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" resource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" action"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ£€æŸ¥å½“å‰è§’è‰²çš„æƒé™")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Permission")]),s._v(" permission "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" permissions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("permission"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("matches")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" action"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ£€æŸ¥ç»§æ‰¿è§’è‰²çš„æƒé™")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Role")]),s._v(" role "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" inheritsFrom"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("role"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hasPermission")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" action"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("h3",{attrs:{id:"å®¡è®¡æ—¥å¿—"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®¡è®¡æ—¥å¿—"}},[s._v("#")]),s._v(" å®¡è®¡æ—¥å¿—")]),s._v(" "),t("p",[s._v("å®ç°å…¨é¢çš„æƒé™å®¡è®¡æ—¥å¿—ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Aspect")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Component")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PermissionAuditAspect")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@AfterReturning")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"execution(* com.example..*(..)) && @annotation(preAuthorize)"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("auditPermission")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JoinPoint")]),s._v(" joinPoint"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PreAuthorize")]),s._v(" preAuthorize"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" tenantId "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCurrentTenant")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" username "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCurrentUser")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" method "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" joinPoint"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getSignature")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®°å½•æƒé™å®¡è®¡æ—¥å¿—")]),s._v("\n        auditService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("logPermissionUsage")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tenantId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" method"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h2",{attrs:{id:"ç»“è¯­"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç»“è¯­"}},[s._v("#")]),s._v(" ç»“è¯­")]),s._v(" "),t("p",[s._v("å¤šç§Ÿæˆ·ä¸æƒé™ç®¡ç†æ˜¯æ„å»ºä¼ä¸šçº§MCPåº”ç”¨ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ã€‚é€šè¿‡åˆç†çš„è®¾è®¡å’Œå®ç°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¿è¯æ•°æ®å®‰å…¨çš„åŒæ—¶ï¼Œæä¾›çµæ´»çš„æƒé™æ§åˆ¶æœºåˆ¶ã€‚")]),s._v(" "),t("p",[s._v("ğŸ— æ„å»ºä¸€ä¸ªå®Œå–„çš„å¤šç§Ÿæˆ·æƒé™ç³»ç»Ÿéœ€è¦è€ƒè™‘å¤šä¸ªæ–¹é¢ï¼Œä»æ•°æ®éš”ç¦»åˆ°æƒé™æ§åˆ¶ï¼Œä»ç¼“å­˜ç­–ç•¥åˆ°å®¡è®¡æ—¥å¿—ã€‚ä½†æ­£æ˜¯è¿™äº›ç»†èŠ‚ï¼Œå†³å®šäº†ä½ çš„åº”ç”¨æ˜¯å¦èƒ½å¤ŸçœŸæ­£æ»¡è¶³ä¼ä¸šçº§éœ€æ±‚ã€‚")]),s._v(" "),t("p",[s._v("ğŸ’¡ è®°ä½ï¼Œæƒé™ç®¡ç†ä¸æ˜¯ä¸€æ¬¡æ€§å·¥ä½œï¼Œè€Œæ˜¯ä¸€ä¸ªæŒç»­æ¼”è¿›çš„è¿‡ç¨‹ã€‚éšç€ä¸šåŠ¡çš„å‘å±•å’Œéœ€æ±‚çš„å˜åŒ–ï¼Œä½ éœ€è¦ä¸æ–­ä¼˜åŒ–å’Œå®Œå–„ä½ çš„æƒé™ç³»ç»Ÿã€‚")]),s._v(" "),t("p",[s._v("å¸Œæœ›ä»Šå¤©çš„åˆ†äº«èƒ½å¤Ÿå¸®åŠ©å¤§å®¶åœ¨MCPå¼€å‘ä¸­æ›´å¥½åœ°å®ç°å¤šç§Ÿæˆ·ä¸æƒé™ç®¡ç†ã€‚å¦‚æœæœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµè®¨è®ºï¼")]),s._v(" "),t("blockquote",[t("p",[s._v('"å®‰å…¨ä¸æ˜¯ç»ˆç‚¹ï¼Œè€Œæ˜¯ä¸€æ®µæ—…ç¨‹ã€‚åœ¨å¤šç§Ÿæˆ·æ¶æ„ä¸­ï¼Œæƒé™ç®¡ç†å°±æ˜¯æˆ‘ä»¬åœ¨è¿™æ®µæ—…ç¨‹ä¸­çš„æŒ‡å—é’ˆã€‚"')])])])}),[],!1,null,null,null);t.default=e.exports}}]);