(window.webpackJsonp=window.webpackJsonp||[]).push([[553],{908:function(s,a,t){"use strict";t.r(a);var n=t(15),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"å‰è¨€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[s._v("#")]),s._v(" å‰è¨€")]),s._v(" "),a("p",[s._v('åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ¶ˆæ¯é˜Ÿåˆ—æ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ã€‚å®ƒä»¬å°±åƒç³»ç»Ÿé—´çš„"é‚®å±€"ï¼Œè´Ÿè´£åœ¨å„ä¸ªæœåŠ¡ä¹‹é—´ä¼ é€’ä¿¡æ¯å’Œåè°ƒå·¥ä½œã€‚ğŸ“¡ ç„¶è€Œï¼Œå½“æˆ‘ä»¬éœ€è¦ç¡®ä¿ä¸€ç³»åˆ—æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥æ—¶ï¼Œæ™®é€šçš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶å°±æ˜¾å¾—åŠ›ä¸ä»å¿ƒäº†ã€‚è¿™å°±æ˜¯äº‹åŠ¡æ€§æ¶ˆæ¯å¤§æ˜¾èº«æ‰‹çš„èˆå°ï¼')]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("æç¤º")]),s._v(" "),a("p",[s._v("äº‹åŠ¡æ€§æ¶ˆæ¯æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿä¸­çš„é«˜çº§ç‰¹æ€§ï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†æ¶ˆæ¯å‘é€ä¸ä¸šåŠ¡äº‹åŠ¡ç»‘å®šï¼Œç¡®ä¿ä¸šåŠ¡æµç¨‹çš„åŸå­æ€§å’Œä¸€è‡´æ€§ã€‚")])]),s._v(" "),a("p",[s._v("ä»Šå¤©ï¼Œæˆ‘æƒ³å’Œå¤§å®¶èŠèŠæ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„äº‹åŠ¡æ€§æ¶ˆæ¯è¿™ä¸ªè¯é¢˜ï¼Œæ¢è®¨å®ƒæ˜¯å¦‚ä½•å¸®åŠ©æˆ‘ä»¬æ„å»ºæ›´åŠ å¯é çš„åˆ†å¸ƒå¼ç³»ç»Ÿçš„ã€‚")]),s._v(" "),a("h2",{attrs:{id:"ä¸ºä»€ä¹ˆéœ€è¦äº‹åŠ¡æ€§æ¶ˆæ¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆéœ€è¦äº‹åŠ¡æ€§æ¶ˆæ¯"}},[s._v("#")]),s._v(" ä¸ºä»€ä¹ˆéœ€è¦äº‹åŠ¡æ€§æ¶ˆæ¯ï¼Ÿ")]),s._v(" "),a("p",[s._v("æƒ³è±¡ä¸€ä¸‹è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šç”¨æˆ·ä¸‹å•åï¼Œæˆ‘ä»¬éœ€è¦æ‰£å‡åº“å­˜ã€åˆ›å»ºè®¢å•è®°å½•ã€å‘é€é€šçŸ¥é‚®ä»¶ç­‰å¤šä¸ªæ­¥éª¤ã€‚åœ¨ä¼ ç»Ÿæ¶æ„ä¸­ï¼Œè¿™äº›æ“ä½œå¯èƒ½åˆ†æ•£åœ¨ä¸åŒçš„æœåŠ¡ä¸­ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ç”¨æˆ·ä¸‹å• â†’ è®¢å•æœåŠ¡ â†’ åº“å­˜æœåŠ¡ â†’ é€šçŸ¥æœåŠ¡\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("å¦‚æœè®¢å•æœåŠ¡æˆåŠŸåˆ›å»ºè®¢å•åï¼Œåº“å­˜æœåŠ¡å´å› ä¸ºæŸç§åŸå› å¤±è´¥äº†ï¼Œå°±ä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µâ€”â€”è®¢å•å­˜åœ¨äº†ï¼Œä½†åº“å­˜æ²¡æœ‰æ‰£å‡ã€‚ğŸ˜±")]),s._v(" "),a("p",[s._v("æ™®é€šçš„æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥ä¿è¯æ¶ˆæ¯çš„æŠ•é€’ï¼Œä½†æ— æ³•ä¿è¯æ¶ˆæ¯å‘é€å‰çš„ä¸šåŠ¡æ“ä½œå’Œæ¶ˆæ¯æŠ•é€’çš„åŸå­æ€§ã€‚è¿™å°±æ˜¯äº‹åŠ¡æ€§æ¶ˆæ¯è¦è§£å†³çš„é—®é¢˜ã€‚")]),s._v(" "),a("h2",{attrs:{id:"äº‹åŠ¡æ€§æ¶ˆæ¯çš„å·¥ä½œåŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äº‹åŠ¡æ€§æ¶ˆæ¯çš„å·¥ä½œåŸç†"}},[s._v("#")]),s._v(" äº‹åŠ¡æ€§æ¶ˆæ¯çš„å·¥ä½œåŸç†")]),s._v(" "),a("p",[s._v('äº‹åŠ¡æ€§æ¶ˆæ¯çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†"ä¸šåŠ¡æ“ä½œ"å’Œ"æ¶ˆæ¯å‘é€"æ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œç¡®ä¿å®ƒä»¬è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚')]),s._v(" "),a("h3",{attrs:{id:"ä¸¤é˜¶æ®µæäº¤æ¨¡å¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸¤é˜¶æ®µæäº¤æ¨¡å¼"}},[s._v("#")]),s._v(" ä¸¤é˜¶æ®µæäº¤æ¨¡å¼")]),s._v(" "),a("p",[s._v("å¤§å¤šæ•°æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿé‡‡ç”¨ä¸¤é˜¶æ®µæäº¤æ¨¡å¼æ¥å®ç°äº‹åŠ¡æ€§æ¶ˆæ¯ï¼š")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("å‡†å¤‡é˜¶æ®µ")]),s._v('ï¼šå‘é€æ–¹å°†æ¶ˆæ¯æ ‡è®°ä¸º"å¾…å‘é€"çŠ¶æ€ï¼Œä½†ä¸ç«‹å³æŠ•é€’ç»™æ¶ˆè´¹è€…ã€‚')]),s._v(" "),a("li",[a("strong",[s._v("æäº¤é˜¶æ®µ")]),s._v('ï¼šå½“ä¸šåŠ¡æ“ä½œæˆåŠŸæäº¤åï¼Œå°†æ¶ˆæ¯çŠ¶æ€æ›´æ–°ä¸º"å·²å‘é€"ï¼ŒæŠ•é€’ç»™æ¶ˆè´¹è€…ã€‚')])]),s._v(" "),a("p",[s._v("ä»¥RocketMQä¸ºä¾‹ï¼Œäº‹åŠ¡æ€§æ¶ˆæ¯çš„æµç¨‹å¦‚ä¸‹ï¼š")]),s._v(" "),a("div",{staticClass:"language-mermaid line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("graph")]),s._v(" TD\n    A"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("[ä¸šåŠ¡å¼€å§‹]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e")]),s._v(" B"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("[å‘é€åŠæ¶ˆæ¯]")]),s._v("\n    B "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e")]),s._v(" C"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("[æ‰§è¡Œæœ¬åœ°äº‹åŠ¡]")]),s._v("\n    C "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e")]),s._v(" D"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("{äº‹åŠ¡ç»“æœ}")]),s._v("\n    D "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v("|æˆåŠŸ|")]),s._v(" E"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("[æäº¤æ¶ˆæ¯]")]),s._v("\n    D "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e")]),a("span",{pre:!0,attrs:{class:"token label property"}},[s._v("|å¤±è´¥|")]),s._v(" F"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("[å›æ»šæ¶ˆæ¯]")]),s._v("\n    E "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e")]),s._v(" G"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("[æ¶ˆè´¹è€…æ¥æ”¶æ¶ˆæ¯]")]),s._v("\n    F "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e")]),s._v(" H"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("[æ¶ˆæ¯è¢«åˆ é™¤]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"äº‹åŠ¡æ€§æ¶ˆæ¯çš„çŠ¶æ€ç®¡ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äº‹åŠ¡æ€§æ¶ˆæ¯çš„çŠ¶æ€ç®¡ç†"}},[s._v("#")]),s._v(" äº‹åŠ¡æ€§æ¶ˆæ¯çš„çŠ¶æ€ç®¡ç†")]),s._v(" "),a("p",[s._v("äº‹åŠ¡æ€§æ¶ˆæ¯é€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§çŠ¶æ€ï¼š")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("TransactionStatus.UNKNOWN")]),s._v("ï¼šæœªçŸ¥çŠ¶æ€ï¼Œéœ€è¦æ£€æŸ¥")]),s._v(" "),a("li",[a("code",[s._v("TransactionStatus.COMMIT_MESSAGE")]),s._v("ï¼šæäº¤æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…å¯ä»¥æ¶ˆè´¹")]),s._v(" "),a("li",[a("code",[s._v("TransactionStatus.ROLLBACK_MESSAGE")]),s._v("ï¼šå›æ»šæ¶ˆæ¯ï¼Œæ¶ˆæ¯å°†è¢«åˆ é™¤")])]),s._v(" "),a("h2",{attrs:{id:"å®ç°äº‹åŠ¡æ€§æ¶ˆæ¯çš„æŒ‘æˆ˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®ç°äº‹åŠ¡æ€§æ¶ˆæ¯çš„æŒ‘æˆ˜"}},[s._v("#")]),s._v(" å®ç°äº‹åŠ¡æ€§æ¶ˆæ¯çš„æŒ‘æˆ˜")]),s._v(" "),a("p",[s._v("è™½ç„¶äº‹åŠ¡æ€§å¬èµ·æ¥å¾ˆç¾å¥½ï¼Œä½†åœ¨å®é™…å®ç°ä¸­ï¼Œæˆ‘ä»¬ä¼šé¢ä¸´ä¸å°‘æŒ‘æˆ˜ï¼š")]),s._v(" "),a("h3",{attrs:{id:"_1-å¹‚ç­‰æ€§é—®é¢˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-å¹‚ç­‰æ€§é—®é¢˜"}},[s._v("#")]),s._v(" 1. å¹‚ç­‰æ€§é—®é¢˜")]),s._v(" "),a("p",[s._v("ç”±äºç½‘ç»œé—®é¢˜æˆ–å…¶ä»–åŸå› ï¼Œæ¶ˆæ¯å¯èƒ½ä¼šè¢«é‡å¤æŠ•é€’ã€‚å¦‚æœæ¶ˆè´¹è€…æ²¡æœ‰æ­£ç¡®å¤„ç†å¹‚ç­‰æ€§ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("è§£å†³æ–¹æ¡ˆ")]),s._v("ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("ä¸ºæ¯ä¸ªæ¶ˆæ¯ç”Ÿæˆå”¯ä¸€ID")]),s._v(" "),a("li",[s._v("åœ¨æ¶ˆè´¹å‰æ£€æŸ¥è¯¥IDæ˜¯å¦å·²è¢«å¤„ç†")]),s._v(" "),a("li",[s._v("ä½¿ç”¨æ•°æ®åº“å”¯ä¸€çº¦æŸé˜²æ­¢é‡å¤æ“ä½œ")])]),s._v(" "),a("h3",{attrs:{id:"_2-äº‹åŠ¡è¶…æ—¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-äº‹åŠ¡è¶…æ—¶"}},[s._v("#")]),s._v(" 2. äº‹åŠ¡è¶…æ—¶")]),s._v(" "),a("p",[s._v("å¦‚æœä¸šåŠ¡äº‹åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œå¯èƒ½ä¼šå¯¼è‡´äº‹åŠ¡æ€§æ¶ˆæ¯è¶…æ—¶ï¼Œä»è€Œè¢«ç³»ç»Ÿå›æ»šã€‚")]),s._v(" "),a("p",[a("strong",[s._v("è§£å†³æ–¹æ¡ˆ")]),s._v("ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´")]),s._v(" "),a("li",[s._v("å°†é•¿äº‹åŠ¡æ‹†åˆ†ä¸ºå¤šä¸ªçŸ­äº‹åŠ¡")]),s._v(" "),a("li",[s._v("ä½¿ç”¨è¡¥å¿äº‹åŠ¡å¤„ç†è¶…æ—¶æƒ…å†µ")])]),s._v(" "),a("h3",{attrs:{id:"_3-åˆ†å¸ƒå¼äº‹åŠ¡çš„å¤æ‚æ€§"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-åˆ†å¸ƒå¼äº‹åŠ¡çš„å¤æ‚æ€§"}},[s._v("#")]),s._v(" 3. åˆ†å¸ƒå¼äº‹åŠ¡çš„å¤æ‚æ€§")]),s._v(" "),a("p",[s._v("äº‹åŠ¡æ€§æ¶ˆæ¯æœ¬è´¨ä¸Šæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¸€ç§å®ç°ï¼Œå®ƒä»ç„¶é¢ä¸´ç€åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ‰€æœ‰æŒ‘æˆ˜ï¼Œå¦‚ç½‘ç»œåˆ†åŒºã€èŠ‚ç‚¹æ•…éšœç­‰ã€‚")]),s._v(" "),a("h2",{attrs:{id:"ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—çš„äº‹åŠ¡æ€§æ¶ˆæ¯å®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—çš„äº‹åŠ¡æ€§æ¶ˆæ¯å®ç°"}},[s._v("#")]),s._v(" ä¸»æµæ¶ˆæ¯é˜Ÿåˆ—çš„äº‹åŠ¡æ€§æ¶ˆæ¯å®ç°")]),s._v(" "),a("h3",{attrs:{id:"rocketmqçš„äº‹åŠ¡æ€§æ¶ˆæ¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rocketmqçš„äº‹åŠ¡æ€§æ¶ˆæ¯"}},[s._v("#")]),s._v(" RocketMQçš„äº‹åŠ¡æ€§æ¶ˆæ¯")]),s._v(" "),a("p",[s._v("RocketMQæä¾›äº†å®Œæ•´çš„äº‹åŠ¡æ€§æ¶ˆæ¯æ”¯æŒï¼Œå…¶æ ¸å¿ƒAPIå¦‚ä¸‹ï¼š")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‘é€äº‹åŠ¡æ€§æ¶ˆæ¯")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransactionSendResult")]),s._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" producer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sendMessageInTransaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" arg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// äº‹åŠ¡ç›‘å¬å™¨")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TransactionListener")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ‰§è¡Œæœ¬åœ°äº‹åŠ¡")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalTransactionState")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("executeLocalTransaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Message")]),s._v(" msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" arg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ£€æŸ¥äº‹åŠ¡çŠ¶æ€")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LocalTransactionState")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkLocalTransaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MessageExt")]),s._v(" msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h3",{attrs:{id:"rabbitmqçš„äº‹åŠ¡æ€§æ¶ˆæ¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmqçš„äº‹åŠ¡æ€§æ¶ˆæ¯"}},[s._v("#")]),s._v(" RabbitMQçš„äº‹åŠ¡æ€§æ¶ˆæ¯")]),s._v(" "),a("p",[s._v("RabbitMQé€šè¿‡Publisher Confirmsæœºåˆ¶å®ç°ç±»ä¼¼çš„äº‹åŠ¡æ€§ä¿è¯ï¼š")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¯ç”¨å‘å¸ƒè€…ç¡®è®¤")]),s._v("\nchannel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("confirmSelect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ·»åŠ ç¡®è®¤ç›‘å¬å™¨")]),s._v("\nchannel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("addConfirmListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConfirmListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¶ˆæ¯ç¡®è®¤å›è°ƒ")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("handleAck")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" deliveryTag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" multiple"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†ç¡®è®¤é€»è¾‘")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¶ˆæ¯æ‹’ç»å›è°ƒ")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("handleNack")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" deliveryTag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" multiple"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†æ‹’ç»é€»è¾‘")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h3",{attrs:{id:"kafkaçš„äº‹åŠ¡æ€§æ¶ˆæ¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kafkaçš„äº‹åŠ¡æ€§æ¶ˆæ¯"}},[s._v("#")]),s._v(" Kafkaçš„äº‹åŠ¡æ€§æ¶ˆæ¯")]),s._v(" "),a("p",[s._v("Kafkaä»0.11ç‰ˆæœ¬å¼€å§‹æ”¯æŒäº‹åŠ¡æ€§æ¶ˆæ¯ï¼š")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é…ç½®äº‹åŠ¡ID")]),s._v("\nprops"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TRANSACTIONAL_ID_CONFIG")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"my-transactional-id"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆå§‹åŒ–äº‹åŠ¡")]),s._v("\nproducer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("initTransactions")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¼€å§‹äº‹åŠ¡")]),s._v("\nproducer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("beginTransaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‘é€æ¶ˆæ¯")]),s._v("\n    producer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("record1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    producer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("record2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æäº¤äº‹åŠ¡")]),s._v("\n    producer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("commitTransaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¸­æ­¢äº‹åŠ¡")]),s._v("\n    producer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("abortTransaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h2",{attrs:{id:"å®é™…åº”ç”¨åœºæ™¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å®é™…åº”ç”¨åœºæ™¯"}},[s._v("#")]),s._v(" å®é™…åº”ç”¨åœºæ™¯")]),s._v(" "),a("h3",{attrs:{id:"_1-ç”µå•†ä¸‹å•æµç¨‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-ç”µå•†ä¸‹å•æµç¨‹"}},[s._v("#")]),s._v(" 1. ç”µå•†ä¸‹å•æµç¨‹")]),s._v(" "),a("p",[s._v("åœ¨ç”µå•†ç³»ç»Ÿä¸­ï¼Œä¸‹å•æµç¨‹æ¶‰åŠå¤šä¸ªæœåŠ¡ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ç”¨æˆ·ä¸‹å• â†’ åˆ›å»ºè®¢å• â†’ æ‰£å‡åº“å­˜ â†’ ç”Ÿæˆæ”¯ä»˜å• â†’ å‘é€é€šçŸ¥\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v('ä½¿ç”¨äº‹åŠ¡æ€§æ¶ˆæ¯å¯ä»¥ç¡®ä¿è¿™äº›æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼Œé¿å…å‡ºç°"è®¢å•å·²åˆ›å»ºä½†åº“å­˜æœªæ‰£å‡"ç­‰é—®é¢˜ã€‚')]),s._v(" "),a("h3",{attrs:{id:"_2-é‡‘èè½¬è´¦"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-é‡‘èè½¬è´¦"}},[s._v("#")]),s._v(" 2. é‡‘èè½¬è´¦")]),s._v(" "),a("p",[s._v("åœ¨é“¶è¡Œç³»ç»Ÿä¸­ï¼Œä»è´¦æˆ·Aè½¬è´¦åˆ°è´¦æˆ·Béœ€è¦ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("æ£€æŸ¥è´¦æˆ·Aä½™é¢ â†’ å†»ç»“è´¦æˆ·Aèµ„é‡‘ â†’ å¢åŠ è´¦æˆ·Bä½™é¢ â†’ è®°å½•è½¬è´¦æ—¥å¿—\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("ä»»ä½•ä¸€æ­¥å¤±è´¥éƒ½åº”è¯¥å¯¼è‡´æ•´ä¸ªæ“ä½œå›æ»šï¼Œäº‹åŠ¡æ€§æ¶ˆæ¯å¯ä»¥å¾ˆå¥½åœ°ä¿è¯è¿™ç§ä¸€è‡´æ€§ã€‚")]),s._v(" "),a("h3",{attrs:{id:"_3-æ•°æ®åŒæ­¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-æ•°æ®åŒæ­¥"}},[s._v("#")]),s._v(" 3. æ•°æ®åŒæ­¥")]),s._v(" "),a("p",[s._v("å½“éœ€è¦å°†æ•°æ®ä»ä¸»ç³»ç»ŸåŒæ­¥åˆ°å¤šä¸ªå­ç³»ç»Ÿæ—¶ï¼Œäº‹åŠ¡æ€§æ¶ˆæ¯å¯ä»¥ç¡®ä¿æ‰€æœ‰å­ç³»ç»Ÿè¦ä¹ˆéƒ½æ”¶åˆ°æœ€æ–°æ•°æ®ï¼Œéƒ½ä¸æ”¶åˆ°ã€‚")]),s._v(" "),a("h2",{attrs:{id:"æœ€ä½³å®è·µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æœ€ä½³å®è·µ"}},[s._v("#")]),s._v(" æœ€ä½³å®è·µ")]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´")]),s._v("ï¼šæ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è®¾ç½®åˆç†çš„æ¶ˆæ¯è¶…æ—¶æ—¶é—´ï¼Œé¿å…å› äº‹åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿å¯¼è‡´æ¶ˆæ¯å›æ»šã€‚")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("å®ç°å¹‚ç­‰æ€§")]),s._v("ï¼šæ¶ˆè´¹è€…å¿…é¡»å®ç°å¹‚ç­‰æ€§ï¼Œä»¥åº”å¯¹æ¶ˆæ¯é‡å¤æŠ•é€’çš„æƒ…å†µã€‚")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("ç›‘æ§äº‹åŠ¡çŠ¶æ€")]),s._v("ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§æœºåˆ¶ï¼ŒåŠæ—¶å‘ç°å’Œå¤„ç†äº‹åŠ¡å¼‚å¸¸ã€‚")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("é¿å…é•¿äº‹åŠ¡")]),s._v("ï¼šå°½é‡å°†äº‹åŠ¡æ§åˆ¶åœ¨åˆç†çš„æ—¶é—´èŒƒå›´å†…ï¼Œé¿å…é•¿æ—¶é—´å ç”¨èµ„æºã€‚")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("åˆç†ä½¿ç”¨é‡è¯•æœºåˆ¶")]),s._v("ï¼šå¯¹äºå¤±è´¥çš„äº‹åŠ¡ï¼Œå¯ä»¥å®ç°è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼Œä½†è¦æ³¨æ„è®¾ç½®é‡è¯•ä¸Šé™å’Œé—´éš”ã€‚")])])]),s._v(" "),a("h2",{attrs:{id:"ç»“è¯­"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç»“è¯­"}},[s._v("#")]),s._v(" ç»“è¯­")]),s._v(" "),a("p",[s._v("äº‹åŠ¡æ€§æ¶ˆæ¯æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è§£å†³ä¸šåŠ¡ä¸€è‡´æ€§çš„é‡è¦å·¥å…·ã€‚å®ƒé€šè¿‡å°†æ¶ˆæ¯å‘é€ä¸ä¸šåŠ¡äº‹åŠ¡ç»‘å®šï¼Œç¡®ä¿äº†ä¸€ç³»åˆ—æ“ä½œçš„åŸå­æ€§ã€‚è™½ç„¶å®ç°äº‹åŠ¡æ€§æ¶ˆæ¯é¢ä¸´ä¸€äº›æŒ‘æˆ˜ï¼Œä½†åªè¦æˆ‘ä»¬æŒæ¡äº†æ­£ç¡®çš„å®ç°æ–¹æ³•å’Œæœ€ä½³å®è·µï¼Œå°±èƒ½æ„å»ºå‡ºæ›´åŠ å¯é ã€ä¸€è‡´çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚")]),s._v(" "),a("p",[s._v("åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„æ¶ˆæ¯é˜Ÿåˆ—å’Œäº‹åŠ¡æ€§æ¶ˆæ¯å®ç°æ–¹å¼ï¼Œå¹¶æ³¨æ„å¤„ç†å¯èƒ½å‡ºç°çš„å„ç§å¼‚å¸¸æƒ…å†µã€‚åªæœ‰è¿™æ ·ï¼Œæ‰èƒ½çœŸæ­£å‘æŒ¥äº‹åŠ¡æ€§æ¶ˆæ¯çš„ä»·å€¼ï¼Œä¸ºæˆ‘ä»¬çš„ç³»ç»Ÿä¿é©¾æŠ¤èˆªã€‚")]),s._v(" "),a("blockquote",[a("p",[s._v('æ­£å¦‚è®¡ç®—æœºç§‘å­¦å®¶Leslie Lamportæ‰€è¯´ï¼š"åˆ†å¸ƒå¼ç³»ç»Ÿçš„å”¯ä¸€é—®é¢˜å°±æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„å­˜åœ¨ã€‚" äº‹åŠ¡æ€§æ¶ˆæ¯ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ä¼˜é›…çš„æ–¹å¼æ¥åº”å¯¹è¿™ä¸€æŒ‘æˆ˜ã€‚')])]),s._v(" "),a("p",[s._v("å¸Œæœ›ä»Šå¤©çš„åˆ†äº«å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–æƒ³æ³•ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµè®¨è®ºã€‚ğŸ‘‹")])])}),[],!1,null,null,null);a.default=e.exports}}]);