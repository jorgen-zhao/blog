(window.webpackJsonp=window.webpackJsonp||[]).push([[272],{623:function(s,t,a){"use strict";a.r(t);var n=a(15),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"å‰è¨€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[s._v("#")]),s._v(" å‰è¨€")]),s._v(" "),t("p",[s._v("åœ¨æ·±å…¥äº†è§£Flinkçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°å¾ˆå¤šåˆå­¦è€…å’Œæˆ‘ä¸€æ ·ï¼Œä¸€å¼€å§‹ä¼šè¿‡äºå…³æ³¨Flinkçš„APIå’Œæ“ä½œç¬¦ï¼Œè€Œå¿½ç•¥äº†å¦ä¸€ä¸ªè‡³å…³é‡è¦çš„æ¦‚å¿µâ€”â€”çŠ¶æ€ç®¡ç†ï¼ˆState Managementï¼‰ã€‚ğŸ¤”")]),s._v(" "),t("p",[s._v("å®é™…ä¸Šï¼ŒçŠ¶æ€ç®¡ç†æ˜¯æµå¤„ç†åº”ç”¨çš„æ ¸å¿ƒæ”¯æŸ±ï¼Œå®ƒèµ‹äºˆäº†Flinkå¤„ç†å¤æ‚ä¸šåŠ¡é€»è¾‘çš„èƒ½åŠ›ã€‚æ²¡æœ‰çŠ¶æ€ç®¡ç†ï¼Œæµå¤„ç†å°†å¤±å»å¤§éƒ¨åˆ†ä»·å€¼ã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³å’Œå¤§å®¶ä¸€èµ·æ·±å…¥æ¢è®¨Flinkçš„çŠ¶æ€ç®¡ç†æœºåˆ¶ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•æ”¯æ’‘èµ·æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­çš„å„ç§å¤æ‚åœºæ™¯çš„ã€‚")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("æç¤º")]),s._v(" "),t("p",[s._v("çŠ¶æ€ç®¡ç†æ˜¯åŒºåˆ†ç®€å•æµå¤„ç†å’Œå¤æ‚æµå¤„ç†åº”ç”¨çš„å…³é”®ã€‚å®ƒå…è®¸æˆ‘ä»¬åœ¨å¤„ç†æ•°æ®æµæ—¶ç»´æŠ¤å’Œè®¿é—®çŠ¶æ€ï¼Œä»è€Œå®ç°è®¡æ•°ã€èšåˆã€è¿æ¥ç­‰å¤æ‚æ“ä½œã€‚")])]),s._v(" "),t("h2",{attrs:{id:"flinkçŠ¶æ€ç®¡ç†æ¦‚è¿°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#flinkçŠ¶æ€ç®¡ç†æ¦‚è¿°"}},[s._v("#")]),s._v(" FlinkçŠ¶æ€ç®¡ç†æ¦‚è¿°")]),s._v(" "),t("p",[s._v("åœ¨Flinkä¸­ï¼ŒçŠ¶æ€ï¼ˆStateï¼‰æ˜¯è®¡ç®—è¿‡ç¨‹ä¸­çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®è¢«å­˜å‚¨å¹¶å¯ä»¥åœ¨åç»­æ“ä½œä¸­è¢«è®¿é—®ã€‚ä¸ä¼ ç»Ÿçš„æ‰¹å¤„ç†ä¸åŒï¼Œæµå¤„ç†ä¸­çš„çŠ¶æ€éœ€è¦è€ƒè™‘å®¹é”™æ€§å’Œä¸€è‡´æ€§ã€‚")]),s._v(" "),t("h3",{attrs:{id:"ä¸ºä»€ä¹ˆçŠ¶æ€ç®¡ç†å¦‚æ­¤é‡è¦"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆçŠ¶æ€ç®¡ç†å¦‚æ­¤é‡è¦"}},[s._v("#")]),s._v(" ä¸ºä»€ä¹ˆçŠ¶æ€ç®¡ç†å¦‚æ­¤é‡è¦ï¼Ÿ")]),s._v(" "),t("p",[s._v("æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ç»Ÿè®¡ç½‘ç«™è®¿é—®é‡ã€‚å¦‚æœæ²¡æœ‰çŠ¶æ€ç®¡ç†ï¼Œæˆ‘ä»¬æ¯æ¬¡åªèƒ½å¤„ç†å•ä¸ªäº‹ä»¶ï¼Œæ— æ³•ç´¯è®¡æ€»æ•°ã€‚æœ‰äº†çŠ¶æ€ç®¡ç†ï¼Œæˆ‘ä»¬å¯ä»¥ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼Œæ¯æ¬¡è®¿é—®æ—¶é€’å¢ï¼Œä»è€Œå¾—åˆ°å®æ—¶çš„è®¿é—®æ€»é‡ã€‚ğŸ“Š")]),s._v(" "),t("h3",{attrs:{id:"çŠ¶æ€çš„åŸºæœ¬ç±»å‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#çŠ¶æ€çš„åŸºæœ¬ç±»å‹"}},[s._v("#")]),s._v(" çŠ¶æ€çš„åŸºæœ¬ç±»å‹")]),s._v(" "),t("p",[s._v("Flinkä¸»è¦æ”¯æŒä¸¤ç§åŸºæœ¬çŠ¶æ€ç±»å‹ï¼š")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("ValueState")]),s._v("ï¼šå­˜å‚¨å•ä¸ªå€¼çš„çŠ¶æ€")]),s._v(" "),t("li",[t("strong",[s._v("ListState")]),s._v("ï¼šå­˜å‚¨ä¸€ä¸ªåˆ—è¡¨çš„çŠ¶æ€")])]),s._v(" "),t("p",[s._v("é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("MapState")]),s._v("ï¼šå­˜å‚¨é”®å€¼å¯¹æ˜ å°„çš„çŠ¶æ€")]),s._v(" "),t("li",[t("strong",[s._v("ReducingState")]),s._v("ï¼šå­˜å‚¨ä¸€ä¸ªå€¼ï¼Œå¹¶é€šè¿‡ç”¨æˆ·å®šä¹‰çš„reduceå‡½æ•°ä¸æ–­æ›´æ–°")]),s._v(" "),t("li",[t("strong",[s._v("AggregatingState")]),s._v("ï¼šå­˜å‚¨ä¸€ä¸ªå€¼ï¼Œå¹¶é€šè¿‡ç”¨æˆ·å®šä¹‰çš„aggregateå‡½æ•°ä¸æ–­æ›´æ–°")])]),s._v(" "),t("h2",{attrs:{id:"çŠ¶æ€åç«¯-state-backend"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#çŠ¶æ€åç«¯-state-backend"}},[s._v("#")]),s._v(" çŠ¶æ€åç«¯ï¼ˆState Backendï¼‰")]),s._v(" "),t("p",[s._v("çŠ¶æ€å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿè¿™å°±æ˜¯çŠ¶æ€åç«¯ï¼ˆState Backendï¼‰çš„ä½œç”¨ã€‚Flinkæä¾›äº†ä¸‰ç§å†…ç½®çš„çŠ¶æ€åç«¯ï¼š")]),s._v(" "),t("h3",{attrs:{id:"_1-memorystatebackend"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-memorystatebackend"}},[s._v("#")]),s._v(" 1. MemoryStateBackend")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")]),s._v(" env "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getExecutionEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nenv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setStateBackend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MemoryStateBackend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("ä¼˜ç‚¹")]),s._v("ï¼šç®€å•ã€å¿«é€Ÿ")]),s._v(" "),t("li",[t("strong",[s._v("ç¼ºç‚¹")]),s._v("ï¼šçŠ¶æ€å¤§å°æœ‰é™ï¼Œä¸é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒ")]),s._v(" "),t("li",[t("strong",[s._v("é€‚ç”¨åœºæ™¯")]),s._v("ï¼šå¼€å‘ã€è°ƒè¯•å’Œå°è§„æ¨¡åº”ç”¨")])]),s._v(" "),t("h3",{attrs:{id:"_2-fsstatebackend"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-fsstatebackend"}},[s._v("#")]),s._v(" 2. FsStateBackend")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")]),s._v(" env "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getExecutionEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nenv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setStateBackend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FsStateBackend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"file:////flink/checkpoints"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("ä¼˜ç‚¹")]),s._v("ï¼šæ”¯æŒå¤§çŠ¶æ€ï¼Œå®¹é”™æ€§å¥½")]),s._v(" "),t("li",[t("strong",[s._v("ç¼ºç‚¹")]),s._v("ï¼šéœ€è¦å¤–éƒ¨æ–‡ä»¶ç³»ç»Ÿ")]),s._v(" "),t("li",[t("strong",[s._v("é€‚ç”¨åœºæ™¯")]),s._v("ï¼šéœ€è¦å¤§çŠ¶æ€çš„åº”ç”¨")])]),s._v(" "),t("h3",{attrs:{id:"_3-rocksdbstatebackend"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-rocksdbstatebackend"}},[s._v("#")]),s._v(" 3. RocksDBStateBackend")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")]),s._v(" env "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getExecutionEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nenv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setStateBackend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RocksDBStateBackend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"file:///flink/rocksdb"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[t("strong",[s._v("ä¼˜ç‚¹")]),s._v("ï¼šæ”¯æŒè¶…å¤§çŠ¶æ€ï¼ŒåŸºäºç£ç›˜å­˜å‚¨")]),s._v(" "),t("li",[t("strong",[s._v("ç¼ºç‚¹")]),s._v("ï¼šæ¯”å†…å­˜çŠ¶æ€åç«¯æ…¢")]),s._v(" "),t("li",[t("strong",[s._v("é€‚ç”¨åœºæ™¯")]),s._v("ï¼šéœ€è¦è¶…å¤§çŠ¶æ€çš„åº”ç”¨")])]),s._v(" "),t("div",{staticClass:"custom-block theorem"},[t("p",{staticClass:"title"},[s._v("THEOREM")]),t("p",[s._v("é€‰æ‹©åˆé€‚çš„çŠ¶æ€åç«¯æ˜¯æµå¤„ç†åº”ç”¨è®¾è®¡çš„é‡è¦å†³ç­–ã€‚å®ƒç›´æ¥å½±å“åº”ç”¨çš„æ€§èƒ½ã€å®¹é”™èƒ½åŠ›å’Œèµ„æºä½¿ç”¨æ•ˆç‡ã€‚")])]),t("h2",{attrs:{id:"çŠ¶æ€ä¸€è‡´æ€§-state-consistency"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#çŠ¶æ€ä¸€è‡´æ€§-state-consistency"}},[s._v("#")]),s._v(" çŠ¶æ€ä¸€è‡´æ€§ï¼ˆState Consistencyï¼‰")]),s._v(" "),t("p",[s._v("åœ¨åˆ†å¸ƒå¼æµå¤„ç†ä¸­ï¼ŒçŠ¶æ€ä¸€è‡´æ€§æ˜¯ä¸€ä¸ªå…³é”®é—®é¢˜ã€‚Flinkæä¾›äº†ä¸‰ç§ä¸€è‡´æ€§çº§åˆ«ï¼š")]),s._v(" "),t("h3",{attrs:{id:"_1-at-most-once-æœ€å¤šä¸€æ¬¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-at-most-once-æœ€å¤šä¸€æ¬¡"}},[s._v("#")]),s._v(" 1. At-most-onceï¼ˆæœ€å¤šä¸€æ¬¡ï¼‰")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("ç‰¹ç‚¹")]),s._v("ï¼šä¸ä¿è¯å¤„ç†ç»“æœï¼Œå¯èƒ½ä¼šä¸¢å¤±è®°å½•")]),s._v(" "),t("li",[t("strong",[s._v("é€‚ç”¨åœºæ™¯")]),s._v("ï¼šå¯¹æ•°æ®ä¸¢å¤±ä¸æ•æ„Ÿçš„åº”ç”¨")])]),s._v(" "),t("h3",{attrs:{id:"_2-at-least-once-è‡³å°‘ä¸€æ¬¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-at-least-once-è‡³å°‘ä¸€æ¬¡"}},[s._v("#")]),s._v(" 2. At-least-onceï¼ˆè‡³å°‘ä¸€æ¬¡ï¼‰")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("ç‰¹ç‚¹")]),s._v("ï¼šä¿è¯æ¯æ¡è®°å½•è‡³å°‘è¢«å¤„ç†ä¸€æ¬¡ï¼Œä½†å¯èƒ½é‡å¤")]),s._v(" "),t("li",[t("strong",[s._v("é€‚ç”¨åœºæ™¯")]),s._v("ï¼šå¤§å¤šæ•°æµå¤„ç†åº”ç”¨")])]),s._v(" "),t("h3",{attrs:{id:"_3-exactly-once-ç²¾ç¡®ä¸€æ¬¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-exactly-once-ç²¾ç¡®ä¸€æ¬¡"}},[s._v("#")]),s._v(" 3. Exactly-onceï¼ˆç²¾ç¡®ä¸€æ¬¡ï¼‰")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("ç‰¹ç‚¹")]),s._v("ï¼šä¿è¯æ¯æ¡è®°å½•æ°å¥½è¢«å¤„ç†ä¸€æ¬¡")]),s._v(" "),t("li",[t("strong",[s._v("é€‚ç”¨åœºæ™¯")]),s._v("ï¼šå¯¹æ•°æ®å‡†ç¡®æ€§è¦æ±‚é«˜çš„åº”ç”¨")])]),s._v(" "),t("h2",{attrs:{id:"å®è·µ-å®ç°ä¸€ä¸ªæœ‰çŠ¶æ€çš„è®¡æ•°å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®è·µ-å®ç°ä¸€ä¸ªæœ‰çŠ¶æ€çš„è®¡æ•°å™¨"}},[s._v("#")]),s._v(" å®è·µï¼šå®ç°ä¸€ä¸ªæœ‰çŠ¶æ€çš„è®¡æ•°å™¨")]),s._v(" "),t("p",[s._v("è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥ç†è§£çŠ¶æ€ç®¡ç†çš„å®é™…åº”ç”¨ã€‚å‡è®¾æˆ‘ä»¬è¦ç»Ÿè®¡æ¯ä¸ªç”¨æˆ·åœ¨5ç§’å†…çš„ç‚¹å‡»æ¬¡æ•°ã€‚")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ClickCount")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ›å»ºæ‰§è¡Œç¯å¢ƒ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")]),s._v(" env "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getExecutionEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¯ç”¨æ£€æŸ¥ç‚¹ï¼Œæ¯5ç§’ä¸€æ¬¡")]),s._v("\n        env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("enableCheckpointing")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä»Kafkaè·å–ç‚¹å‡»äº‹ä»¶")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataStream")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ClickEvent")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" clicks "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addSource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FlinkKafkaConsumer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"clicks"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ClickEventSchema")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            properties\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä½¿ç”¨KeyedStateè¿›è¡ŒçŠ¶æ€ç®¡ç†")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataStream")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserCount")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" clicks\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("keyBy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"userId"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("window")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TumblingEventTimeWindows")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("of")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("seconds")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("process")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ClickCountProcessFunction")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¾“å‡ºç»“æœ")]),s._v("\n        result"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("execute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Click Count"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ClickCountProcessFunction")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KeyedProcessFunction")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ClickEvent")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserCount")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å£°æ˜ValueStateç”¨äºå­˜å‚¨è®¡æ•°")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ValueState")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" countState"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Configuration")]),s._v(" parameters"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆå§‹åŒ–çŠ¶æ€")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ValueStateDescriptor")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" descriptor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ValueStateDescriptor")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"count"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// çŠ¶æ€åç§°")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// çŠ¶æ€ç±»å‹")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        countState "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getRuntimeContext")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getState")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("descriptor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("processElement")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ClickEvent")]),s._v(" value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Context")]),s._v(" ctx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Collector")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserCount")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è·å–å½“å‰çŠ¶æ€å€¼")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),s._v(" currentCount "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" countState"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("currentCount "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            currentCount "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ›´æ–°çŠ¶æ€")]),s._v("\n        currentCount"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        countState"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("currentCount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¾“å‡ºç»“æœ")]),s._v("\n        out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("collect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserCount")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getUserId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" currentCount"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br")])]),t("p",[s._v("è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨"),t("code",[s._v("ValueState")]),s._v("æ¥ç»´æŠ¤ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ã€‚æ¯å½“æœ‰æ–°çš„ç‚¹å‡»äº‹ä»¶åˆ°è¾¾æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šæ›´æ–°çŠ¶æ€å¹¶è¾“å‡ºç»“æœã€‚")]),s._v(" "),t("h2",{attrs:{id:"é«˜çº§çŠ¶æ€ç®¡ç†æŠ€å·§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é«˜çº§çŠ¶æ€ç®¡ç†æŠ€å·§"}},[s._v("#")]),s._v(" é«˜çº§çŠ¶æ€ç®¡ç†æŠ€å·§")]),s._v(" "),t("h3",{attrs:{id:"_1-çŠ¶æ€ttl-time-to-live"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-çŠ¶æ€ttl-time-to-live"}},[s._v("#")]),s._v(" 1. çŠ¶æ€TTLï¼ˆTime-To-Liveï¼‰")]),s._v(" "),t("p",[s._v("Flinkæ”¯æŒä¸ºçŠ¶æ€è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè‡ªåŠ¨æ¸…ç†è¿‡æœŸçŠ¶æ€ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StateTtlConfig")]),s._v(" ttlConfig "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StateTtlConfig")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("newBuilder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hours")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setUpdateType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StateTtlConfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("UpdateType"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("OnCreateAndWrite")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setStateVisibility")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StateTtlConfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("StateVisibility"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("NeverReturnExpired")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cleanupInRocksdbCompactFilter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ValueStateDescriptor")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" descriptor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ValueStateDescriptor")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lastVisit"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\ndescriptor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("enableTimeToLive")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ttlConfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"_2-çŠ¶æ€é‡ç½®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-çŠ¶æ€é‡ç½®"}},[s._v("#")]),s._v(" 2. çŠ¶æ€é‡ç½®")]),s._v(" "),t("p",[s._v("åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦é‡ç½®çŠ¶æ€ï¼Œä¾‹å¦‚ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åœ¨çª—å£å…³é—­æ—¶é‡ç½®çŠ¶æ€")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("onWindowProcess")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("WindowFunctionContext")]),s._v(" context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Iterable")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ClickEvent")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" elements"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Collector")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserCount")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¤„ç†çª—å£æ•°æ®")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é‡ç½®çŠ¶æ€")]),s._v("\n    countState"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"_3-çŠ¶æ€è®¿é—®æ¨¡å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-çŠ¶æ€è®¿é—®æ¨¡å¼"}},[s._v("#")]),s._v(" 3. çŠ¶æ€è®¿é—®æ¨¡å¼")]),s._v(" "),t("p",[s._v("Flinkæ”¯æŒä¸¤ç§çŠ¶æ€è®¿é—®æ¨¡å¼ï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("åŸå§‹çŠ¶æ€ï¼ˆRaw Stateï¼‰")]),s._v("ï¼šç›´æ¥è®¿é—®çŠ¶æ€ï¼Œä¸æä¾›ç±»å‹å®‰å…¨")]),s._v(" "),t("li",[t("strong",[s._v("æ‰˜ç®¡çŠ¶æ€ï¼ˆManaged Stateï¼‰")]),s._v("ï¼šç”±Flinkç®¡ç†ï¼Œæä¾›ç±»å‹å®‰å…¨")])]),s._v(" "),t("div",{staticClass:"custom-block right"},[t("blockquote",[t("p",[s._v("æ‰˜ç®¡çŠ¶æ€æ˜¯æ¨èçš„æ–¹å¼ï¼Œå› ä¸ºå®ƒä¸Flinkçš„æ£€æŸ¥ç‚¹å’Œä¿å­˜ç‚¹æœºåˆ¶é›†æˆå¾—æ›´å¥½ã€‚")])])]),s._v(" "),t("h2",{attrs:{id:"ç»“è¯­"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç»“è¯­"}},[s._v("#")]),s._v(" ç»“è¯­")]),s._v(" "),t("p",[s._v("çŠ¶æ€ç®¡ç†æ˜¯Flinkæµå¤„ç†çš„æ ¸å¿ƒæ”¯æŸ±ï¼Œå®ƒèµ‹äºˆäº†æµå¤„ç†åº”ç”¨å¤„ç†å¤æ‚ä¸šåŠ¡é€»è¾‘çš„èƒ½åŠ›ã€‚é€šè¿‡åˆç†ä½¿ç”¨çŠ¶æ€ç®¡ç†ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å„ç§å¤æ‚çš„æµå¤„ç†åœºæ™¯ï¼Œå¦‚å®æ—¶ç»Ÿè®¡ã€å¼‚å¸¸æ£€æµ‹ã€å¤æ‚äº‹ä»¶å¤„ç†ç­‰ã€‚")]),s._v(" "),t("p",[s._v("åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„çŠ¶æ€ç±»å‹ã€çŠ¶æ€åç«¯å’Œä¸€è‡´æ€§çº§åˆ«ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„çŠ¶æ€çš„è§„æ¨¡å’Œæ€§èƒ½å½±å“ï¼Œé¿å…çŠ¶æ€è¿‡å¤§å¯¼è‡´å†…å­˜æº¢å‡ºæˆ–æ€§èƒ½ä¸‹é™ã€‚")]),s._v(" "),t("p",[s._v("å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£Flinkçš„çŠ¶æ€ç®¡ç†æœºåˆ¶ã€‚å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµï¼ğŸ˜Š")]),s._v(" "),t("blockquote",[t("p",[s._v("æ€»ç»“ï¼šçŠ¶æ€ç®¡ç†æ˜¯æµå¤„ç†åº”ç”¨çš„æ ¸å¿ƒï¼ŒæŒæ¡çŠ¶æ€ç®¡ç†æ˜¯æˆä¸ºä¸€ååˆæ ¼çš„Flinkå¼€å‘è€…çš„å¿…ç»ä¹‹è·¯ã€‚")])])])}),[],!1,null,null,null);t.default=e.exports}}]);