(window.webpackJsonp=window.webpackJsonp||[]).push([[271],{619:function(t,s,a){"use strict";a.r(s);var n=a(15),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),s("p",[t._v("在当今大数据处理领域，流处理和批处理是两种最基本的数据处理模式。传统上，流处理系统（如Storm）和批处理系统（如MapReduce）是相互独立的，各有其特定的应用场景和局限性。然而，Apache Flink通过其创新的流批统一模型，彻底改变了这一格局。")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("Flink的核心创新在于将批处理视为流处理的一种特殊情况，实现了真正的流批统一。这一理念使得开发者可以在同一个系统中同时处理有界和无界数据，大大简化了大数据处理的复杂性。")])]),t._v(" "),s("h2",{attrs:{id:"流处理与批处理的区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#流处理与批处理的区别"}},[t._v("#")]),t._v(" 流处理与批处理的区别")]),t._v(" "),s("p",[t._v("在深入探讨Flink的流批统一模型之前，我们先回顾一下传统流处理和批处理的区别：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("特性")]),t._v(" "),s("th",[t._v("流处理")]),t._v(" "),s("th",[t._v("批处理")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("数据类型")]),t._v(" "),s("td",[t._v("无界数据流")]),t._v(" "),s("td",[t._v("有界数据集")])]),t._v(" "),s("tr",[s("td",[t._v("处理方式")]),t._v(" "),s("td",[t._v("逐条处理")]),t._v(" "),s("td",[t._v("全量处理")])]),t._v(" "),s("tr",[s("td",[t._v("延迟")]),t._v(" "),s("td",[t._v("极低（毫秒级）")]),t._v(" "),s("td",[t._v("较高（分钟级到小时级）")])]),t._v(" "),s("tr",[s("td",[t._v("一致性")]),t._v(" "),s("td",[t._v("最终一致性")]),t._v(" "),s("td",[t._v("强一致性")])]),t._v(" "),s("tr",[s("td",[t._v("典型应用")]),t._v(" "),s("td",[t._v("实时监控、报警")]),t._v(" "),s("td",[t._v("离线分析、报表")])])])]),t._v(" "),s("p",[t._v("传统上，企业需要同时维护两套不同的计算框架，增加了系统复杂性和运维成本。")]),t._v(" "),s("h2",{attrs:{id:"flink的流批统一模型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flink的流批统一模型"}},[t._v("#")]),t._v(" Flink的流批统一模型")]),t._v(" "),s("h3",{attrs:{id:"核心理念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#核心理念"}},[t._v("#")]),t._v(" 核心理念")]),t._v(" "),s("p",[t._v("Flink的流批统一模型基于一个革命性的理念："),s("strong",[t._v("批处理是流处理的一种特殊情况")]),t._v("。具体来说：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("流处理")]),t._v("：处理无界数据流，数据持续不断地产生，没有明确的起点和终点。")]),t._v(" "),s("li",[s("strong",[t._v("批处理")]),t._v("：处理有界数据集，数据有明确的起点和终点，可以看作是一个有限时间窗口内的数据流。")])]),t._v(" "),s("p",[t._v("这种统一模型意味着，在Flink中，批处理作业实际上被转换为一个特殊的流处理作业，其中数据源被限定在一个有限的时间范围内。")]),t._v(" "),s("h3",{attrs:{id:"技术实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#技术实现"}},[t._v("#")]),t._v(" 技术实现")]),t._v(" "),s("p",[t._v("Flink通过以下技术实现流批统一：")]),t._v(" "),s("h4",{attrs:{id:"_1-统一的datastream-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-统一的datastream-api"}},[t._v("#")]),t._v(" 1. 统一的DataStream API")]),t._v(" "),s("p",[t._v("Flink提供了统一的DataStream API，既可以处理无界流数据，也可以处理有界批数据：")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 流处理")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DataStream")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" stream "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("socketTextStream")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"localhost"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 批处理")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DataSet")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" batch "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readTextFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file:///path/to/files"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("h4",{attrs:{id:"_2-时间语义与窗口机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-时间语义与窗口机制"}},[t._v("#")]),t._v(" 2. 时间语义与窗口机制")]),t._v(" "),s("p",[t._v("Flink引入了丰富的时间语义和窗口机制，统一处理流数据和批数据：")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 统一的窗口处理")]),t._v("\nstream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("keyBy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("timeWindow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Time")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("seconds")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("process")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyProcessFunction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h4",{attrs:{id:"_3-状态管理与容错"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-状态管理与容错"}},[t._v("#")]),t._v(" 3. 状态管理与容错")]),t._v(" "),s("p",[t._v("Flink提供了一致的状态管理和精确一次的语义保证，确保流处理和批处理都能正确处理数据：")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 状态管理")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ValueState")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRuntimeContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ValueStateDescriptor")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"state"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h2",{attrs:{id:"流批统一的优势"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#流批统一的优势"}},[t._v("#")]),t._v(" 流批统一的优势")]),t._v(" "),s("h3",{attrs:{id:"_1-简化系统架构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-简化系统架构"}},[t._v("#")]),t._v(" 1. 简化系统架构")]),t._v(" "),s("p",[t._v("企业不再需要维护两套独立的计算框架，降低了系统复杂性和运维成本。")]),t._v(" "),s("h3",{attrs:{id:"_2-代码复用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-代码复用"}},[t._v("#")]),t._v(" 2. 代码复用")]),t._v(" "),s("p",[t._v("开发者可以使用相同的API和逻辑处理流数据和批数据，提高了代码复用率。")]),t._v(" "),s("h3",{attrs:{id:"_3-一致的语义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-一致的语义"}},[t._v("#")]),t._v(" 3. 一致的语义")]),t._v(" "),s("p",[t._v("流处理和批处理共享相同的状态管理和容错机制，确保了处理结果的一致性。")]),t._v(" "),s("h3",{attrs:{id:"_4-混合处理能力"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-混合处理能力"}},[t._v("#")]),t._v(" 4. 混合处理能力")]),t._v(" "),s("p",[t._v("Flink支持在同一作业中混合处理流数据和批数据，例如：")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 混合处理流数据和批数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DataStream")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Tuple2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" streamCounts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addSource")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FlinkKafkaConsumer")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"topic"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("keyBy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("f0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("timeWindow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Time")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("minutes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DataSet")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Tuple2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" batchCounts "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readTextFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file:///path/to/files"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Tuple2")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("groupBy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 合并流处理和批处理结果")]),t._v("\nstreamCounts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("union")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("batchCounts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("keyBy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("f0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("process")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyProcessFunction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br")])]),s("h2",{attrs:{id:"实际应用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实际应用场景"}},[t._v("#")]),t._v(" 实际应用场景")]),t._v(" "),s("h3",{attrs:{id:"_1-实时数据仓库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-实时数据仓库"}},[t._v("#")]),t._v(" 1. 实时数据仓库")]),t._v(" "),s("p",[t._v("Flink的流批统一模型非常适合构建实时数据仓库，支持实时ETL和批处理ETL的统一。")]),t._v(" "),s("h3",{attrs:{id:"_2-机器学习"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-机器学习"}},[t._v("#")]),t._v(" 2. 机器学习")]),t._v(" "),s("p",[t._v("在机器学习应用中，可以使用流处理进行实时预测，同时使用批处理进行模型训练和评估。")]),t._v(" "),s("h3",{attrs:{id:"_3-事件驱动应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-事件驱动应用"}},[t._v("#")]),t._v(" 3. 事件驱动应用")]),t._v(" "),s("p",[t._v("对于需要同时处理实时事件和历史数据的事件驱动应用，Flink的流批统一模型提供了完美的解决方案。")]),t._v(" "),s("h2",{attrs:{id:"结语"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#结语"}},[t._v("#")]),t._v(" 结语")]),t._v(" "),s("p",[t._v("Flink的流批统一模型是其区别于其他大数据框架的关键优势之一。通过将批处理视为流处理的一种特殊情况，Flink实现了真正的流批统一，简化了大数据处理的复杂性，提高了系统的灵活性和效率。")]),t._v(" "),s("blockquote",[s("p",[t._v('正如Flink的创始人之一Fabian Hueske所说："流批统一不是简单的API统一，而是计算模型和执行引擎的统一。"')])]),t._v(" "),s("p",[t._v("对于大数据架构师和开发者来说，深入理解Flink的流批统一模型，有助于构建更加高效、灵活的大数据处理系统。未来，随着实时数据处理需求的不断增长，Flink的流批统一模型将发挥越来越重要的作用。")]),t._v(" "),s("h2",{attrs:{id:"个人建议"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#个人建议"}},[t._v("#")]),t._v(" 个人建议")]),t._v(" "),s("ol",[s("li",[t._v("对于正在使用Flink的开发团队，建议深入理解流批统一模型，充分利用其优势简化系统架构。")]),t._v(" "),s("li",[t._v("对于刚接触Flink的新手，建议从流批统一的角度理解Flink的设计理念，这将有助于更好地掌握Flink的核心概念。")]),t._v(" "),s("li",[t._v("在实际项目中，可以考虑将批处理任务逐步迁移到Flink中，实现流批处理的统一管理。")])]),t._v(" "),s("p",[t._v("希望本文能帮助你更好地理解Flink的流批统一模型，如有任何问题或建议，欢迎在评论区交流讨论！")])])}),[],!1,null,null,null);s.default=e.exports}}]);