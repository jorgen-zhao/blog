(window.webpackJsonp=window.webpackJsonp||[]).push([[268],{622:function(s,t,a){"use strict";a.r(t);var n=a(15),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"å‰è¨€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[s._v("#")]),s._v(" å‰è¨€")]),s._v(" "),t("p",[s._v("åœ¨ä¹‹å‰çš„ä¸€ç³»åˆ—æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»æ·±å…¥æ¢è®¨äº†Flinkçš„æ ¸å¿ƒæ¶æ„ã€é…ç½®é€‰é¡¹ä»¥åŠåŸºç¡€ä¸è¿›é˜¶æ¦‚å¿µã€‚ç„¶è€Œï¼Œæœ‰ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½æˆ‘ä»¬å°šæœªæ¶‰åŠï¼Œé‚£å°±æ˜¯Flinkçš„Table API & SQLã€‚ğŸ¤”")]),s._v(" "),t("p",[s._v("éšç€å¤§æ•°æ®å¤„ç†çš„æ™®åŠï¼Œè¶Šæ¥è¶Šå¤šçš„æ•°æ®åˆ†æå¸ˆå’Œå·¥ç¨‹å¸ˆä¹ æƒ¯äºä½¿ç”¨SQLè¿›è¡Œæ•°æ®æŸ¥è¯¢å’Œåˆ†æã€‚Flinkçš„Table API & SQLæ­£æ˜¯ä¸ºäº†æ»¡è¶³è¿™ä¸€éœ€æ±‚è€Œç”Ÿï¼Œå®ƒå°†å…³ç³»å‹æ•°æ®å¤„ç†èƒ½åŠ›æ— ç¼é›†æˆåˆ°äº†æµè®¡ç®—å¼•æ“ä¸­ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ç”¨ç†Ÿæ‚‰çš„SQLè¯­æ³•æ¥å¤„ç†å®æ—¶æ•°æ®æµã€‚")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("æç¤º")]),s._v(" "),t("p",[s._v("Table API & SQLæ˜¯Flinkç”Ÿæ€ç³»ç»Ÿä¸­è¿æ¥ä¼ ç»Ÿæ‰¹å¤„ç†ä¸æµå¤„ç†çš„é‡è¦æ¡¥æ¢ï¼Œå®ƒè®©Flinkä¸ä»…ä»…æ˜¯ä¸€ä¸ªæŠ€æœ¯å·¥å…·ï¼Œæ›´æ˜¯ä¸€ä¸ªä¸šåŠ¡å‹å¥½çš„æ•°æ®å¤„ç†å¹³å°ã€‚")])]),s._v(" "),t("h2",{attrs:{id:"ä»€ä¹ˆæ˜¯flink-table-api-sql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯flink-table-api-sql"}},[s._v("#")]),s._v(" ä»€ä¹ˆæ˜¯Flink Table API & SQLï¼Ÿ")]),s._v(" "),t("p",[s._v("Flinkçš„Table API & SQLæ˜¯ä¸€å¥—ç”¨äºå…³ç³»å‹æ•°æ®å¤„ç†çš„é«˜çº§APIï¼Œå®ƒå…è®¸ç”¨æˆ·ä½¿ç”¨SQLè¯­å¥æˆ–è¡¨æ“ä½œæ¥å¤„ç†æµæ•°æ®å’Œæ‰¹æ•°æ®ã€‚è¿™å¥—APIå»ºç«‹åœ¨Flinkçš„DataStreamå’ŒDataSet APIä¹‹ä¸Šï¼Œæä¾›äº†å£°æ˜å¼çš„ç¼–ç¨‹æ¥å£ã€‚")]),s._v(" "),t("h3",{attrs:{id:"æ ¸å¿ƒç‰¹æ€§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ ¸å¿ƒç‰¹æ€§"}},[s._v("#")]),s._v(" æ ¸å¿ƒç‰¹æ€§")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("ç»Ÿä¸€çš„API")]),s._v("ï¼šæ— è®ºæ˜¯æ‰¹å¤„ç†è¿˜æ˜¯æµå¤„ç†ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ç›¸åŒçš„APIè¿›è¡Œæ“ä½œ")]),s._v(" "),t("li",[t("strong",[s._v("æ ‡å‡†SQLæ”¯æŒ")]),s._v("ï¼šæ”¯æŒå¤§éƒ¨åˆ†ANSI SQLæ ‡å‡†ï¼Œé™ä½å­¦ä¹ æˆæœ¬")]),s._v(" "),t("li",[t("strong",[s._v("æµæ‰¹ä¸€ä½“")]),s._v("ï¼šåŒä¸€å¥—SQLå¯ä»¥åŒæ—¶åº”ç”¨äºæµæ•°æ®å’Œæ‰¹æ•°æ®")]),s._v(" "),t("li",[t("strong",[s._v("è‡ªåŠ¨ä¼˜åŒ–")]),s._v("ï¼šFlinkä¼šè‡ªåŠ¨ä¼˜åŒ–SQLæŸ¥è¯¢ï¼Œç”Ÿæˆé«˜æ•ˆçš„æ‰§è¡Œè®¡åˆ’")]),s._v(" "),t("li",[t("strong",[s._v("ä¸°å¯Œçš„ç±»å‹ç³»ç»Ÿ")]),s._v("ï¼šæ”¯æŒFlinkçš„æ‰€æœ‰æ•°æ®ç±»å‹")])]),s._v(" "),t("h2",{attrs:{id:"table-api-vs-sql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#table-api-vs-sql"}},[s._v("#")]),s._v(" Table API vs. SQL")]),s._v(" "),t("p",[s._v("è™½ç„¶Table APIå’ŒSQLéƒ½ç”¨äºå…³ç³»å‹æ•°æ®å¤„ç†ï¼Œä½†å®ƒä»¬æœ‰ä»¥ä¸‹åŒºåˆ«ï¼š")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("ç‰¹æ€§")]),s._v(" "),t("th",[s._v("Table API")]),s._v(" "),t("th",[s._v("SQL")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("ç¼–ç¨‹æ–¹å¼")]),s._v(" "),t("td",[s._v("å£°æ˜å¼è¿‡ç¨‹ç¼–ç¨‹")]),s._v(" "),t("td",[s._v("å£°æ˜å¼å£°æ˜ç¼–ç¨‹")])]),s._v(" "),t("tr",[t("td",[s._v("çµæ´»æ€§")]),s._v(" "),t("td",[s._v("æ›´çµæ´»ï¼Œå¯ä»¥æ··åˆä½¿ç”¨Java/Scalaä»£ç ")]),s._v(" "),t("td",[s._v("è¯­æ³•ä¸¥æ ¼ï¼Œå¿…é¡»éµå¾ªSQLæ ‡å‡†")])]),s._v(" "),t("tr",[t("td",[s._v("é€‚ç”¨åœºæ™¯")]),s._v(" "),t("td",[s._v("å¤æ‚çš„æ•°æ®å¤„ç†é€»è¾‘")]),s._v(" "),t("td",[s._v("æ ‡å‡†åŒ–çš„æŸ¥è¯¢å’Œåˆ†æ")])]),s._v(" "),t("tr",[t("td",[s._v("å­¦ä¹ æ›²çº¿")]),s._v(" "),t("td",[s._v("éœ€è¦äº†è§£Table APIçš„ç‰¹å®šè¯­æ³•")]),s._v(" "),t("td",[s._v("åªéœ€äº†è§£SQLè¯­æ³•")])])])]),s._v(" "),t("h2",{attrs:{id:"åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹"}},[s._v("#")]),s._v(" åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹")]),s._v(" "),t("h3",{attrs:{id:"åˆ›å»ºè¡¨ç¯å¢ƒ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºè¡¨ç¯å¢ƒ"}},[s._v("#")]),s._v(" åˆ›å»ºè¡¨ç¯å¢ƒ")]),s._v(" "),t("p",[s._v("é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªTableEnvironmentï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flink"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("streaming"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("api"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("environment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flink"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("table"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("api"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EnvironmentSettings")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flink"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("table"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("api"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableEnvironment")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableApiExample")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ›å»ºæµæ‰§è¡Œç¯å¢ƒ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")]),s._v(" env "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StreamExecutionEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getExecutionEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ›å»ºè¡¨ç¯å¢ƒè®¾ç½®")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EnvironmentSettings")]),s._v(" settings "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EnvironmentSettings")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("newInstance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useBlinkPlanner")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("inStreamingMode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ›å»ºè¡¨ç¯å¢ƒ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableEnvironment")]),s._v(" tableEnv "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableEnvironment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("settings"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("h3",{attrs:{id:"ä»datastreamåˆ›å»ºè¡¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä»datastreamåˆ›å»ºè¡¨"}},[s._v("#")]),s._v(" ä»DataStreamåˆ›å»ºè¡¨")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ›å»ºDataStream")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataStream")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Order")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" orderStream "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addSource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OrderSource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å°†DataStreamè½¬æ¢ä¸ºè¡¨")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Table")]),s._v(" orderTable "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("fromDataStream")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("orderStream"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ³¨å†Œè¡¨")]),s._v("\ntableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("createTemporaryView")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"orders"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" orderTable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"æ‰§è¡ŒsqlæŸ¥è¯¢"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ‰§è¡ŒsqlæŸ¥è¯¢"}},[s._v("#")]),s._v(" æ‰§è¡ŒSQLæŸ¥è¯¢")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ‰§è¡ŒSQLæŸ¥è¯¢")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Table")]),s._v(" result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sqlQuery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SELECT customer, amount, COUNT(*) as order_count "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FROM orders "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GROUP BY customer, amount"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å°†è¡¨ç»“æœè¾“å‡ºåˆ°æ§åˆ¶å°")]),s._v("\ntableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toDataStream")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("result"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"ä½¿ç”¨table-apiè¿›è¡ŒæŸ¥è¯¢"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨table-apiè¿›è¡ŒæŸ¥è¯¢"}},[s._v("#")]),s._v(" ä½¿ç”¨Table APIè¿›è¡ŒæŸ¥è¯¢")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä½¿ç”¨Table APIè¿›è¡ŒæŸ¥è¯¢")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Table")]),s._v(" result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" orderTable\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupBy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"customer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"amount"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("select")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"customer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"amount"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"customer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("count")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("as")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order_count"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"é«˜çº§ç‰¹æ€§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é«˜çº§ç‰¹æ€§"}},[s._v("#")]),s._v(" é«˜çº§ç‰¹æ€§")]),s._v(" "),t("h3",{attrs:{id:"åŠ¨æ€è¡¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åŠ¨æ€è¡¨"}},[s._v("#")]),s._v(" åŠ¨æ€è¡¨")]),s._v(" "),t("p",[s._v("åŠ¨æ€è¡¨æ˜¯Flink Table API & SQLçš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªä¸æ–­å˜åŒ–çš„è¡¨ã€‚åŠ¨æ€è¡¨å¯ä»¥åƒé™æ€è¡¨ä¸€æ ·è¿›è¡ŒæŸ¥è¯¢ï¼Œä½†æŸ¥è¯¢ç»“æœä¹Ÿæ˜¯ä¸€ä¸ªåŠ¨æ€è¡¨ã€‚")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å°†DataStreamè½¬æ¢ä¸ºåŠ¨æ€è¡¨")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Table")]),s._v(" dynamicOrderTable "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("fromDataStream")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("orderStream"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åœ¨åŠ¨æ€è¡¨ä¸Šæ‰§è¡Œè¿ç»­æŸ¥è¯¢")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Table")]),s._v(" result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dynamicOrderTable\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupBy")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"customer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("select")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"customer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"amount"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("as")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"total_amount"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"æ—¶é—´å±æ€§å¤„ç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ—¶é—´å±æ€§å¤„ç†"}},[s._v("#")]),s._v(" æ—¶é—´å±æ€§å¤„ç†")]),s._v(" "),t("p",[s._v("åœ¨æµå¤„ç†ä¸­ï¼Œæ—¶é—´å±æ€§è‡³å…³é‡è¦ã€‚Flink Table API & SQLæä¾›äº†å¤šç§æ—¶é—´å±æ€§å¤„ç†æ–¹å¼ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å®šä¹‰è¡¨schemaæ—¶æŒ‡å®šæ—¶é—´å±æ€§")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableSchema")]),s._v(" schema "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableSchema")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("builder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("field")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"order_time"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataTypes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("TIMESTAMP")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("field")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"proctime"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataTypes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("TIMESTAMP")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nullable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨æ—¶é—´å±æ€§")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Table")]),s._v(" result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sqlQuery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"SELECT TUMBLE_START(order_time, INTERVAL '1' HOUR) as window_start, \"")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"       customer, "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"       SUM(amount) as total_amount "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FROM orders "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"GROUP BY TUMBLE(order_time, INTERVAL '1' HOUR), customer\"")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"è¿æ¥å™¨ä¸æ ¼å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è¿æ¥å™¨ä¸æ ¼å¼"}},[s._v("#")]),s._v(" è¿æ¥å™¨ä¸æ ¼å¼")]),s._v(" "),t("p",[s._v("Flink Table API & SQLæ”¯æŒå¤šç§è¿æ¥å™¨å’Œæ•°æ®æ ¼å¼ï¼š")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ³¨å†ŒKafkaè¡¨")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" kafkaDDL "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CREATE TABLE orders ("')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  order_id STRING, "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  customer STRING, "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  amount DOUBLE, "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  order_time TIMESTAMP(3), "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"  WATERMARK FOR order_time AS order_time - INTERVAL '5' SECOND \"")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('") WITH ("')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"  'connector' = 'kafka', \"")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"  'topic' = 'orders', \"")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"  'properties.bootstrap.servers' = 'localhost:9092', \"")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"  'format' = 'json' \"")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('")"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\ntableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("executeSql")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("kafkaDDL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h2",{attrs:{id:"å®é™…åº”ç”¨åœºæ™¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®é™…åº”ç”¨åœºæ™¯"}},[s._v("#")]),s._v(" å®é™…åº”ç”¨åœºæ™¯")]),s._v(" "),t("h3",{attrs:{id:"å®æ—¶æ•°æ®åˆ†æ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®æ—¶æ•°æ®åˆ†æ"}},[s._v("#")]),s._v(" å®æ—¶æ•°æ®åˆ†æ")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å®æ—¶ç”¨æˆ·è¡Œä¸ºåˆ†æ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Table")]),s._v(" userBehavior "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sqlQuery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SELECT user_id, "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"       COUNT(*) as page_views, "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"       COLLECT_LIST(action) as actions "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FROM user_events "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"GROUP BY TUMBLE(event_time, INTERVAL '1' MINUTE), user_id\"")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"å®æ—¶etl"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®æ—¶etl"}},[s._v("#")]),s._v(" å®æ—¶ETL")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä»Kafkaè¯»å–æ•°æ®ï¼Œå¤„ç†åå†™å…¥Elasticsearch")]),s._v("\ntableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sqlQuery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"INSERT INTO elasticsearch_index "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SELECT "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  order_id, "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  customer, "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  amount, "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"  CONCAT('order_', order_id) as document_id \"")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FROM orders "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"WHERE amount > 100"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"å®æ—¶æŠ¥è¡¨ç”Ÿæˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å®æ—¶æŠ¥è¡¨ç”Ÿæˆ"}},[s._v("#")]),s._v(" å®æ—¶æŠ¥è¡¨ç”Ÿæˆ")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç”Ÿæˆå®æ—¶é”€å”®æŠ¥è¡¨")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Table")]),s._v(" salesReport "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sqlQuery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SELECT "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"  DATE_FORMAT(order_time, 'yyyy-MM-dd') as date, \"")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  HOUR(order_time) as hour, "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  SUM(amount) as total_sales, "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  COUNT(DISTINCT customer) as unique_customers "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FROM orders "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"GROUP BY DATE_FORMAT(order_time, 'yyyy-MM-dd'), HOUR(order_time)\"")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h2",{attrs:{id:"æœ€ä½³å®è·µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æœ€ä½³å®è·µ"}},[s._v("#")]),s._v(" æœ€ä½³å®è·µ")]),s._v(" "),t("h3",{attrs:{id:"_1-åˆç†ä½¿ç”¨æ—¶é—´çª—å£"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-åˆç†ä½¿ç”¨æ—¶é—´çª—å£"}},[s._v("#")]),s._v(" 1. åˆç†ä½¿ç”¨æ—¶é—´çª—å£")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¨èä½¿ç”¨äº‹ä»¶æ—¶é—´å¤„ç†æ—¶é—´è¯­ä¹‰")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableSchema")]),s._v(" schema "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TableSchema")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("builder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("field")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"event_time"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataTypes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("TIMESTAMP")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("field")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"proctime"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataTypes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("TIMESTAMP")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nullable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å®šä¹‰æ°´å°")]),s._v("\ntableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sqlUpdate")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CREATE TABLE events ("')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  event_time TIMESTAMP(3), "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"  -- å…¶ä»–å­—æ®µ..."')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"  WATERMARK FOR event_time AS event_time - INTERVAL '5' SECOND \"")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('") WITH (...)"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"_2-ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½"}},[s._v("#")]),s._v(" 2. ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä½¿ç”¨é€‚å½“çš„ç´¢å¼•")]),s._v("\ntableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sqlUpdate")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CREATE INDEX idx_customer ON orders (customer)"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é¿å…å…¨è¡¨æ‰«æ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Table")]),s._v(" result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tableEnv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sqlQuery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"SELECT * FROM orders WHERE customer = 'John' AND amount > 100\"")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"_3-åˆç†å¤„ç†çŠ¶æ€åç«¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-åˆç†å¤„ç†çŠ¶æ€åç«¯"}},[s._v("#")]),s._v(" 3. åˆç†å¤„ç†çŠ¶æ€åç«¯")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é…ç½®çŠ¶æ€åç«¯")]),s._v("\nenv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setStateBackend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RocksDBStateBackend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hdfs://path/to/rocksdb"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nenv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("enableCheckpointing")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 60ç§’æ£€æŸ¥ç‚¹é—´éš”")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"ç»“è¯­"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç»“è¯­"}},[s._v("#")]),s._v(" ç»“è¯­")]),s._v(" "),t("p",[s._v("Flinkçš„Table API & SQLä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§å¼ºå¤§è€Œçµæ´»çš„æ–¹å¼æ¥å¤„ç†å®æ—¶å’Œæ‰¹å¤„ç†æ•°æ®ã€‚é€šè¿‡ç†Ÿæ‚‰çš„SQLè¯­æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å°†å®æ—¶æ•°æ®å¤„ç†èƒ½åŠ›é›†æˆåˆ°ç°æœ‰çš„æ•°æ®å·¥ä½œæµä¸­ï¼Œæ— éœ€å­¦ä¹ å¤æ‚çš„æµå¤„ç†APIã€‚ğŸ—")]),s._v(" "),t("p",[s._v("éšç€Flinkçš„ä¸æ–­å‘å±•å’Œå®Œå–„ï¼ŒTable API & SQLä¹Ÿåœ¨æŒç»­å¢å¼ºï¼Œæ”¯æŒæ›´å¤šSQLæ ‡å‡†å’Œä¼˜åŒ–æŠ€æœ¯ã€‚å¯¹äºå¸Œæœ›å°†å®æ—¶æ•°æ®å¤„ç†èƒ½åŠ›å¼•å…¥ç»„ç»‡çš„æ•°æ®å›¢é˜Ÿæ¥è¯´ï¼ŒæŒæ¡Flinkçš„Table API & SQLæ˜¯ä¸€é¡¹éå¸¸æœ‰ä»·å€¼çš„æŠ€èƒ½ã€‚")]),s._v(" "),t("blockquote",[t("p",[s._v('æ­£å¦‚æ•°æ®åº“å¤§å¸ˆC.J. Dateæ‰€è¨€ï¼š"SQLæ˜¯æ•°æ®å¤„ç†çš„è¯­è¨€ï¼Œè€ŒFlinkè®©è¿™ç§è¯­è¨€èƒ½å¤Ÿåº”ç”¨äºå®æ—¶ä¸–ç•Œã€‚"')])]),s._v(" "),t("hr"),s._v(" "),t("p",[t("strong",[s._v("ä¸ªäººå»ºè®®")]),s._v("ï¼šå¦‚æœä½ å·²ç»ç†Ÿæ‚‰äº†Flinkçš„åŸºç¡€æ¦‚å¿µå’ŒAPIï¼Œé‚£ä¹ˆä¸‹ä¸€æ­¥åº”è¯¥æ·±å…¥æ¢ç´¢Table API & SQLã€‚å®ƒä¸ä»…èƒ½å¤Ÿç®€åŒ–ä½ çš„å¼€å‘æµç¨‹ï¼Œè¿˜èƒ½è®©ä½ æ›´å¥½åœ°åˆ©ç”¨Flinkçš„æµæ‰¹ä¸€ä½“èƒ½åŠ›ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨å®é™…é¡¹ç›®ä¸­å°è¯•ä½¿ç”¨Table API & SQLæ¥è§£å†³å®é™…é—®é¢˜ï¼Œæ‰èƒ½çœŸæ­£ä½“ä¼šåˆ°å®ƒçš„ä¼˜åŠ¿ã€‚")])])}),[],!1,null,null,null);t.default=e.exports}}]);